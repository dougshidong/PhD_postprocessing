Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   8.617416e-03   
  1     1.439015e-03   8.585692e-03   8.617416e-04   2         2         1         0         7589      30                5175              2                 0                 
  2     1.243746e-03   7.736076e-03   2.418500e-02   3         3         1         0         9312      36                6411              3                 0                 
  3     1.076880e-03   6.965577e-03   2.345293e-02   4         4         1         0         11038     42                7650              4                 0                 
  4     9.338980e-04   6.263551e-03   2.296077e-02   5         5         1         0         12770     48                8895              5                 0                 
  5     8.120047e-04   5.625984e-03   2.245672e-02   6         6         1         0         14508     54                10146             6                 0                 
  6     7.084560e-04   5.048133e-03   2.193658e-02   7         7         1         0         16252     60                11403             7                 0                 
  7     6.207142e-04   4.525112e-03   2.140126e-02   8         8         1         0         18002     66                12666             8                 0                 
  8     5.464983e-04   4.052133e-03   2.085670e-02   9         9         1         0         19764     72                13941             9                 0                 
  9     4.837952e-04   3.624648e-03   2.031090e-02   10        10        1         0         21535     78                15225             10                0                 
  10    4.308515e-04   3.238415e-03   1.977210e-02   11        11        1         0         23309     84                16512             11                0                 
  11    3.861533e-04   2.889524e-03   1.924801e-02   12        12        1         0         25095     90                17811             12                0                 
  12    3.484030e-04   2.574397e-03   1.874545e-02   13        13        1         0         26884     96                19113             13                0                 
  13    3.164935e-04   2.289775e-03   1.827069e-02   14        14        1         0         28676     102               20418             14                0                 
  14    2.894839e-04   2.032691e-03   1.782952e-02   15        15        1         0         30468     108               21723             15                0                 
  15    2.665774e-04   1.800454e-03   1.742751e-02   16        16        1         0         32281     114               23049             16                0                 
  16    2.471008e-04   1.590627e-03   1.707017e-02   17        17        1         0         34091     120               24372             17                0                 
  17    2.304868e-04   1.401006e-03   1.676286e-02   18        18        1         0         35886     126               25680             18                0                 
  18    2.162583e-04   1.229614e-03   1.651090e-02   19        19        1         0         37687     132               26994             19                0                 
  19    2.040150e-04   1.074684e-03   1.631944e-02   20        20        1         0         39488     138               28308             20                0                 
  20    1.934219e-04   9.346607e-04   1.619346e-02   21        21        1         0         41295     144               29628             21                0                 
  21    1.841986e-04   8.081979e-04   1.613774e-02   22        22        1         0         43102     150               30948             22                0                 
  22    1.761112e-04   6.941654e-04   1.615682e-02   23        23        1         0         44915     156               32274             23                0                 
  23    1.689648e-04   5.916673e-04   1.625508e-02   24        24        1         0         46731     162               33603             24                0                 
  24    1.625966e-04   5.000739e-04   1.643667e-02   25        25        1         0         48547     168               34932             25                0                 
  25    1.568712e-04   4.190747e-04   1.670562e-02   26        26        1         0         50357     174               36255             26                0                 
  26    1.516756e-04   3.487606e-04   1.706592e-02   27        27        1         0         52170     180               37581             27                0                 
  27    1.469151e-04   2.897217e-04   1.752178e-02   28        28        1         0         53989     186               38913             28                0                 
  28    1.425105e-04   2.430822e-04   1.807824e-02   29        29        1         0         55811     192               40248             29                0                 
  29    1.383944e-04   2.102194e-04   1.874227e-02   30        30        1         0         57645     198               41595             30                0                 
  30    1.345085e-04   1.917931e-04   1.952566e-02   31        31        1         0         59512     204               42975             31                0                 
  31    1.308004e-04   1.863790e-04   2.045044e-02   32        32        1         0         61424     210               44400             32                0                 
  32    1.272192e-04   1.902421e-04   2.156082e-02   33        33        1         0         63336     216               45825             33                0                 
  33    1.237095e-04   1.988264e-04   2.294586e-02   34        34        1         0         65179     222               47181             34                0                 
  34    1.202013e-04   2.082831e-04   2.478943e-02   35        35        1         0         67058     228               48573             35                0                 
  35    1.165925e-04   2.160961e-04   2.747236e-02   36        36        1         0         68970     234               49998             36                0                 
  36    1.127239e-04   2.205108e-04   3.176476e-02   37        37        1         0         70882     240               51423             37                0                 
  37    1.082597e-04   2.879775e-04   4.623593e-02   38        38        1         0         72761     246               52815             38                0                 
  38    1.046738e-04   2.811684e-04   3.502263e-02   39        39        1         0         74670     252               54237             39                0                 
  39    1.011580e-04   2.754696e-04   3.678744e-02   40        40        1         0         76615     258               55695             40                0                 
  40    9.649794e-05   2.654731e-04   5.689023e-02   41        41        1         0         78461     264               57054             41                0                 
  41    9.298658e-05   2.548274e-04   4.425464e-02   42        42        1         0         80400     270               58506             42                0                 
  42    8.973749e-05   2.455336e-04   4.383392e-02   43        43        1         0         82345     276               59964             43                0                 
  43    8.625020e-05   2.269115e-04   4.987952e-02   44        44        1         0         84260     282               61392             44                0                 
  44    8.220995e-05   2.314764e-04   6.385745e-02   45        45        1         0         86196     288               62841             45                0                 
  45    7.885986e-05   2.088817e-04   5.716775e-02   46        46        1         0         88114     294               64272             46                0                 
  46    7.622410e-05   1.977449e-04   4.914017e-02   47        47        1         0         90095     300               65766             47                0                 
  47    7.335110e-05   1.910631e-04   6.127677e-02   48        48        1         0         91986     306               67170             48                0                 
  48    7.126322e-05   1.742410e-04   4.598905e-02   49        49        1         0         93970     312               68667             49                0                 
  49    6.959230e-05   1.621493e-04   3.962439e-02   50        50        1         0         95945     318               70155             50                0                 
  50    6.804104e-05   1.482275e-04   3.846137e-02   51        51        1         0         97932     324               71655             51                0                 
  51    6.661059e-05   1.362466e-04   3.802857e-02   52        52        1         0         99916     330               73152             52                0                 
  52    6.524033e-05   1.217877e-04   3.921780e-02   53        53        1         0         101876    336               74625             53                0                 
  53    6.396968e-05   1.079379e-04   3.920921e-02   54        54        1         0         103863    342               76125             54                0                 
  54    6.297850e-05   9.629453e-05   3.343216e-02   55        55        1         0         105182    347               77037             55                0                 
  55    6.211908e-05   8.527619e-05   3.088185e-02   56        56        1         0         106528    352               77976             56                0                 
  56    6.134513e-05   7.527644e-05   2.991894e-02   57        57        1         0         107862    357               78903             57                0                 
  57    6.063021e-05   6.552960e-05   2.943302e-02   58        58        1         0         109214    362               79848             58                0                 
  58    5.995859e-05   5.653006e-05   2.961042e-02   59        59        1         0         110563    367               80790             59                0                 
  59    5.931916e-05   4.805914e-05   3.002613e-02   60        60        1         0         111912    372               81732             60                0                 
  60    5.870093e-05   4.044832e-05   3.094336e-02   61        61        1         0         113255    377               82668             61                0                 
  61    5.809503e-05   3.407498e-05   3.218767e-02   62        62        1         0         114598    382               83604             62                0                 
  62    5.749164e-05   2.948824e-05   3.393767e-02   63        63        1         0         115941    387               84540             63                0                 
  63    5.688240e-05   2.762467e-05   3.614197e-02   64        64        1         0         117278    392               85470             64                0                 
  64    5.625777e-05   2.898479e-05   3.890973e-02   65        65        1         0         118615    397               86400             65                0                 
  65    5.560944e-05   3.291250e-05   4.227425e-02   66        66        1         0         119958    402               87336             66                0                 
  66    5.492736e-05   3.937291e-05   4.628566e-02   67        67        1         0         121292    407               88263             67                0                 
  67    5.420352e-05   4.605690e-05   5.104688e-02   68        68        1         0         122638    412               89202             68                0                 
  68    5.342563e-05   5.552507e-05   5.659097e-02   69        69        1         0         123975    417               90132             69                0                 
  69    5.258827e-05   6.250930e-05   6.302336e-02   70        70        1         0         125267    422               91017             70                0                 
  70    5.166981e-05   7.641451e-05   7.091432e-02   71        71        1         0         126619    427               91962             71                0                 
  71    5.070583e-05   8.410209e-05   7.692776e-02   72        72        1         0         127938    432               92874             72                0                 
  72    4.967807e-05   9.562107e-05   8.347197e-02   73        73        1         0         129272    437               93801             73                0                 
  73    4.855806e-05   1.010112e-04   9.297200e-02   74        74        1         0         131274    443               95316             74                0                 
  74    4.729616e-05   1.232483e-04   1.078920e-01   75        75        1         0         133261    449               96816             75                0                 
  75    4.614740e-05   1.304294e-04   1.009371e-01   76        76        1         0         134586    454               97734             76                0                 
  76    4.489478e-05   1.330752e-04   1.095568e-01   77        77        1         0         135932    459               98673             77                0                 
  77    4.346817e-05   1.485244e-04   1.270885e-01   78        78        1         0         137272    464               99606             78                0                 
  78    4.208529e-05   1.493609e-04   1.246559e-01   79        79        1         0         138636    469               100563            79                0                 
  79    4.060190e-05   1.534675e-04   1.279141e-01   80        80        1         0         139964    474               101484            80                0                 
  80    3.905010e-05   1.536533e-04   1.368590e-01   81        81        1         0         141352    479               102465            81                0                 
  81    3.759819e-05   1.410624e-04   1.310272e-01   82        82        1         0         142680    484               103386            82                0                 
  82    3.631701e-05   1.351226e-04   1.191974e-01   83        83        1         0         144071    489               104370            83                0                 
  83    3.516162e-05   1.277550e-04   1.089995e-01   84        84        1         0         145483    494               105375            84                0                 
  84    3.410963e-05   1.242829e-04   1.021152e-01   85        85        1         0         146904    499               106389            85                0                 
  85    3.314957e-05   1.092999e-04   9.670605e-02   86        86        1         0         148283    504               107361            86                0                 
  86    3.237407e-05   1.026901e-04   8.111554e-02   87        87        1         0         149668    509               108339            87                0                 
  87    3.172289e-05   9.435812e-05   7.025440e-02   88        88        1         0         151092    514               109356            88                0                 
  88    3.116824e-05   8.741381e-05   6.171083e-02   89        89        1         0         152489    519               110346            89                0                 
  89    3.070081e-05   8.001505e-05   5.400315e-02   90        90        1         0         153922    524               111372            90                0                 
  90    3.030897e-05   7.331098e-05   4.698285e-02   91        91        1         0         155349    529               112392            91                0                 
  91    2.998216e-05   6.675336e-05   4.091700e-02   92        92        1         0         156779    534               113415            92                0                 
  92    2.971050e-05   6.067733e-05   3.554631e-02   93        93        1         0         158209    539               114438            93                0                 
  93    2.948526e-05   5.494547e-05   3.094132e-02   94        94        1         0         159636    544               115458            94                0                 
  94    2.929880e-05   4.963168e-05   2.694568e-02   95        95        1         0         161066    549               116481            95                0                 
  95    2.914455e-05   4.469500e-05   2.353091e-02   96        96        1         0         162496    554               117504            96                0                 
  96    2.901694e-05   4.013658e-05   2.060133e-02   97        97        1         0         163935    559               118536            97                0                 
  97    2.891128e-05   3.593102e-05   1.810353e-02   98        98        1         0         165374    564               119568            98                0                 
  98    2.882366e-05   3.206039e-05   1.597143e-02   99        99        1         0         166816    569               120603            99                0                 
  99    2.875082e-05   2.850013e-05   1.415795e-02   100       100       1         0         168261    574               121641            100               0                 
  100   2.869006e-05   2.522742e-05   1.261707e-02   101       101       1         0         169709    579               122682            101               0                 
  101   2.863916e-05   2.221852e-05   1.131151e-02   102       102       1         0         171160    584               123726            102               0                 
  102   2.859628e-05   1.945104e-05   1.020846e-02   103       103       1         0         172611    589               124770            103               0                 
  103   2.855992e-05   1.690355e-05   9.281224e-03   104       104       1         0         174065    594               125817            104               0                 
  104   2.852884e-05   1.455669e-05   8.507243e-03   105       105       1         0         175522    599               126867            105               0                 
  105   2.850203e-05   1.239369e-05   7.868290e-03   106       106       1         0         176979    604               127917            106               0                 
  106   2.847865e-05   1.040199e-05   7.349621e-03   107       107       1         0         178442    609               128973            107               0                 
  107   2.845800e-05   8.575899e-06   6.939751e-03   108       108       1         0         179905    614               130029            108               0                 
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 83.0656 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2 preconditioner
Using 4020 design variables: 4000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.06156e-06       0.00323634        0.0205461         8.11515           7.19382           2.37486           2.9094            28                1                 0                 20174             2                 18348             122               116               
2                 8.75336e-08       8.18024e-05       0.000354113       3.30497           3.28398           0.196824          0.315447          23                1                 0                 35875             3                 32590             223               212               
3                 5.97983e-11       1.95733e-06       2.63408e-06       3.2109            3.21031           0.0243826         0.056402          25                1                 0                 52943             4                 48087             332               316               
4                 4.61599e-15       1.46491e-09       1.51758e-09       0.411052          0.411049          0.000611077       0.00151195        27                1                 0                 71393             5                 64854             449               428               
5                 9.68384e-15       2.16875e-12       3.33972e-13       0.00477566        0.00477566        5.44588e-06       2.91103e-06       26                1                 0                 89122             6                 80956             562               536               
Optimization Terminated with Status: Converged
The process took 22.5704 seconds to run.
Total n_vmult for algorithm 89122
