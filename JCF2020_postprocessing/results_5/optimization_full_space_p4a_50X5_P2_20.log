Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   8.745775e-03   
  1     1.452567e-03   8.713000e-03   8.745775e-04   2         2         1         0         204675    47                186473            500               924               
  2     1.255158e-03   7.851069e-03   2.408548e-02   3         3         1         0         207478    53                188189            501               924               
  3     1.086603e-03   7.070007e-03   2.332232e-02   4         4         1         0         210281    59                189905            502               924               
  4     9.422130e-04   6.358528e-03   2.280786e-02   5         5         1         0         213084    65                191621            503               924               
  5     8.191236e-04   5.712394e-03   2.228801e-02   6         6         1         0         215890    71                193340            504               924               
  6     7.145409e-04   5.126698e-03   2.176050e-02   7         7         1         0         218696    77                195059            505               924               
  7     6.258969e-04   4.596462e-03   2.122487e-02   8         8         1         0         221511    83                196787            506               924               
  8     5.508915e-04   4.116853e-03   2.068475e-02   9         9         1         0         224350    89                198539            507               924               
  9     4.874984e-04   3.683289e-03   2.014614e-02   10        10        1         0         227213    95                200315            508               924               
  10    4.339530e-04   3.291496e-03   1.961587e-02   11        11        1         0         230052    101               202067            509               924               
  11    3.887319e-04   2.937531e-03   1.910067e-02   12        12        1         0         232894    107               203822            510               924               
  12    3.505287e-04   2.617781e-03   1.860675e-02   13        13        1         0         234944    112               204965            511               924               
  13    3.182286e-04   2.328951e-03   1.813975e-02   14        14        1         0         236982    117               206096            512               924               
  14    2.908841e-04   2.068046e-03   1.770495e-02   15        15        1         0         239020    122               207227            513               924               
  15    2.676923e-04   1.832348e-03   1.730745e-02   16        16        1         0         241064    127               208364            514               924               
  16    2.479745e-04   1.619394e-03   1.695235e-02   17        17        1         0         243111    132               209504            515               924               
  17    2.311584e-04   1.426958e-03   1.664485e-02   18        18        1         0         245158    137               210644            516               924               
  18    2.167620e-04   1.253035e-03   1.639033e-02   19        19        1         0         247229    142               211808            517               924               
  19    2.043806e-04   1.095832e-03   1.619431e-02   20        20        1         0         249309    147               212981            518               924               
  20    1.936743e-04   9.537579e-04   1.606244e-02   21        21        1         0         251389    152               214154            519               924               
  21    1.843584e-04   8.254284e-04   1.600047e-02   22        22        1         0         253469    157               215327            520               924               
  22    1.761948e-04   7.096692e-04   1.601414e-02   23        23        1         0         255555    162               216506            521               924               
  23    1.689844e-04   6.055362e-04   1.610918e-02   24        24        1         0         257641    167               217685            522               924               
  24    1.625607e-04   5.123475e-04   1.629128e-02   25        25        1         0         259727    172               218864            523               924               
  25    1.567848e-04   4.297409e-04   1.656582e-02   26        26        1         0         261807    177               220037            524               924               
  26    1.515407e-04   3.577627e-04   1.693800e-02   27        27        1         0         263899    182               221222            525               924               
  27    1.467315e-04   2.969825e-04   1.741262e-02   28        28        1         0         265988    187               222404            526               924               
  28    1.422761e-04   2.485676e-04   1.799417e-02   29        29        1         0         268068    192               223577            527               924               
  29    1.381064e-04   2.140662e-04   1.868732e-02   30        30        1         0         270157    197               224759            528               924               
  30    1.341646e-04   1.944623e-04   1.949816e-02   31        31        1         0         272246    202               225941            529               924               
  31    1.304005e-04   1.886422e-04   2.043762e-02   32        32        1         0         274335    207               227123            530               924               
  32    1.267683e-04   1.928938e-04   2.152909e-02   33        33        1         0         276424    212               228305            531               924               
  33    1.232214e-04   2.023736e-04   2.282584e-02   34        34        1         0         278516    217               229490            532               924               
  34    1.197041e-04   2.128127e-04   2.445129e-02   35        35        1         0         280617    222               230684            533               924               
  35    1.161345e-04   2.211262e-04   2.669489e-02   36        36        1         0         282721    227               231881            534               924               
  36    1.123722e-04   2.255211e-04   3.024318e-02   37        37        1         0         284825    232               233078            535               924               
  37    1.081758e-04   2.250004e-04   3.654977e-02   38        38        1         0         286923    237               234269            536               924               
  38    1.035578e-04   3.157719e-04   5.456430e-02   39        39        1         0         289000    242               235439            537               924               
  39    9.965340e-05   3.024962e-04   4.015387e-02   40        40        1         0         291104    247               236636            538               924               
  40    9.579506e-05   2.864511e-04   4.275030e-02   41        41        1         0         293208    252               237833            539               924               
  41    9.164311e-05   2.706256e-04   5.054943e-02   42        42        1         0         295321    257               239039            540               924               
  42    8.637668e-05   2.533034e-04   7.436119e-02   43        43        1         0         297410    262               240221            541               924               
  43    8.283432e-05   2.347393e-04   5.293459e-02   44        44        1         0         299550    267               241454            542               924               
  44    7.979116e-05   2.146050e-04   4.993516e-02   45        45        1         0         301681    272               242678            543               924               
  45    7.654373e-05   2.076720e-04   5.768588e-02   46        46        1         0         303827    277               243917            544               924               
  46    7.352309e-05   1.813596e-04   5.873125e-02   47        47        1         0         305940    282               245123            545               924               
  47    7.124388e-05   1.664217e-04   4.863784e-02   48        48        1         0         308083    287               246359            546               924               
  48    6.902194e-05   1.588416e-04   5.247256e-02   49        49        1         0         310172    292               247541            547               924               
  49    6.701088e-05   1.375712e-04   5.048352e-02   50        50        1         0         312294    297               248756            548               924               
  50    6.556771e-05   1.267589e-04   3.985973e-02   51        51        1         0         314437    302               249992            549               924               
  51    6.426196e-05   1.129192e-04   3.759758e-02   52        52        1         0         316571    307               251219            550               924               
  52    6.307948e-05   1.036455e-04   3.676314e-02   53        53        1         0         318720    312               252461            551               924               
  53    6.200471e-05   9.152823e-05   3.496470e-02   54        54        1         0         320884    317               253718            552               924               
  54    6.102825e-05   8.320168e-05   3.433145e-02   55        55        1         0         323078    322               255005            553               924               
  55    6.013576e-05   7.253803e-05   3.307186e-02   56        56        1         0         325248    327               256268            554               924               
  56    5.931150e-05   6.483385e-05   3.300575e-02   57        57        1         0         327442    332               257555            555               924               
  57    5.853287e-05   5.605637e-05   3.338471e-02   58        58        1         0         329588    337               258794            556               924               
  58    5.773260e-05   4.722704e-05   3.713176e-02   59        59        1         0         331749    342               260048            557               924               
  59    5.704676e-05   4.056857e-05   3.476190e-02   60        60        1         0         333889    347               261281            558               924               
  60    5.644187e-05   3.444762e-05   3.273991e-02   61        61        1         0         336050    352               262535            559               924               
  61    5.587968e-05   3.043197e-05   3.245948e-02   62        62        1         0         338223    357               263801            560               924               
  62    5.531521e-05   2.782973e-05   3.411622e-02   63        63        1         0         340357    362               265028            561               924               
  63    5.472791e-05   2.703295e-05   3.729903e-02   64        64        1         0         342527    367               266291            562               924               
  64    5.410714e-05   2.876119e-05   4.101497e-02   65        65        1         0         344739    372               267596            563               924               
  65    5.343913e-05   3.187781e-05   4.600488e-02   66        66        1         0         346906    377               268856            564               924               
  66    5.271714e-05   3.667922e-05   5.150290e-02   67        67        1         0         349079    382               270122            565               924               
  67    5.192274e-05   4.358226e-05   5.862419e-02   68        68        1         0         351249    387               271385            566               924               
  68    5.105415e-05   4.779453e-05   6.653484e-02   69        69        1         0         353398    392               272627            567               924               
  69    5.002143e-05   7.100431e-05   8.349900e-02   70        70        1         0         355550    397               273872            568               924               
  70    4.919265e-05   7.931754e-05   6.977308e-02   71        71        1         0         357729    402               275144            569               924               
  71    4.822606e-05   8.321276e-05   8.213204e-02   72        72        1         0         359860    407               276368            570               924               
  72    4.712280e-05   9.524001e-05   9.504526e-02   73        73        1         0         362024    412               277625            571               924               
  73    4.591314e-05   9.864167e-05   1.058911e-01   74        74        1         0         364167    417               278861            572               924               
  74    4.458637e-05   1.115457e-04   1.175094e-01   75        75        1         0         366307    422               280094            573               924               
  75    4.318864e-05   1.134025e-04   1.265323e-01   76        76        1         0         368450    427               281330            574               924               
  76    4.171087e-05   1.234681e-04   1.345593e-01   77        77        1         0         370590    432               282563            575               924               
  77    4.022038e-05   1.232832e-04   1.396655e-01   78        78        1         0         372730    437               283796            576               924               
  78    3.872864e-05   1.234771e-04   1.396391e-01   79        79        1         0         374861    442               285020            577               924               
  79    3.725898e-05   1.220540e-04   1.424677e-01   80        80        1         0         377007    447               286259            578               924               
  80    3.587627e-05   1.136824e-04   1.361471e-01   81        81        1         0         379150    452               287495            579               924               
  81    3.463048e-05   1.108835e-04   1.275332e-01   82        82        1         0         381314    457               288752            580               924               
  82    3.349259e-05   1.031775e-04   1.185934e-01   83        83        1         0         383457    462               289988            581               924               
  83    3.247289e-05   9.704216e-05   1.095877e-01   84        84        1         0         385636    467               291260            582               924               
  84    3.158996e-05   9.238651e-05   9.781276e-02   85        85        1         0         387809    472               292526            583               924               
  85    3.080260e-05   8.349157e-05   8.911905e-02   86        86        1         0         389988    477               293798            584               924               
  86    3.012765e-05   7.834615e-05   7.997414e-02   87        87        1         0         392212    482               295115            585               924               
  87    2.955708e-05   7.086858e-05   6.970977e-02   88        88        1         0         394403    487               296399            586               924               
  88    2.907364e-05   6.592553e-05   6.169879e-02   89        89        1         0         396618    492               297707            587               924               
  89    2.866800e-05   5.962587e-05   5.392179e-02   90        90        1         0         398857    497               299039            588               924               
  90    2.832821e-05   5.466440e-05   4.723123e-02   91        91        1         0         401084    502               300359            589               924               
  91    2.804594e-05   4.951709e-05   4.121599e-02   92        92        1         0         403332    507               301700            590               924               
  92    2.781135e-05   4.493191e-05   3.593425e-02   93        93        1         0         405541    512               303002            591               924               
  93    2.761701e-05   4.056630e-05   3.144185e-02   94        94        1         0         407777    517               304331            592               924               
  94    2.745592e-05   3.655537e-05   2.747983e-02   95        95        1         0         410031    522               305678            593               924               
  95    2.732235e-05   3.283536e-05   2.416569e-02   96        96        1         0         412291    527               307031            594               924               
  96    2.721140e-05   2.940733e-05   2.128105e-02   97        97        1         0         414557    532               308390            595               924               
  97    2.711902e-05   2.624696e-05   1.886428e-02   98        98        1         0         416829    537               309755            596               924               
  98    2.704185e-05   2.333789e-05   1.678542e-02   99        99        1         0         419101    542               311120            597               924               
  99    2.697712e-05   2.065836e-05   1.503858e-02   100       100       1         0         421382    547               312494            598               924               
  100   2.692255e-05   1.819120e-05   1.355202e-02   101       101       1         0         423660    552               313865            599               924               
  101   2.687626e-05   1.591669e-05   1.230706e-02   102       102       1         0         425944    557               315242            600               924               
  102   2.683669e-05   1.381880e-05   1.126324e-02   103       103       1         0         428225    562               316616            601               924               
  103   2.680257e-05   1.188172e-05   1.040254e-02   104       104       1         0         430515    567               317999            602               924               
  104   2.677283e-05   1.009327e-05   9.701482e-03   105       105       1         0         432808    572               319385            603               924               
  105   2.674661e-05   8.445103e-06   9.146950e-03   106       106       1         0         435104    577               320774            604               924               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 346.225 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 9020 design variables: 9000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.25254e-06       0.00486083        0.0189946         6.84527           3.65724           3.44665           4.64789           281               1                 0                 26722             2                 3222              1134              2252              
2                 1.94029e-07       0.000195287       0.000459465       0.753302          0.3078            0.282492          0.626834          199               1                 0                 45310             3                 5221              1939              3848              
3                 1.44537e-10       2.08779e-05       1.23749e-05       0.956741          0.927898          0.0508803         0.227529          242               1                 0                 67854             4                 7650              2916              5788              
4                 1.86997e-13       1.00304e-08       5.22958e-09       0.0853102         0.0850969         0.00136566        0.00587144        263               1                 0                 92330             5                 10289             3977              7896              
5                 5.62731e-14       6.35769e-12       7.9947e-12        0.024345          0.0243449         3.30854e-05       1.67331e-05       242               1                 0                 114874            6                 12718             4954              9836              
Optimization Terminated with Status: Converged
The process took 173.486 seconds to run.
Total n_vmult for algorithm 114874
