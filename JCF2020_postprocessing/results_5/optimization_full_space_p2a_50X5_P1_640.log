Starting optimization with 640...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   3.737475e-03   
  1     1.445031e-03   3.734793e-03   3.737475e-04   2         2         1         0         178851    52                164142            507               1000              
  2     1.206903e-03   7.246435e-03   8.616010e-02   3         3         1         0         180628    58                165432            508               1000              
  3     1.021498e-03   5.874314e-03   5.673037e-02   4         4         1         0         182384    64                166701            509               1000              
  4     8.923335e-04   5.611920e-03   4.730556e-02   5         5         1         0         184137    70                167967            510               1000              
  5     7.591716e-04   4.728216e-03   5.256848e-02   6         6         1         0         185920    76                169263            511               1000              
  6     6.405896e-04   4.338482e-03   5.389781e-02   7         7         1         0         187685    82                170541            512               1000              
  7     5.387939e-04   3.839036e-03   5.156954e-02   8         8         1         0         189492    88                171861            513               1000              
  8     4.518076e-04   3.448561e-03   4.968202e-02   9         9         1         0         191254    94                173136            514               1000              
  9     3.781691e-04   3.082566e-03   4.695699e-02   10        10        1         0         193049    100               174444            515               1000              
  10    3.153530e-04   2.760831e-03   4.512625e-02   11        11        1         0         194808    106               175716            516               1000              
  11    2.614500e-04   2.456771e-03   4.317907e-02   12        12        1         0         196618    112               177039            517               1000              
  12    2.159524e-04   2.187108e-03   4.119027e-02   13        13        1         0         198410    118               178344            518               1000              
  13    1.784764e-04   1.947499e-03   3.800328e-02   14        14        1         0         200247    124               179694            519               1000              
  14    1.451541e-04   1.723799e-03   3.846008e-02   15        15        1         0         202072    130               181032            520               1000              
  15    1.170355e-04   1.500230e-03   3.617515e-02   16        16        1         0         203915    136               182388            521               1000              
  16    9.703164e-05   1.337173e-03   2.934697e-02   17        17        1         0         205758    142               183744            522               1000              
  17    8.094440e-05   1.187801e-03   2.630688e-02   18        18        1         0         207586    148               185085            523               1000              
  18    6.762081e-05   1.060428e-03   2.443739e-02   19        19        1         0         209432    154               186444            524               1000              
  19    5.650479e-05   9.414907e-04   2.272296e-02   20        20        1         0         211287    160               187812            525               1000              
  20    4.717569e-05   8.393062e-04   2.135719e-02   21        21        1         0         213160    166               189198            526               1000              
  21    3.930988e-05   7.428681e-04   2.010912e-02   22        22        1         0         215039    172               190590            527               1000              
  22    3.257225e-05   6.586109e-04   1.934129e-02   23        23        1         0         216930    178               191994            528               1000              
  23    2.664603e-05   5.766412e-04   1.917944e-02   24        24        1         0         218830    184               193407            529               1000              
  24    2.171436e-05   5.009365e-04   1.788356e-02   25        25        1         0         220727    190               194817            530               1000              
  25    1.793642e-05   4.414320e-04   1.550515e-02   26        26        1         0         222630    196               196233            531               1000              
  26    1.488036e-05   3.858349e-04   1.403123e-02   27        27        1         0         224539    202               197655            532               1000              
  27    1.234765e-05   3.409349e-04   1.305190e-02   28        28        1         0         226457    208               199086            533               1000              
  28    1.021608e-05   2.958019e-04   1.232557e-02   29        29        1         0         228387    214               200529            534               1000              
  29    8.424857e-06   2.597212e-04   1.159145e-02   30        30        1         0         230329    220               201984            535               1000              
  30    6.942475e-06   2.247874e-04   1.083379e-02   31        31        1         0         232280    226               203448            536               1000              
  31    5.730914e-06   1.957769e-04   9.867608e-03   32        32        1         0         234237    232               204918            537               1000              
  32    4.751465e-06   1.709158e-04   8.991696e-03   33        33        1         0         236206    238               206400            538               1000              
  33    3.945453e-06   1.481260e-04   8.242902e-03   34        34        1         0         238181    244               207888            539               1000              
  34    3.283015e-06   1.294831e-04   7.598339e-03   35        35        1         0         240153    250               209373            540               1000              
  35    2.736996e-06   1.119827e-04   6.988966e-03   36        36        1         0         241466    255               210279            541               1000              
  36    2.286964e-06   9.781958e-05   6.441658e-03   37        37        1         0         242785    260               211191            542               1000              
  37    1.915222e-06   8.468891e-05   5.943803e-03   38        38        1         0         244104    265               212103            543               1000              
  38    1.607513e-06   7.400309e-05   5.492442e-03   39        39        1         0         245432    270               213024            544               1000              
  39    1.352384e-06   6.420340e-05   5.094451e-03   40        40        1         0         246760    275               213945            545               1000              
  40    1.139725e-06   5.611933e-05   4.742246e-03   41        41        1         0         248091    280               214869            546               1000              
  41    9.570741e-07   4.880067e-05   4.613709e-03   42        42        1         0         249434    285               215805            547               1000              
  42    7.891413e-07   4.129463e-05   4.768064e-03   43        43        1         0         250780    290               216744            548               1000              
  43    6.659944e-07   3.534530e-05   3.957755e-03   44        44        1         0         252126    295               217683            549               1000              
  44    5.745541e-07   3.083424e-05   3.333951e-03   45        45        1         0         253487    300               218637            550               1000              
  45    5.010919e-07   2.694366e-05   2.988302e-03   46        46        1         0         254848    305               219591            551               1000              
  46    4.409452e-07   2.363092e-05   2.760222e-03   47        47        1         0         256230    310               220566            552               1000              
  47    3.920412e-07   2.076031e-05   2.504673e-03   48        48        1         0         257591    315               221520            553               1000              
  48    3.526881e-07   1.817979e-05   2.271166e-03   49        49        1         0         258985    320               222507            554               1000              
  49    3.209592e-07   1.616869e-05   2.050411e-03   50        50        1         0         260358    325               223473            555               1000              
  50    2.946504e-07   1.408498e-05   1.920992e-03   51        51        1         0         261800    330               224508            556               1000              
  51    2.733856e-07   1.239123e-05   1.733842e-03   52        52        1         0         263182    335               225483            557               1000              
  52    2.567195e-07   1.102282e-05   1.549097e-03   53        53        1         0         264624    340               226518            558               1000              
  53    2.437255e-07   9.656540e-06   1.339913e-03   54        54        1         0         266027    345               227514            559               1000              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 95.9158 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 4640 design variables: 4000 simulation variables and 640 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.06562e-06       0.00375146        0.0243463         6.87456           5.7445            2.43977           2.88232           685               1                 0                 43074             2                 4456              2750              2744              
2                 1.54854e-07       6.84319e-05       0.00041934        6.13339           6.12044           0.19844           0.345301          428               1                 0                 69790             3                 7033              4471              4460              
3                 1.64204e-10       5.48005e-06       1.53751e-05       2.97105           2.97039           0.0289217         0.0557789         688               1                 0                 112626            4                 11170             7232              7216              
4                 2.16935e-12       2.90716e-09       6.9677e-09        9.43212           9.43212           0.0011747         0.00152565        553               1                 0                 147092            5                 14497             9453              9432              
5                 2.32426e-12       6.56391e-12       1.24147e-09       10.4627           10.4627           7.96869e-05       6.79244e-06       566               1                 0                 182364            6                 17902             11726             11700             
Optimization Terminated with Status: Converged
The process took 169.536 seconds to run.
Total n_vmult for algorithm 182364
