Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   8.617416e-03   
  1     1.439015e-03   8.585692e-03   8.617416e-04   2         2         1         0         83251     36                12751             4844              4816              
  2     1.243746e-03   7.736076e-03   2.418500e-02   3         3         1         0         84974     42                13987             4845              4816              
  3     1.076880e-03   6.965577e-03   2.345293e-02   4         4         1         0         86700     48                15226             4846              4816              
  4     9.338980e-04   6.263551e-03   2.296077e-02   5         5         1         0         88432     54                16471             4847              4816              
  5     8.120047e-04   5.625984e-03   2.245672e-02   6         6         1         0         90170     60                17722             4848              4816              
  6     7.084560e-04   5.048133e-03   2.193658e-02   7         7         1         0         91914     66                18979             4849              4816              
  7     6.207142e-04   4.525112e-03   2.140126e-02   8         8         1         0         93664     72                20242             4850              4816              
  8     5.464983e-04   4.052133e-03   2.085670e-02   9         9         1         0         95426     78                21517             4851              4816              
  9     4.837952e-04   3.624648e-03   2.031090e-02   10        10        1         0         97197     84                22801             4852              4816              
  10    4.308515e-04   3.238415e-03   1.977210e-02   11        11        1         0         98971     90                24088             4853              4816              
  11    3.861533e-04   2.889524e-03   1.924801e-02   12        12        1         0         100757    96                25387             4854              4816              
  12    3.484030e-04   2.574397e-03   1.874545e-02   13        13        1         0         102546    102               26689             4855              4816              
  13    3.164935e-04   2.289775e-03   1.827069e-02   14        14        1         0         104338    108               27994             4856              4816              
  14    2.894839e-04   2.032691e-03   1.782952e-02   15        15        1         0         106130    114               29299             4857              4816              
  15    2.665774e-04   1.800454e-03   1.742751e-02   16        16        1         0         107943    120               30625             4858              4816              
  16    2.471008e-04   1.590627e-03   1.707017e-02   17        17        1         0         109753    126               31948             4859              4816              
  17    2.304868e-04   1.401006e-03   1.676286e-02   18        18        1         0         111548    132               33256             4860              4816              
  18    2.162583e-04   1.229614e-03   1.651090e-02   19        19        1         0         113349    138               34570             4861              4816              
  19    2.040150e-04   1.074684e-03   1.631944e-02   20        20        1         0         115150    144               35884             4862              4816              
  20    1.934219e-04   9.346607e-04   1.619346e-02   21        21        1         0         116957    150               37204             4863              4816              
  21    1.841986e-04   8.081979e-04   1.613774e-02   22        22        1         0         118764    156               38524             4864              4816              
  22    1.761112e-04   6.941654e-04   1.615682e-02   23        23        1         0         120577    162               39850             4865              4816              
  23    1.689648e-04   5.916673e-04   1.625508e-02   24        24        1         0         122393    168               41179             4866              4816              
  24    1.625966e-04   5.000739e-04   1.643667e-02   25        25        1         0         124209    174               42508             4867              4816              
  25    1.568712e-04   4.190747e-04   1.670562e-02   26        26        1         0         126019    180               43831             4868              4816              
  26    1.516756e-04   3.487606e-04   1.706592e-02   27        27        1         0         127832    186               45157             4869              4816              
  27    1.469151e-04   2.897217e-04   1.752178e-02   28        28        1         0         129651    192               46489             4870              4816              
  28    1.425105e-04   2.430822e-04   1.807824e-02   29        29        1         0         131473    198               47824             4871              4816              
  29    1.383944e-04   2.102194e-04   1.874227e-02   30        30        1         0         133307    204               49171             4872              4816              
  30    1.345085e-04   1.917931e-04   1.952566e-02   31        31        1         0         135174    210               50551             4873              4816              
  31    1.308004e-04   1.863790e-04   2.045044e-02   32        32        1         0         137086    216               51976             4874              4816              
  32    1.272192e-04   1.902421e-04   2.156082e-02   33        33        1         0         138998    222               53401             4875              4816              
  33    1.237095e-04   1.988264e-04   2.294586e-02   34        34        1         0         140841    228               54757             4876              4816              
  34    1.202013e-04   2.082831e-04   2.478943e-02   35        35        1         0         142720    234               56149             4877              4816              
  35    1.165925e-04   2.160961e-04   2.747236e-02   36        36        1         0         144632    240               57574             4878              4816              
  36    1.127239e-04   2.205108e-04   3.176476e-02   37        37        1         0         146544    246               58999             4879              4816              
  37    1.082597e-04   2.879775e-04   4.623593e-02   38        38        1         0         148423    252               60391             4880              4816              
  38    1.046738e-04   2.811684e-04   3.502263e-02   39        39        1         0         150332    258               61813             4881              4816              
  39    1.011580e-04   2.754696e-04   3.678744e-02   40        40        1         0         152277    264               63271             4882              4816              
  40    9.649794e-05   2.654731e-04   5.689023e-02   41        41        1         0         154123    270               64630             4883              4816              
  41    9.298658e-05   2.548274e-04   4.425464e-02   42        42        1         0         156062    276               66082             4884              4816              
  42    8.973749e-05   2.455336e-04   4.383392e-02   43        43        1         0         158007    282               67540             4885              4816              
  43    8.625020e-05   2.269115e-04   4.987952e-02   44        44        1         0         159922    288               68968             4886              4816              
  44    8.220995e-05   2.314764e-04   6.385745e-02   45        45        1         0         161858    294               70417             4887              4816              
  45    7.885986e-05   2.088817e-04   5.716775e-02   46        46        1         0         163776    300               71848             4888              4816              
  46    7.622410e-05   1.977449e-04   4.914017e-02   47        47        1         0         165757    306               73342             4889              4816              
  47    7.335110e-05   1.910631e-04   6.127677e-02   48        48        1         0         167648    312               74746             4890              4816              
  48    7.126322e-05   1.742410e-04   4.598905e-02   49        49        1         0         169632    318               76243             4891              4816              
  49    6.959230e-05   1.621493e-04   3.962439e-02   50        50        1         0         171607    324               77731             4892              4816              
  50    6.804104e-05   1.482275e-04   3.846137e-02   51        51        1         0         173594    330               79231             4893              4816              
  51    6.661059e-05   1.362466e-04   3.802857e-02   52        52        1         0         175578    336               80728             4894              4816              
  52    6.524033e-05   1.217877e-04   3.921780e-02   53        53        1         0         177538    342               82201             4895              4816              
  53    6.396968e-05   1.079379e-04   3.920921e-02   54        54        1         0         179525    348               83701             4896              4816              
  54    6.297850e-05   9.629453e-05   3.343216e-02   55        55        1         0         180844    353               84613             4897              4816              
  55    6.211908e-05   8.527619e-05   3.088185e-02   56        56        1         0         182190    358               85552             4898              4816              
  56    6.134513e-05   7.527644e-05   2.991894e-02   57        57        1         0         183524    363               86479             4899              4816              
  57    6.063021e-05   6.552960e-05   2.943302e-02   58        58        1         0         184876    368               87424             4900              4816              
  58    5.995859e-05   5.653006e-05   2.961042e-02   59        59        1         0         186225    373               88366             4901              4816              
  59    5.931916e-05   4.805914e-05   3.002613e-02   60        60        1         0         187574    378               89308             4902              4816              
  60    5.870093e-05   4.044832e-05   3.094336e-02   61        61        1         0         188917    383               90244             4903              4816              
  61    5.809503e-05   3.407498e-05   3.218767e-02   62        62        1         0         190260    388               91180             4904              4816              
  62    5.749164e-05   2.948824e-05   3.393767e-02   63        63        1         0         191603    393               92116             4905              4816              
  63    5.688240e-05   2.762467e-05   3.614197e-02   64        64        1         0         192940    398               93046             4906              4816              
  64    5.625777e-05   2.898479e-05   3.890973e-02   65        65        1         0         194277    403               93976             4907              4816              
  65    5.560944e-05   3.291250e-05   4.227425e-02   66        66        1         0         195620    408               94912             4908              4816              
  66    5.492736e-05   3.937291e-05   4.628566e-02   67        67        1         0         196954    413               95839             4909              4816              
  67    5.420352e-05   4.605690e-05   5.104688e-02   68        68        1         0         198300    418               96778             4910              4816              
  68    5.342563e-05   5.552507e-05   5.659097e-02   69        69        1         0         199637    423               97708             4911              4816              
  69    5.258827e-05   6.250930e-05   6.302336e-02   70        70        1         0         200929    428               98593             4912              4816              
  70    5.166981e-05   7.641451e-05   7.091432e-02   71        71        1         0         202281    433               99538             4913              4816              
  71    5.070583e-05   8.410209e-05   7.692776e-02   72        72        1         0         203600    438               100450            4914              4816              
  72    4.967807e-05   9.562107e-05   8.347197e-02   73        73        1         0         204934    443               101377            4915              4816              
  73    4.855806e-05   1.010112e-04   9.297200e-02   74        74        1         0         206936    449               102892            4916              4816              
  74    4.729616e-05   1.232483e-04   1.078920e-01   75        75        1         0         208923    455               104392            4917              4816              
  75    4.614740e-05   1.304294e-04   1.009371e-01   76        76        1         0         210248    460               105310            4918              4816              
  76    4.489478e-05   1.330752e-04   1.095568e-01   77        77        1         0         211594    465               106249            4919              4816              
  77    4.346817e-05   1.485244e-04   1.270885e-01   78        78        1         0         212934    470               107182            4920              4816              
  78    4.208529e-05   1.493609e-04   1.246559e-01   79        79        1         0         214298    475               108139            4921              4816              
  79    4.060190e-05   1.534675e-04   1.279141e-01   80        80        1         0         215626    480               109060            4922              4816              
  80    3.905010e-05   1.536533e-04   1.368590e-01   81        81        1         0         217014    485               110041            4923              4816              
  81    3.759819e-05   1.410624e-04   1.310272e-01   82        82        1         0         218342    490               110962            4924              4816              
  82    3.631701e-05   1.351226e-04   1.191974e-01   83        83        1         0         219733    495               111946            4925              4816              
  83    3.516162e-05   1.277550e-04   1.089995e-01   84        84        1         0         221145    500               112951            4926              4816              
  84    3.410963e-05   1.242829e-04   1.021152e-01   85        85        1         0         222566    505               113965            4927              4816              
  85    3.314957e-05   1.092999e-04   9.670605e-02   86        86        1         0         223945    510               114937            4928              4816              
  86    3.237407e-05   1.026901e-04   8.111554e-02   87        87        1         0         225330    515               115915            4929              4816              
  87    3.172289e-05   9.435812e-05   7.025440e-02   88        88        1         0         226754    520               116932            4930              4816              
  88    3.116824e-05   8.741381e-05   6.171083e-02   89        89        1         0         228151    525               117922            4931              4816              
  89    3.070081e-05   8.001505e-05   5.400315e-02   90        90        1         0         229584    530               118948            4932              4816              
  90    3.030897e-05   7.331098e-05   4.698285e-02   91        91        1         0         231011    535               119968            4933              4816              
  91    2.998216e-05   6.675336e-05   4.091700e-02   92        92        1         0         232441    540               120991            4934              4816              
  92    2.971050e-05   6.067733e-05   3.554631e-02   93        93        1         0         233871    545               122014            4935              4816              
  93    2.948526e-05   5.494547e-05   3.094132e-02   94        94        1         0         235298    550               123034            4936              4816              
  94    2.929880e-05   4.963168e-05   2.694568e-02   95        95        1         0         236728    555               124057            4937              4816              
  95    2.914455e-05   4.469500e-05   2.353091e-02   96        96        1         0         238158    560               125080            4938              4816              
  96    2.901694e-05   4.013658e-05   2.060133e-02   97        97        1         0         239597    565               126112            4939              4816              
  97    2.891128e-05   3.593102e-05   1.810353e-02   98        98        1         0         241036    570               127144            4940              4816              
  98    2.882366e-05   3.206039e-05   1.597143e-02   99        99        1         0         242478    575               128179            4941              4816              
  99    2.875082e-05   2.850013e-05   1.415795e-02   100       100       1         0         243923    580               129217            4942              4816              
  100   2.869006e-05   2.522742e-05   1.261707e-02   101       101       1         0         245371    585               130258            4943              4816              
  101   2.863916e-05   2.221852e-05   1.131151e-02   102       102       1         0         246822    590               131302            4944              4816              
  102   2.859628e-05   1.945104e-05   1.020846e-02   103       103       1         0         248273    595               132346            4945              4816              
  103   2.855992e-05   1.690355e-05   9.281224e-03   104       104       1         0         249727    600               133393            4946              4816              
  104   2.852884e-05   1.455669e-05   8.507243e-03   105       105       1         0         251184    605               134443            4947              4816              
  105   2.850203e-05   1.239369e-05   7.868290e-03   106       106       1         0         252641    610               135493            4948              4816              
  106   2.847865e-05   1.040199e-05   7.349621e-03   107       107       1         0         254104    615               136549            4949              4816              
  107   2.845800e-05   8.575899e-06   6.939751e-03   108       108       1         0         255567    620               137605            4950              4816              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 78.3332 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 4020 design variables: 4000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.06156e-06       0.00323634        0.0205461         8.11515           7.19382           2.37486           2.9094            24                1                 0                 34042             2                 31816             106               196               
2                 8.98197e-08       8.1259e-05        0.000354601       3.01625           2.9933            0.196228          0.315314          20                1                 0                 62107             3                 58070             195               360               
3                 5.93028e-11       1.9578e-06        2.76665e-06       3.44612           3.44559           0.0245871         0.0556263         22                1                 0                 93043             4                 87031             292               540               
4                 4.99517e-15       1.40855e-09       1.54073e-09       0.411068          0.411065          0.000609129       0.0014726         23                1                 0                 125458            5                 117389            393               728               
5                 1.05901e-14       2.22453e-12       1.55755e-13       0.00503294        0.00503293        5.73043e-06       2.93972e-06       22                1                 0                 156787            6                 146743            490               908               
Optimization Terminated with Status: Converged
The process took 30.8052 seconds to run.
Total n_vmult for algorithm 156787
