Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   7.331623e-03   
  1     1.441059e-03   7.314634e-03   7.331623e-04   2         2         1         0         101006    35                13954             6032              6004              
  2     1.217252e-03   6.591384e-03   3.245899e-02   3         3         1         0         102726    41                15187             6033              6004              
  3     1.027427e-03   5.937952e-03   3.110680e-02   4         4         1         0         104452    47                16426             6034              6004              
  4     8.657045e-04   5.343532e-03   3.011529e-02   5         5         1         0         106181    53                17668             6035              6004              
  5     7.287593e-04   4.804629e-03   2.907258e-02   6         6         1         0         107922    59                18922             6036              6004              
  6     6.133285e-04   4.317116e-03   2.797945e-02   7         7         1         0         109666    65                20179             6037              6004              
  7     5.163820e-04   3.876721e-03   2.684799e-02   8         8         1         0         111416    71                21442             6038              6004              
  8     4.351878e-04   3.479255e-03   2.569689e-02   9         9         1         0         113166    77                22705             6039              6004              
  9     3.673331e-04   3.120737e-03   2.454586e-02   10        10        1         0         114925    83                23977             6040              6004              
  10    3.107180e-04   2.797458e-03   2.341265e-02   11        11        1         0         116687    89                25252             6041              6004              
  11    2.635357e-04   2.506008e-03   2.231185e-02   12        12        1         0         118452    95                26530             6042              6004              
  12    2.242440e-04   2.243276e-03   2.125467e-02   13        13        1         0         120220    101               27811             6043              6004              
  13    1.915357e-04   2.006433e-03   2.024925e-02   14        14        1         0         121991    107               29095             6044              6004              
  14    1.643082e-04   1.792922e-03   1.930120e-02   15        15        1         0         123765    113               30382             6045              6004              
  15    1.416356e-04   1.600426e-03   1.841409e-02   16        16        1         0         125551    119               31681             6046              6004              
  16    1.227426e-04   1.426858e-03   1.758993e-02   17        17        1         0         127337    125               32980             6047              6004              
  17    1.069822e-04   1.270332e-03   1.682961e-02   18        18        1         0         129120    131               34276             6048              6004              
  18    9.381570e-05   1.129148e-03   1.613317e-02   19        19        1         0         130912    137               35581             6049              6004              
  19    8.279546e-05   1.001779e-03   1.550009e-02   20        20        1         0         132716    143               36898             6050              6004              
  20    7.355010e-05   8.868479e-04   1.492949e-02   21        21        1         0         134526    149               38221             6051              6004              
  21    6.577198e-05   7.831211e-04   1.442028e-02   22        22        1         0         136345    155               39553             6052              6004              
  22    5.920659e-05   6.894933e-04   1.397135e-02   23        23        1         0         138170    161               40891             6053              6004              
  23    5.364349e-05   6.049785e-04   1.358167e-02   24        24        1         0         140004    167               42238             6054              6004              
  24    4.890881e-05   5.287011e-04   1.325042e-02   25        25        1         0         141856    173               43603             6055              6004              
  25    4.485893e-05   4.598890e-04   1.297711e-02   26        26        1         0         143729    179               44989             6056              6004              
  26    4.137517e-05   3.978694e-04   1.276166e-02   27        27        1         0         145611    185               46384             6057              6004              
  27    3.835942e-05   3.420665e-04   1.260455e-02   28        28        1         0         147502    191               47788             6058              6004              
  28    3.573049e-05   2.920035e-04   1.250693e-02   29        29        1         0         149393    197               49192             6059              6004              
  29    3.342106e-05   2.473100e-04   1.247073e-02   30        30        1         0         151281    203               50593             6060              6004              
  30    3.137517e-05   2.077368e-04   1.249889e-02   31        31        1         0         153157    209               51982             6061              6004              
  31    2.954613e-05   1.731822e-04   1.259552e-02   32        32        1         0         155066    215               53404             6062              6004              
  32    2.789473e-05   1.437285e-04   1.276632e-02   33        33        1         0         156984    221               54835             6063              6004              
  33    2.638786e-05   1.196753e-04   1.301900e-02   34        34        1         0         158908    227               56272             6064              6004              
  34    2.499712e-05   1.015107e-04   1.336432e-02   35        35        1         0         160844    233               57721             6065              6004              
  35    2.369756e-05   8.969481e-05   1.382094e-02   36        36        1         0         162747    239               59137             6066              6004              
  36    2.246119e-05   8.468092e-05   1.450681e-02   37        37        1         0         164662    245               60565             6067              6004              
  37    2.114274e-05   9.448226e-05   1.755496e-02   38        38        1         0         166640    251               62056             6068              6004              
  38    1.995671e-05   9.373160e-05   1.698525e-02   39        39        1         0         168588    257               63517             6069              6004              
  39    1.904925e-05   1.017325e-04   1.453911e-02   40        40        1         0         169916    262               64438             6070              6004              
  40    1.814107e-05   1.049967e-04   1.529164e-02   41        41        1         0         171241    267               65356             6071              6004              
  41    1.721834e-05   1.119114e-04   1.690250e-02   42        42        1         0         172575    272               66283             6072              6004              
  42    1.623602e-05   1.239083e-04   1.993161e-02   43        43        1         0         174532    278               67753             6073              6004              
  43    1.529499e-05   1.240428e-04   1.996169e-02   44        44        1         0         175875    283               68689             6074              6004              
  44    1.452583e-05   1.281611e-04   1.794753e-02   45        45        1         0         177239    288               69646             6075              6004              
  45    1.358139e-05   1.231471e-04   2.203831e-02   46        46        1         0         178573    293               70573             6076              6004              
  46    1.285218e-05   1.222137e-04   1.915271e-02   47        47        1         0         179958    298               71551             6077              6004              
  47    1.201151e-05   1.201016e-04   2.334385e-02   48        48        1         0         181912    304               73018             6078              6004              
  48    1.127929e-05   1.163240e-04   2.137969e-02   49        49        1         0         183273    309               73972             6079              6004              
  49    1.046249e-05   1.063209e-04   2.325298e-02   50        50        1         0         184628    314               74920             6080              6004              
  50    9.618578e-06   9.748723e-05   2.700958e-02   51        51        1         0         186028    319               75913             6081              6004              
  51    8.830905e-06   8.802957e-05   2.865854e-02   52        52        1         0         187359    324               76837             6082              6004              
  52    8.100533e-06   7.550017e-05   2.814563e-02   53        53        1         0         188771    329               77842             6083              6004              
  53    7.558021e-06   6.764025e-05   2.376536e-02   54        54        1         0         190132    334               78796             6084              6004              
  54    7.022525e-06   5.517722e-05   2.616143e-02   55        55        1         0         191475    339               79732             6085              6004              
  55    6.604309e-06   4.680539e-05   2.227808e-02   56        56        1         0         192848    344               80698             6086              6004              
  56    6.261173e-06   3.954379e-05   2.033752e-02   57        57        1         0         194239    349               81682             6087              6004              
  57    5.946250e-06   3.277392e-05   2.013054e-02   58        58        1         0         195639    354               82675             6088              6004              
  58    5.653511e-06   2.730977e-05   2.062099e-02   59        59        1         0         197018    359               83647             6089              6004              
  59    5.358338e-06   2.172578e-05   2.283767e-02   60        60        1         0         198415    364               84637             6090              6004              
  60    5.101754e-06   1.760758e-05   2.161381e-02   61        61        1         0         199785    369               85600             6091              6004              
  61    4.891336e-06   1.630705e-05   1.952399e-02   62        62        1         0         201197    374               86605             6092              6004              
  62    4.697521e-06   1.567083e-05   1.905578e-02   63        63        1         0         202597    379               87598             6093              6004              
  63    4.514653e-06   1.685586e-05   1.947695e-02   64        64        1         0         204006    384               88600             6094              6004              
  64    4.333190e-06   1.807448e-05   2.055349e-02   65        65        1         0         205424    389               89611             6095              6004              
  65    4.146151e-06   1.969953e-05   2.309733e-02   66        66        1         0         206788    394               90568             6096              6004              
  66    3.999373e-06   2.117963e-05   1.976484e-02   67        67        1         0         208218    399               91591             6097              6004              
  67    3.874094e-06   2.189121e-05   1.772340e-02   68        68        1         0         209630    404               92596             6098              6004              
  68    3.754295e-06   2.333477e-05   1.822847e-02   69        69        1         0         211081    409               93640             6099              6004              
  69    3.644393e-06   2.287892e-05   1.771709e-02   70        70        1         0         212478    414               94630             6100              6004              
  70    3.533326e-06   2.518428e-05   1.941282e-02   71        71        1         0         213911    419               95656             6101              6004              
  71    3.453395e-06   2.442008e-05   1.478151e-02   72        72        1         0         215362    424               96700             6102              6004              
  72    3.380264e-06   2.420460e-05   1.365924e-02   73        73        1         0         216819    429               97750             6103              6004              
  73    3.306193e-06   2.266198e-05   1.438611e-02   74        74        1         0         218246    434               98770             6104              6004              
  74    3.237399e-06   2.166502e-05   1.402707e-02   75        75        1         0         219673    439               99790             6105              6004              
  75    3.161204e-06   2.034372e-05   1.657537e-02   76        76        1         0         221061    444               100771            6106              6004              
  76    3.100872e-06   1.838378e-05   1.375079e-02   77        77        1         0         222488    449               101791            6107              6004              
  77    3.049877e-06   1.726917e-05   1.218349e-02   78        78        1         0         223924    454               102820            6108              6004              
  78    2.997522e-06   1.514682e-05   1.263957e-02   79        79        1         0         225405    459               103894            6109              6004              
  79    2.946020e-06   1.368663e-05   1.308147e-02   80        80        1         0         226811    464               104893            6110              6004              
  80    2.894918e-06   1.182793e-05   1.327311e-02   81        81        1         0         228292    469               105967            6111              6004              
  81    2.843096e-06   1.026099e-05   1.409170e-02   82        82        1         0         229719    474               106987            6112              6004              
  82    2.790880e-06   8.761328e-06   1.462970e-02   83        83        1         0         231191    479               108052            6113              6004              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 63.2589 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 4040 design variables: 4000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 9.96589e-06       0.00332973        0.0237072         4.97276           3.23066           2.43592           2.89093           32                1                 0                 45178             2                 42296             138               260               
2                 9.39187e-08       8.7197e-05        0.000383159       3.31932           3.29419           0.231757          0.335395          28                1                 0                 84376             3                 79027             259               488               
3                 4.75206e-11       2.5554e-06        3.47114e-06       0.521776          0.517478          0.0255413         0.0617633         32                1                 0                 128092            4                 119948            396               748               
4                 1.2642e-14        1.15272e-09       8.57254e-10       0.122536          0.122517          0.000583368       0.00210666        36                1                 0                 176884            5                 165617            549               1040              
5                 5.66204e-14       4.20579e-12       9.98612e-12       0.0201467         0.0201467         1.51493e-05       2.3722e-06        34                1                 0                 223297            6                 209071            694               1316              
Optimization Terminated with Status: Converged
The process took 37.2263 seconds to run.
Total n_vmult for algorithm 223297
