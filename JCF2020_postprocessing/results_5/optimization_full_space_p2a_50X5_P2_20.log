Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   8.745775e-03   
  1     1.452567e-03   8.713000e-03   8.745775e-04   2         2         1         0         123453    47                107125            576               548               
  2     1.255158e-03   7.851069e-03   2.408548e-02   3         3         1         0         126256    53                108841            577               548               
  3     1.086603e-03   7.070007e-03   2.332232e-02   4         4         1         0         129059    59                110557            578               548               
  4     9.422130e-04   6.358528e-03   2.280786e-02   5         5         1         0         131862    65                112273            579               548               
  5     8.191236e-04   5.712394e-03   2.228801e-02   6         6         1         0         134668    71                113992            580               548               
  6     7.145409e-04   5.126698e-03   2.176050e-02   7         7         1         0         137474    77                115711            581               548               
  7     6.258969e-04   4.596462e-03   2.122487e-02   8         8         1         0         140289    83                117439            582               548               
  8     5.508915e-04   4.116853e-03   2.068475e-02   9         9         1         0         143128    89                119191            583               548               
  9     4.874984e-04   3.683289e-03   2.014614e-02   10        10        1         0         145991    95                120967            584               548               
  10    4.339530e-04   3.291496e-03   1.961587e-02   11        11        1         0         148830    101               122719            585               548               
  11    3.887319e-04   2.937531e-03   1.910067e-02   12        12        1         0         151672    107               124474            586               548               
  12    3.505287e-04   2.617781e-03   1.860675e-02   13        13        1         0         153722    112               125617            587               548               
  13    3.182286e-04   2.328951e-03   1.813975e-02   14        14        1         0         155760    117               126748            588               548               
  14    2.908841e-04   2.068046e-03   1.770495e-02   15        15        1         0         157798    122               127879            589               548               
  15    2.676923e-04   1.832348e-03   1.730745e-02   16        16        1         0         159842    127               129016            590               548               
  16    2.479745e-04   1.619394e-03   1.695235e-02   17        17        1         0         161889    132               130156            591               548               
  17    2.311584e-04   1.426958e-03   1.664485e-02   18        18        1         0         163936    137               131296            592               548               
  18    2.167620e-04   1.253035e-03   1.639033e-02   19        19        1         0         166007    142               132460            593               548               
  19    2.043806e-04   1.095832e-03   1.619431e-02   20        20        1         0         168087    147               133633            594               548               
  20    1.936743e-04   9.537579e-04   1.606244e-02   21        21        1         0         170167    152               134806            595               548               
  21    1.843584e-04   8.254284e-04   1.600047e-02   22        22        1         0         172247    157               135979            596               548               
  22    1.761948e-04   7.096692e-04   1.601414e-02   23        23        1         0         174333    162               137158            597               548               
  23    1.689844e-04   6.055362e-04   1.610918e-02   24        24        1         0         176419    167               138337            598               548               
  24    1.625607e-04   5.123475e-04   1.629128e-02   25        25        1         0         178505    172               139516            599               548               
  25    1.567848e-04   4.297409e-04   1.656582e-02   26        26        1         0         180585    177               140689            600               548               
  26    1.515407e-04   3.577627e-04   1.693800e-02   27        27        1         0         182677    182               141874            601               548               
  27    1.467315e-04   2.969825e-04   1.741262e-02   28        28        1         0         184766    187               143056            602               548               
  28    1.422761e-04   2.485676e-04   1.799417e-02   29        29        1         0         186846    192               144229            603               548               
  29    1.381064e-04   2.140662e-04   1.868732e-02   30        30        1         0         188935    197               145411            604               548               
  30    1.341646e-04   1.944623e-04   1.949816e-02   31        31        1         0         191024    202               146593            605               548               
  31    1.304005e-04   1.886422e-04   2.043762e-02   32        32        1         0         193113    207               147775            606               548               
  32    1.267683e-04   1.928938e-04   2.152909e-02   33        33        1         0         195202    212               148957            607               548               
  33    1.232214e-04   2.023736e-04   2.282584e-02   34        34        1         0         197294    217               150142            608               548               
  34    1.197041e-04   2.128127e-04   2.445129e-02   35        35        1         0         199395    222               151336            609               548               
  35    1.161345e-04   2.211262e-04   2.669489e-02   36        36        1         0         201499    227               152533            610               548               
  36    1.123722e-04   2.255211e-04   3.024318e-02   37        37        1         0         203603    232               153730            611               548               
  37    1.081758e-04   2.250004e-04   3.654977e-02   38        38        1         0         205701    237               154921            612               548               
  38    1.035578e-04   3.157719e-04   5.456430e-02   39        39        1         0         207778    242               156091            613               548               
  39    9.965340e-05   3.024962e-04   4.015387e-02   40        40        1         0         209882    247               157288            614               548               
  40    9.579506e-05   2.864511e-04   4.275030e-02   41        41        1         0         211986    252               158485            615               548               
  41    9.164311e-05   2.706256e-04   5.054943e-02   42        42        1         0         214099    257               159691            616               548               
  42    8.637668e-05   2.533034e-04   7.436119e-02   43        43        1         0         216188    262               160873            617               548               
  43    8.283432e-05   2.347393e-04   5.293459e-02   44        44        1         0         218328    267               162106            618               548               
  44    7.979116e-05   2.146050e-04   4.993516e-02   45        45        1         0         220459    272               163330            619               548               
  45    7.654373e-05   2.076720e-04   5.768588e-02   46        46        1         0         222605    277               164569            620               548               
  46    7.352309e-05   1.813596e-04   5.873125e-02   47        47        1         0         224718    282               165775            621               548               
  47    7.124388e-05   1.664217e-04   4.863784e-02   48        48        1         0         226861    287               167011            622               548               
  48    6.902194e-05   1.588416e-04   5.247256e-02   49        49        1         0         228950    292               168193            623               548               
  49    6.701088e-05   1.375712e-04   5.048352e-02   50        50        1         0         231072    297               169408            624               548               
  50    6.556771e-05   1.267589e-04   3.985973e-02   51        51        1         0         233215    302               170644            625               548               
  51    6.426196e-05   1.129192e-04   3.759758e-02   52        52        1         0         235349    307               171871            626               548               
  52    6.307948e-05   1.036455e-04   3.676314e-02   53        53        1         0         237498    312               173113            627               548               
  53    6.200471e-05   9.152823e-05   3.496470e-02   54        54        1         0         239662    317               174370            628               548               
  54    6.102825e-05   8.320168e-05   3.433145e-02   55        55        1         0         241856    322               175657            629               548               
  55    6.013576e-05   7.253803e-05   3.307186e-02   56        56        1         0         244026    327               176920            630               548               
  56    5.931150e-05   6.483385e-05   3.300575e-02   57        57        1         0         246220    332               178207            631               548               
  57    5.853287e-05   5.605637e-05   3.338471e-02   58        58        1         0         248366    337               179446            632               548               
  58    5.773260e-05   4.722704e-05   3.713176e-02   59        59        1         0         250527    342               180700            633               548               
  59    5.704676e-05   4.056857e-05   3.476190e-02   60        60        1         0         252667    347               181933            634               548               
  60    5.644187e-05   3.444762e-05   3.273991e-02   61        61        1         0         254828    352               183187            635               548               
  61    5.587968e-05   3.043197e-05   3.245948e-02   62        62        1         0         257001    357               184453            636               548               
  62    5.531521e-05   2.782973e-05   3.411622e-02   63        63        1         0         259135    362               185680            637               548               
  63    5.472791e-05   2.703295e-05   3.729903e-02   64        64        1         0         261305    367               186943            638               548               
  64    5.410714e-05   2.876119e-05   4.101497e-02   65        65        1         0         263517    372               188248            639               548               
  65    5.343913e-05   3.187781e-05   4.600488e-02   66        66        1         0         265684    377               189508            640               548               
  66    5.271714e-05   3.667922e-05   5.150290e-02   67        67        1         0         267857    382               190774            641               548               
  67    5.192274e-05   4.358226e-05   5.862419e-02   68        68        1         0         270027    387               192037            642               548               
  68    5.105415e-05   4.779453e-05   6.653484e-02   69        69        1         0         272176    392               193279            643               548               
  69    5.002143e-05   7.100431e-05   8.349900e-02   70        70        1         0         274328    397               194524            644               548               
  70    4.919265e-05   7.931754e-05   6.977308e-02   71        71        1         0         276507    402               195796            645               548               
  71    4.822606e-05   8.321276e-05   8.213204e-02   72        72        1         0         278638    407               197020            646               548               
  72    4.712280e-05   9.524001e-05   9.504526e-02   73        73        1         0         280802    412               198277            647               548               
  73    4.591314e-05   9.864167e-05   1.058911e-01   74        74        1         0         282945    417               199513            648               548               
  74    4.458637e-05   1.115457e-04   1.175094e-01   75        75        1         0         285085    422               200746            649               548               
  75    4.318864e-05   1.134025e-04   1.265323e-01   76        76        1         0         287228    427               201982            650               548               
  76    4.171087e-05   1.234681e-04   1.345593e-01   77        77        1         0         289368    432               203215            651               548               
  77    4.022038e-05   1.232832e-04   1.396655e-01   78        78        1         0         291508    437               204448            652               548               
  78    3.872864e-05   1.234771e-04   1.396391e-01   79        79        1         0         293639    442               205672            653               548               
  79    3.725898e-05   1.220540e-04   1.424677e-01   80        80        1         0         295785    447               206911            654               548               
  80    3.587627e-05   1.136824e-04   1.361471e-01   81        81        1         0         297928    452               208147            655               548               
  81    3.463048e-05   1.108835e-04   1.275332e-01   82        82        1         0         300092    457               209404            656               548               
  82    3.349259e-05   1.031775e-04   1.185934e-01   83        83        1         0         302235    462               210640            657               548               
  83    3.247289e-05   9.704216e-05   1.095877e-01   84        84        1         0         304414    467               211912            658               548               
  84    3.158996e-05   9.238651e-05   9.781276e-02   85        85        1         0         306587    472               213178            659               548               
  85    3.080260e-05   8.349157e-05   8.911905e-02   86        86        1         0         308766    477               214450            660               548               
  86    3.012765e-05   7.834615e-05   7.997414e-02   87        87        1         0         310990    482               215767            661               548               
  87    2.955708e-05   7.086858e-05   6.970977e-02   88        88        1         0         313181    487               217051            662               548               
  88    2.907364e-05   6.592553e-05   6.169879e-02   89        89        1         0         315396    492               218359            663               548               
  89    2.866800e-05   5.962587e-05   5.392179e-02   90        90        1         0         317635    497               219691            664               548               
  90    2.832821e-05   5.466440e-05   4.723123e-02   91        91        1         0         319862    502               221011            665               548               
  91    2.804594e-05   4.951709e-05   4.121599e-02   92        92        1         0         322110    507               222352            666               548               
  92    2.781135e-05   4.493191e-05   3.593425e-02   93        93        1         0         324319    512               223654            667               548               
  93    2.761701e-05   4.056630e-05   3.144185e-02   94        94        1         0         326555    517               224983            668               548               
  94    2.745592e-05   3.655537e-05   2.747983e-02   95        95        1         0         328809    522               226330            669               548               
  95    2.732235e-05   3.283536e-05   2.416569e-02   96        96        1         0         331069    527               227683            670               548               
  96    2.721140e-05   2.940733e-05   2.128105e-02   97        97        1         0         333335    532               229042            671               548               
  97    2.711902e-05   2.624696e-05   1.886428e-02   98        98        1         0         335607    537               230407            672               548               
  98    2.704185e-05   2.333789e-05   1.678542e-02   99        99        1         0         337879    542               231772            673               548               
  99    2.697712e-05   2.065836e-05   1.503858e-02   100       100       1         0         340160    547               233146            674               548               
  100   2.692255e-05   1.819120e-05   1.355202e-02   101       101       1         0         342438    552               234517            675               548               
  101   2.687626e-05   1.591669e-05   1.230706e-02   102       102       1         0         344722    557               235894            676               548               
  102   2.683669e-05   1.381880e-05   1.126324e-02   103       103       1         0         347003    562               237268            677               548               
  103   2.680257e-05   1.188172e-05   1.040254e-02   104       104       1         0         349293    567               238651            678               548               
  104   2.677283e-05   1.009327e-05   9.701482e-03   105       105       1         0         351586    572               240037            679               548               
  105   2.674661e-05   8.445103e-06   9.146950e-03   106       106       1         0         353882    577               241426            680               548               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 347.263 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 9020 design variables: 9000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.25282e-06       0.00486085        0.0189946         6.84588           3.65838           3.44665           4.64789           288               1                 0                 18726             2                 2140              1162              1156              
2                 1.94003e-07       0.000195326       0.000459483       0.753212          0.307519          0.282485          0.626868          207               1                 0                 31840             3                 3391              1999              1988              
3                 1.45452e-10       2.08829e-05       1.23766e-05       0.955479          0.92658           0.0508714         0.227599          251               1                 0                 47682             4                 4906              3012              2996              
4                 1.65108e-13       1.00036e-08       5.27796e-09       0.0911973         0.0909992         0.00136786        0.00585029        273               1                 0                 64888             5                 6553              4113              4092              
5                 5.66611e-14       7.94972e-12       6.34971e-12       0.0217811         0.021781          2.96136e-05       1.46867e-05       251               1                 0                 80730             6                 8068              5126              5100              
Optimization Terminated with Status: Converged
The process took 159.151 seconds to run.
Total n_vmult for algorithm 80730
