Starting optimization with 320...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460802e-03   4.704430e-03   
  1     1.458590e-03   4.700228e-03   4.704430e-04   2         2         1         0         227143    75                194274            427               840               
  2     1.213801e-03   4.234157e-03   5.571397e-02   3         3         1         0         230915    81                196119            428               840               
  3     1.003481e-03   3.814655e-03   5.476180e-02   4         4         1         0         234705    87                197982            429               840               
  4     7.998099e-04   4.307496e-03   6.655275e-02   5         5         1         0         238324    93                199674            430               840               
  5     6.253833e-04   3.315011e-03   5.623973e-02   6         6         1         0         242060    99                201483            431               840               
  6     5.062283e-04   3.254675e-03   4.629967e-02   7         7         1         0         245862    105               203358            432               840               
  7     4.124926e-04   2.726484e-03   3.919977e-02   8         8         1         0         248735    110               204624            433               840               
  8     3.388547e-04   2.514140e-03   3.549844e-02   9         9         1         0         251629    115               205911            434               840               
  9     2.784546e-04   2.231596e-03   3.270993e-02   10        10        1         0         254532    120               207207            435               840               
  10    2.285703e-04   2.019317e-03   3.044287e-02   11        11        1         0         257441    125               208509            436               840               
  11    1.873148e-04   1.813844e-03   2.831379e-02   12        12        1         0         260365    130               209826            437               840               
  12    1.518238e-04   1.635943e-03   2.780955e-02   13        13        1         0         263295    135               211149            438               840               
  13    1.162749e-04   1.418905e-03   3.118154e-02   14        14        1         0         266222    140               212469            439               840               
  14    9.288873e-05   1.260273e-03   2.326834e-02   15        15        1         0         269161    145               213801            440               840               
  15    7.552329e-05   1.132897e-03   1.951310e-02   16        16        1         0         272127    150               215160            441               840               
  16    6.149077e-05   1.018204e-03   1.766169e-02   17        17        1         0         275102    155               216528            442               840               
  17    5.004462e-05   9.150533e-04   1.614071e-02   18        18        1         0         278086    160               217905            443               840               
  18    4.067124e-05   8.239618e-04   1.484223e-02   19        19        1         0         281073    165               219285            444               840               
  19    3.296517e-05   7.376298e-04   1.364958e-02   20        20        1         0         284078    170               220683            445               840               
  20    2.665137e-05   6.645929e-04   1.259163e-02   21        21        1         0         287080    175               222078            446               840               
  21    2.152069e-05   5.930851e-04   1.143160e-02   22        22        1         0         290109    180               223500            447               840               
  22    1.739895e-05   5.348832e-04   1.031988e-02   23        23        1         0         293126    185               224910            448               840               
  23    1.409844e-05   4.788200e-04   9.218914e-03   24        24        1         0         296167    190               226344            449               840               
  24    1.143939e-05   4.323464e-04   8.324582e-03   25        25        1         0         299196    195               227766            450               840               
  25    9.289362e-06   3.879626e-04   7.501832e-03   26        26        1         0         302246    200               229209            451               840               
  26    7.540070e-06   3.501878e-04   6.835087e-03   27        27        1         0         305290    205               230646            452               840               
  27    6.111163e-06   3.141560e-04   6.231130e-03   28        28        1         0         308337    210               232086            453               840               
  28    4.939751e-06   2.827961e-04   5.723977e-03   29        29        1         0         311393    215               233535            454               840               
  29    3.987401e-06   2.533897e-04   5.203962e-03   30        30        1         0         314446    220               234981            455               840               
  30    3.221761e-06   2.276932e-04   4.677847e-03   31        31        1         0         317529    225               236457            456               840               
  31    2.611571e-06   2.046016e-04   4.165851e-03   32        32        1         0         320609    230               237930            457               840               
  32    2.123174e-06   1.841297e-04   3.718027e-03   33        33        1         0         323710    235               239424            458               840               
  33    1.730675e-06   1.658752e-04   3.333865e-03   34        34        1         0         326820    240               240927            459               840               
  34    1.413849e-06   1.494044e-04   2.995664e-03   35        35        1         0         329939    245               242439            460               840               
  35    1.157486e-06   1.347216e-04   2.702500e-03   36        36        1         0         333061    250               243954            461               840               
  36    9.497453e-07   1.213733e-04   2.436071e-03   37        37        1         0         336186    255               245472            462               840               
  37    7.812996e-07   1.094723e-04   2.201520e-03   38        38        1         0         339320    260               246999            463               840               
  38    6.446925e-07   9.863647e-05   1.985624e-03   39        39        1         0         342460    265               248532            464               840               
  39    5.339060e-07   8.896948e-05   1.794379e-03   40        40        1         0         345603    270               250068            465               840               
  40    4.440664e-07   8.017609e-05   1.618288e-03   41        41        1         0         348752    275               251610            466               840               
  41    3.712114e-07   7.232114e-05   1.462092e-03   42        42        1         0         351904    280               253155            467               840               
  42    3.121257e-07   6.518672e-05   1.318922e-03   43        43        1         0         355065    285               254709            468               840               
  43    2.641972e-07   5.880259e-05   1.191847e-03   44        44        1         0         358226    290               256263            469               840               
  44    2.253099e-07   5.301163e-05   1.075920e-03   45        45        1         0         361396    295               257826            470               840               
  45    1.937484e-07   4.782023e-05   9.728789e-04   46        46        1         0         364569    300               259392            471               840               
  46    1.681243e-07   4.311590e-05   8.792188e-04   47        47        1         0         367751    305               260967            472               840               
  47    1.473132e-07   3.889169e-05   7.958093e-04   48        48        1         0         370936    310               262545            473               840               
  48    1.304050e-07   3.506665e-05   7.202014e-04   49        49        1         0         374127    315               264129            474               840               
  49    1.166624e-07   3.162743e-05   6.527448e-04   50        50        1         0         377324    320               265719            475               840               
  50    1.054882e-07   2.851459e-05   5.917346e-04   51        51        1         0         380530    325               267318            476               840               
  51    9.639870e-08   2.571250e-05   5.372172e-04   52        52        1         0         383742    330               268923            477               840               
  52    8.900144e-08   2.317752e-05   4.880050e-04   53        53        1         0         386966    335               270540            478               840               
  53    8.297838e-08   2.089338e-05   4.439913e-04   54        54        1         0         390196    340               272163            479               840               
  54    7.807151e-08   1.882745e-05   4.043252e-04   55        55        1         0         393432    345               273792            480               840               
  55    7.407156e-08   1.696443e-05   3.688299e-04   56        56        1         0         396677    350               275430            481               840               
  56    7.080866e-08   1.527951e-05   3.368917e-04   57        57        1         0         399931    355               277077            482               840               
  57    6.814496e-08   1.375898e-05   3.083082e-04   58        58        1         0         403194    360               278733            483               840               
  58    6.596855e-08   1.238372e-05   2.826293e-04   59        59        1         0         406469    365               280401            484               840               
  59    6.418854e-08   1.114177e-05   2.596545e-04   60        60        1         0         409756    370               282081            485               840               
  60    6.273113e-08   1.001823e-05   2.390482e-04   61        61        1         0         413052    375               283770            486               840               
  61    6.153635e-08   9.002887e-06   2.206262e-04   62        62        1         0         416357    380               285468            487               840               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 947.321 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 16320 design variables: 16000 simulation variables and 320 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 6.53242e-06       0.00507684        0.0186593         7.68769           0.640557          4.67569           6.06862           627               1                 0                 40096             2                 4246              2518              2512              
2                 7.74092e-07       0.000235899       0.000442966       0.999741          0.241127          0.380918          0.892323          466               1                 0                 69408             3                 7051              4391              4380              
3                 8.27331e-10       4.65887e-05       6.87231e-05       0.321997          0.174837          0.138632          0.232154          538               1                 0                 103184            4                 10288             6552              6536              
4                 1.04247e-12       7.18916e-08       3.15794e-08       0.0602066         0.0557685         0.00497253        0.0221356         609               1                 0                 141362            5                 13951             8997              8976              
5                 6.21559e-14       1.21465e-11       1.3264e-10        0.0355138         0.035513          0.000234961       6.54542e-05       708               1                 0                 185678            6                 18208             11838             11812             
Optimization Terminated with Status: Converged
The process took 1179.57 seconds to run.
Total n_vmult for algorithm 185678
