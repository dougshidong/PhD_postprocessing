Starting optimization with 640...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460802e-03   3.790713e-03   
  1     1.459366e-03   3.788094e-03   3.790713e-04   2         2         1         0         280708    75                245403            543               1072              
  2     1.232696e-03   3.416224e-03   6.572695e-02   3         3         1         0         284492    81                247260            544               1072              
  3     1.036651e-03   7.389563e-03   8.165786e-02   4         4         1         0         288048    87                248889            545               1072              
  4     8.486575e-04   5.597616e-03   6.454179e-02   5         5         1         0         291787    93                250701            546               1072              
  5     7.034930e-04   5.877877e-03   6.196061e-02   6         6         1         0         295586    99                252573            547               1072              
  6     5.848874e-04   4.728993e-03   5.271250e-02   7         7         1         0         299370    105               254430            548               1072              
  7     4.906867e-04   4.475660e-03   4.948858e-02   8         8         1         0         302255    110               255708            549               1072              
  8     4.112491e-04   3.966775e-03   4.625931e-02   9         9         1         0         305149    115               256995            550               1072              
  9     3.441838e-04   3.581427e-03   4.399462e-02   10        10        1         0         308046    120               258285            551               1072              
  10    2.881630e-04   3.223406e-03   4.101464e-02   11        11        1         0         310952    125               259584            552               1072              
  11    2.412182e-04   2.900545e-03   3.837595e-02   12        12        1         0         313861    130               260886            553               1072              
  12    2.016934e-04   2.607655e-03   3.610744e-02   13        13        1         0         316779    135               262197            554               1072              
  13    1.675370e-04   2.335245e-03   3.498789e-02   14        14        1         0         319715    140               263526            555               1072              
  14    1.368271e-04   2.067652e-03   3.536331e-02   15        15        1         0         322651    145               264855            556               1072              
  15    1.125590e-04   1.833631e-03   3.137925e-02   16        16        1         0         325590    150               266187            557               1072              
  16    9.400045e-05   1.640527e-03   2.701861e-02   17        17        1         0         328532    155               267522            558               1072              
  17    7.892949e-05   1.468958e-03   2.446052e-02   18        18        1         0         331486    160               268869            559               1072              
  18    6.642260e-05   1.316291e-03   2.265524e-02   19        19        1         0         334458    165               270234            560               1072              
  19    5.596234e-05   1.178542e-03   2.108650e-02   20        20        1         0         337439    170               271608            561               1072              
  20    4.717700e-05   1.055081e-03   1.973306e-02   21        21        1         0         340435    175               272997            562               1072              
  21    3.978379e-05   9.436377e-04   1.847241e-02   22        22        1         0         343437    180               274392            563               1072              
  22    3.355303e-05   8.437746e-04   1.733497e-02   23        23        1         0         346460    185               275808            564               1072              
  23    2.829723e-05   7.537390e-04   1.626005e-02   24        24        1         0         349501    190               277242            565               1072              
  24    2.385981e-05   6.732376e-04   1.528103e-02   25        25        1         0         352548    195               278682            566               1072              
  25    2.011044e-05   6.007000e-04   1.435221e-02   26        26        1         0         355601    200               280128            567               1072              
  26    1.693967e-05   5.360375e-04   1.350895e-02   27        27        1         0         358657    205               281577            568               1072              
  27    1.425632e-05   4.777087e-04   1.270464e-02   28        28        1         0         361725    210               283038            569               1072              
  28    1.198534e-05   4.258884e-04   1.196961e-02   29        29        1         0         364799    215               284505            570               1072              
  29    1.006643e-05   3.791440e-04   1.123882e-02   30        30        1         0         367882    220               285981            571               1072              
  30    8.450594e-06   3.379046e-04   1.053438e-02   31        31        1         0         370974    225               287466            572               1072              
  31    7.094528e-06   3.010221e-04   9.820244e-03   32        32        1         0         374069    230               288954            573               1072              
  32    5.957439e-06   2.687093e-04   9.155028e-03   33        33        1         0         377170    235               290448            574               1072              
  33    5.002664e-06   2.399749e-04   8.529157e-03   34        34        1         0         380280    240               291951            575               1072              
  34    4.199044e-06   2.147743e-04   7.968833e-03   35        35        1         0         383393    245               293457            576               1072              
  35    3.521319e-06   1.923730e-04   7.449772e-03   36        36        1         0         386512    250               294969            577               1072              
  36    2.949009e-06   1.726637e-04   6.977536e-03   37        37        1         0         389634    255               296484            578               1072              
  37    2.465433e-06   1.551238e-04   6.535560e-03   38        38        1         0         392762    260               298005            579               1072              
  38    2.056454e-06   1.395834e-04   6.133150e-03   39        39        1         0         395896    265               299532            580               1072              
  39    1.709199e-06   1.256588e-04   5.786241e-03   40        40        1         0         399036    270               301065            581               1072              
  40    1.410036e-06   1.128611e-04   5.559233e-03   41        41        1         0         402173    275               302595            582               1072              
  41    1.149591e-06   1.010918e-04   5.419051e-03   42        42        1         0         405310    280               304125            583               1072              
  42    9.375520e-07   9.031430e-05   4.932366e-03   43        43        1         0         408459    285               305667            584               1072              
  43    7.747563e-07   8.168134e-05   4.237889e-03   44        44        1         0         411623    290               307224            585               1072              
  44    6.442081e-07   7.348936e-05   3.780325e-03   45        45        1         0         414781    295               308775            586               1072              
  45    5.365919e-07   6.745689e-05   3.470157e-03   46        46        1         0         417963    300               310350            587               1072              
  46    4.423750e-07   5.788242e-05   3.429624e-03   47        47        1         0         421097    305               311877            588               1072              
  47    3.646529e-07   5.275457e-05   3.117829e-03   48        48        1         0         424285    310               313458            589               1072              
  48    3.049309e-07   4.638036e-05   2.747503e-03   49        49        1         0         427437    315               315003            590               1072              
  49    2.570289e-07   4.212729e-05   2.403898e-03   50        50        1         0         430628    320               316587            591               1072              
  50    2.193410e-07   3.780421e-05   2.136573e-03   51        51        1         0         433798    325               318150            592               1072              
  51    1.885572e-07   3.419484e-05   1.920892e-03   52        52        1         0         436965    330               319710            593               1072              
  52    1.633540e-07   3.072754e-05   1.763919e-03   53        53        1         0         440126    335               321264            594               1072              
  53    1.423229e-07   2.752465e-05   1.636719e-03   54        54        1         0         443287    340               322818            595               1072              
  54    1.247792e-07   2.456479e-05   1.530279e-03   55        55        1         0         446424    345               324348            596               1072              
  55    1.108044e-07   2.180271e-05   1.365128e-03   56        56        1         0         449591    350               325908            597               1072              
  56    1.000594e-07   1.948521e-05   1.171459e-03   57        57        1         0         452773    355               327483            598               1072              
  57    9.154143e-08   1.739984e-05   1.036858e-03   58        58        1         0         455991    360               329094            599               1072              
  58    8.466539e-08   1.554967e-05   9.304903e-04   59        59        1         0         459236    365               330732            600               1072              
  59    7.908653e-08   1.387352e-05   8.408978e-04   60        60        1         0         462469    370               332358            601               1072              
  60    7.455256e-08   1.237860e-05   7.601399e-04   61        61        1         0         465711    375               333993            602               1072              
  61    7.086595e-08   1.101787e-05   6.880903e-04   62        62        1         0         468956    380               335631            603               1072              
  62    6.786728e-08   9.833215e-06   6.230324e-04   63        63        1         0         472225    385               337293            604               1072              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 1169.93 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 16640 design variables: 16000 simulation variables and 640 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 6.55725e-06       0.0047862         0.0187528         7.71843           0.86426           4.68356           6.07383           743               1                 0                 47288             2                 4942              2982              2976              
2                 7.68904e-07       0.000244601       0.000443812       1.31297           0.884665          0.380931          0.89227           464               1                 0                 76476             3                 7735              4847              4836              
3                 8.34594e-10       4.99345e-05       6.92003e-05       0.890562          0.849734          0.138016          0.228044          641               1                 0                 116638            4                 11590             7420              7404              
4                 5.85887e-12       9.20877e-08       3.33405e-08       3.26106           3.26098           0.00525818        0.0216129         774               1                 0                 165046            5                 16243             10525             10504             
5                 1.37033e-12       1.0763e-11        3.27949e-10       2.87558           2.87558           0.000531595       3.36146e-05       855               1                 0                 218476            6                 21382             13954             13928             
Optimization Terminated with Status: Converged
The process took 1412.77 seconds to run.
Total n_vmult for algorithm 218476
