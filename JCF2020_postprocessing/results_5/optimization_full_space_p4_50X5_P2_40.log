Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   7.437042e-03   
  1     1.454677e-03   7.419454e-03   7.437042e-04   2         2         1         0         117227    47                17011             6568              6540              
  2     1.229206e-03   6.686226e-03   3.222978e-02   3         3         1         0         119985    53                18682             6569              6540              
  3     1.038176e-03   6.024536e-03   3.082216e-02   4         4         1         0         122752    59                20362             6570              6540              
  4     8.753824e-04   5.422619e-03   2.981558e-02   5         5         1         0         125525    65                22048             6571              6540              
  5     7.374359e-04   4.876816e-03   2.877725e-02   6         6         1         0         128313    71                23749             6572              6540              
  6     6.210556e-04   4.382924e-03   2.770169e-02   7         7         1         0         131125    77                25474             6573              6540              
  7     5.232121e-04   3.936632e-03   2.659550e-02   8         8         1         0         133952    83                27214             6574              6540              
  8     4.411801e-04   3.533723e-03   2.547330e-02   9         9         1         0         136788    89                28963             6575              6540              
  9     3.725532e-04   3.170194e-03   2.435197e-02   10        10        1         0         139648    95                30736             6576              6540              
  10    3.152355e-04   2.842313e-03   2.324745e-02   11        11        1         0         142520    101               32521             6577              6540              
  11    2.674214e-04   2.546647e-03   2.217331e-02   12        12        1         0         144531    106               33625             6578              6540              
  12    2.275675e-04   2.280057e-03   2.114018e-02   13        13        1         0         146551    111               34738             6579              6540              
  13    1.943634e-04   2.039694e-03   2.015598e-02   14        14        1         0         148571    116               35851             6580              6540              
  14    1.667023e-04   1.822973e-03   1.922623e-02   15        15        1         0         150594    121               36967             6581              6540              
  15    1.436529e-04   1.627559e-03   1.835453e-02   16        16        1         0         152641    126               38107             6582              6540              
  16    1.244347e-04   1.451339e-03   1.754300e-02   17        17        1         0         154691    131               39250             6583              6540              
  17    1.083952e-04   1.292410e-03   1.679269e-02   18        18        1         0         156741    136               40393             6584              6540              
  18    9.499035e-05   1.149053e-03   1.610386e-02   19        19        1         0         158791    141               41536             6585              6540              
  19    8.376732e-05   1.019720e-03   1.547626e-02   20        20        1         0         160841    146               42679             6586              6540              
  20    7.435005e-05   9.030163e-04   1.490928e-02   21        21        1         0         162897    151               43828             6587              6540              
  21    6.642659e-05   7.976908e-04   1.440219e-02   22        22        1         0         164953    156               44977             6588              6540              
  22    5.973848e-05   7.026207e-04   1.395421e-02   23        23        1         0         167009    161               46126             6589              6540              
  23    5.407185e-05   6.168028e-04   1.356461e-02   24        24        1         0         169062    166               47272             6590              6540              
  24    4.924979e-05   5.393450e-04   1.323287e-02   25        25        1         0         171112    171               48415             6591              6540              
  25    4.512604e-05   4.694596e-04   1.295871e-02   26        26        1         0         173168    176               49564             6592              6540              
  26    4.157970e-05   4.064587e-04   1.274220e-02   27        27        1         0         175233    181               50722             6593              6540              
  27    3.851079e-05   3.497522e-04   1.258385e-02   28        28        1         0         177301    186               51883             6594              6540              
  28    3.583659e-05   2.988495e-04   1.248470e-02   29        29        1         0         179372    191               53047             6595              6540              
  29    3.348854e-05   2.533666e-04   1.244641e-02   30        30        1         0         181467    196               54235             6596              6540              
  30    3.140972e-05   2.130399e-04   1.247144e-02   31        31        1         0         183577    201               55438             6597              6540              
  31    2.955270e-05   1.777505e-04   1.256319e-02   32        32        1         0         185684    206               56638             6598              6540              
  32    2.787781e-05   1.475595e-04   1.272631e-02   33        33        1         0         187791    211               57838             6599              6540              
  33    2.635162e-05   1.227417e-04   1.296715e-02   34        34        1         0         189913    216               59053             6600              6540              
  34    2.494565e-05   1.037641e-04   1.329449e-02   35        35        1         0         192038    221               60271             6601              6540              
  35    2.363531e-05   9.108193e-05   1.372078e-02   36        36        1         0         194142    226               61468             6602              6540              
  36    2.239876e-05   8.465233e-05   1.426422e-02   37        37        1         0         196249    231               62668             6603              6540              
  37    2.121596e-05   8.347122e-05   1.495226e-02   38        38        1         0         198365    236               63877             6604              6540              
  38    2.006752e-05   8.574563e-05   1.582738e-02   39        39        1         0         200493    241               65098             6605              6540              
  39    1.893347e-05   8.957773e-05   1.695635e-02   40        40        1         0         202615    246               66313             6606              6540              
  40    1.779186e-05   9.345865e-05   1.844375e-02   41        41        1         0         204746    251               67537             6607              6540              
  41    1.661780e-05   9.632582e-05   2.046675e-02   42        42        1         0         206883    256               68767             6608              6540              
  42    1.535717e-05   1.472244e-04   2.959620e-02   43        43        1         0         209005    261               69982             6609              6540              
  43    1.438019e-05   1.416187e-04   2.014323e-02   44        44        1         0         211097    266               71167             6610              6540              
  44    1.348821e-05   1.354453e-04   1.969895e-02   45        45        1         0         213243    271               72406             6611              6540              
  45    1.259582e-05   1.287426e-04   2.120851e-02   46        46        1         0         215392    276               73648             6612              6540              
  46    1.158569e-05   1.351949e-04   2.945236e-02   47        47        1         0         217502    281               74851             6613              6540              
  47    1.086542e-05   1.258707e-04   2.060484e-02   48        48        1         0         219654    286               76096             6614              6540              
  48    1.025782e-05   1.177287e-04   1.877109e-02   49        49        1         0         221797    291               77332             6615              6540              
  49    9.680102e-06   1.088361e-04   1.907708e-02   50        50        1         0         223985    296               78613             6616              6540              
  50    9.104870e-06   1.010329e-04   2.087515e-02   51        51        1         0         226170    301               79891             6617              6540              
  51    8.521827e-06   8.920109e-05   2.291413e-02   52        52        1         0         228319    306               81133             6618              6540              
  52    8.109992e-06   8.145246e-05   1.793356e-02   53        53        1         0         230504    311               82411             6619              6540              
  53    7.753375e-06   7.333057e-05   1.663504e-02   54        54        1         0         232707    316               83707             6620              6540              
  54    7.422012e-06   6.670988e-05   1.664156e-02   55        55        1         0         234895    321               84988             6621              6540              
  55    7.090576e-06   5.766878e-05   1.817522e-02   56        56        1         0         237128    326               86314             6622              6540              
  56    6.801030e-06   5.052325e-05   1.707095e-02   57        57        1         0         239322    331               87601             6623              6540              
  57    6.559300e-06   4.451167e-05   1.549207e-02   58        58        1         0         241522    336               88894             6624              6540              
  58    6.326986e-06   3.807658e-05   1.588329e-02   59        59        1         0         243770    341               90235             6625              6540              
  59    6.108368e-06   3.297275e-05   1.604753e-02   60        60        1         0         245955    346               91513             6626              6540              
  60    5.908724e-06   2.798705e-05   1.569853e-02   61        61        1         0         248182    351               92833             6627              6540              
  61    5.725211e-06   2.443968e-05   1.523568e-02   62        62        1         0         250385    356               94129             6628              6540              
  62    5.548588e-06   2.188176e-05   1.544349e-02   63        63        1         0         252600    361               95437             6629              6540              
  63    5.370767e-06   2.046165e-05   1.623643e-02   64        64        1         0         254839    366               96769             6630              6540              
  64    5.184668e-06   2.067746e-05   1.795571e-02   65        65        1         0         257027    371               98050             6631              6540              
  65    4.984238e-06   2.212659e-05   2.052692e-02   66        66        1         0         259242    376               99358             6632              6540              
  66    4.814418e-06   2.399862e-05   1.835175e-02   67        67        1         0         261451    381               100660            6633              6540              
  67    4.652152e-06   2.660645e-05   1.812010e-02   68        68        1         0         263669    386               101971            6634              6540              
  68    4.484170e-06   2.869736e-05   1.913225e-02   69        69        1         0         265875    391               103270            6635              6540              
  69    4.307454e-06   3.143785e-05   2.062525e-02   70        70        1         0         268138    396               104626            6636              6540              
  70    4.117027e-06   3.294383e-05   2.296363e-02   71        71        1         0         270293    401               105874            6637              6540              
  71    3.898504e-06   3.524141e-05   2.822167e-02   72        72        1         0         272484    406               107158            6638              6540              
  72    3.732344e-06   3.648940e-05   2.258086e-02   73        73        1         0         274747    411               108514            6639              6540              
  73    3.582600e-06   3.625749e-05   2.092883e-02   74        74        1         0         277004    416               109864            6640              6540              
  74    3.431164e-06   3.738421e-05   2.196830e-02   75        75        1         0         279264    421               111217            6641              6540              
  75    3.292626e-06   3.560520e-05   2.101208e-02   76        76        1         0         281488    426               112534            6642              6540              
  76    3.160966e-06   3.543642e-05   2.105466e-02   77        77        1         0         283760    431               113899            6643              6540              
  77    3.055602e-06   3.372964e-05   1.757827e-02   78        78        1         0         285981    436               115213            6644              6540              
  78    2.967365e-06   3.220470e-05   1.506461e-02   79        79        1         0         288256    441               116581            6645              6540              
  79    2.886525e-06   3.027540e-05   1.414007e-02   80        80        1         0         290525    446               117943            6646              6540              
  80    2.813638e-06   2.818972e-05   1.311197e-02   81        81        1         0         292800    451               119311            6647              6540              
  81    2.748895e-06   2.597357e-05   1.210815e-02   82        82        1         0         295024    456               120628            6648              6540              
  82    2.691208e-06   2.377486e-05   1.121418e-02   83        83        1         0         297323    461               122020            6649              6540              
  83    2.639652e-06   2.148220e-05   1.051435e-02   84        84        1         0         299586    466               123376            6650              6540              
  84    2.593465e-06   1.926483e-05   9.912276e-03   85        85        1         0         301870    471               124753            6651              6540              
  85    2.551761e-06   1.702240e-05   9.482800e-03   86        86        1         0         304139    476               126115            6652              6540              
  86    2.514129e-06   1.484866e-05   9.094454e-03   87        87        1         0         306426    481               127495            6653              6540              
  87    2.480782e-06   1.278139e-05   8.578524e-03   88        88        1         0         308731    486               128893            6654              6540              
  88    2.451041e-06   1.084172e-05   8.133754e-03   89        89        1         0         311027    491               130282            6655              6540              
  89    2.423879e-06   9.037850e-06   7.881721e-03   90        90        1         0         313356    496               131704            6656              6540              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 318.608 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 9040 design variables: 9000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.38036e-06       0.00514459        0.0219177         9.19471           7.13443           3.51178           4.61627           32                1                 0                 53865             2                 50783             138               260               
2                 3.69802e-07       0.000179675       0.000533079       3.34008           3.26612           0.29465           0.633816          28                1                 0                 100783            3                 95134             259               488               
3                 1.77255e-10       1.98847e-05       2.41868e-05       3.74546           3.74138           0.0697736         0.160255          30                1                 0                 150875            4                 142495            388               732               
4                 5.03137e-13       1.03562e-08       5.01244e-09       0.101576          0.101304          0.00157111        0.00726677        33                1                 0                 206004            5                 194647            529               1000              
5                 5.45701e-13       1.85409e-11       1.47066e-11       0.0137949         0.0137949         3.00893e-05       4.05029e-06       34                1                 0                 261994            6                 247578            674               1276              
Optimization Terminated with Status: Converged
The process took 417.728 seconds to run.
Total n_vmult for algorithm 261994
