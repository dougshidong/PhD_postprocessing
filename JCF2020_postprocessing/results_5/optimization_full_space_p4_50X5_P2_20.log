Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   8.745775e-03   
  1     1.452567e-03   8.713000e-03   8.745775e-04   2         2         1         0         94898     47                14842             5128              5100              
  2     1.255158e-03   7.851069e-03   2.408548e-02   3         3         1         0         97701     53                16558             5129              5100              
  3     1.086603e-03   7.070007e-03   2.332232e-02   4         4         1         0         100504    59                18274             5130              5100              
  4     9.422130e-04   6.358528e-03   2.280786e-02   5         5         1         0         103307    65                19990             5131              5100              
  5     8.191236e-04   5.712394e-03   2.228801e-02   6         6         1         0         106113    71                21709             5132              5100              
  6     7.145409e-04   5.126698e-03   2.176050e-02   7         7         1         0         108919    77                23428             5133              5100              
  7     6.258969e-04   4.596462e-03   2.122487e-02   8         8         1         0         111734    83                25156             5134              5100              
  8     5.508915e-04   4.116853e-03   2.068475e-02   9         9         1         0         114573    89                26908             5135              5100              
  9     4.874984e-04   3.683289e-03   2.014614e-02   10        10        1         0         117436    95                28684             5136              5100              
  10    4.339530e-04   3.291496e-03   1.961587e-02   11        11        1         0         120275    101               30436             5137              5100              
  11    3.887319e-04   2.937531e-03   1.910067e-02   12        12        1         0         123117    107               32191             5138              5100              
  12    3.505287e-04   2.617781e-03   1.860675e-02   13        13        1         0         125167    112               33334             5139              5100              
  13    3.182286e-04   2.328951e-03   1.813975e-02   14        14        1         0         127205    117               34465             5140              5100              
  14    2.908841e-04   2.068046e-03   1.770495e-02   15        15        1         0         129243    122               35596             5141              5100              
  15    2.676923e-04   1.832348e-03   1.730745e-02   16        16        1         0         131287    127               36733             5142              5100              
  16    2.479745e-04   1.619394e-03   1.695235e-02   17        17        1         0         133334    132               37873             5143              5100              
  17    2.311584e-04   1.426958e-03   1.664485e-02   18        18        1         0         135381    137               39013             5144              5100              
  18    2.167620e-04   1.253035e-03   1.639033e-02   19        19        1         0         137452    142               40177             5145              5100              
  19    2.043806e-04   1.095832e-03   1.619431e-02   20        20        1         0         139532    147               41350             5146              5100              
  20    1.936743e-04   9.537579e-04   1.606244e-02   21        21        1         0         141612    152               42523             5147              5100              
  21    1.843584e-04   8.254284e-04   1.600047e-02   22        22        1         0         143692    157               43696             5148              5100              
  22    1.761948e-04   7.096692e-04   1.601414e-02   23        23        1         0         145778    162               44875             5149              5100              
  23    1.689844e-04   6.055362e-04   1.610918e-02   24        24        1         0         147864    167               46054             5150              5100              
  24    1.625607e-04   5.123475e-04   1.629128e-02   25        25        1         0         149950    172               47233             5151              5100              
  25    1.567848e-04   4.297409e-04   1.656582e-02   26        26        1         0         152030    177               48406             5152              5100              
  26    1.515407e-04   3.577627e-04   1.693800e-02   27        27        1         0         154122    182               49591             5153              5100              
  27    1.467315e-04   2.969825e-04   1.741262e-02   28        28        1         0         156211    187               50773             5154              5100              
  28    1.422761e-04   2.485676e-04   1.799417e-02   29        29        1         0         158291    192               51946             5155              5100              
  29    1.381064e-04   2.140662e-04   1.868732e-02   30        30        1         0         160380    197               53128             5156              5100              
  30    1.341646e-04   1.944623e-04   1.949816e-02   31        31        1         0         162469    202               54310             5157              5100              
  31    1.304005e-04   1.886422e-04   2.043762e-02   32        32        1         0         164558    207               55492             5158              5100              
  32    1.267683e-04   1.928938e-04   2.152909e-02   33        33        1         0         166647    212               56674             5159              5100              
  33    1.232214e-04   2.023736e-04   2.282584e-02   34        34        1         0         168739    217               57859             5160              5100              
  34    1.197041e-04   2.128127e-04   2.445129e-02   35        35        1         0         170840    222               59053             5161              5100              
  35    1.161345e-04   2.211262e-04   2.669489e-02   36        36        1         0         172944    227               60250             5162              5100              
  36    1.123722e-04   2.255211e-04   3.024318e-02   37        37        1         0         175048    232               61447             5163              5100              
  37    1.081758e-04   2.250004e-04   3.654977e-02   38        38        1         0         177146    237               62638             5164              5100              
  38    1.035578e-04   3.157719e-04   5.456430e-02   39        39        1         0         179223    242               63808             5165              5100              
  39    9.965340e-05   3.024962e-04   4.015387e-02   40        40        1         0         181327    247               65005             5166              5100              
  40    9.579506e-05   2.864511e-04   4.275030e-02   41        41        1         0         183431    252               66202             5167              5100              
  41    9.164311e-05   2.706256e-04   5.054943e-02   42        42        1         0         185544    257               67408             5168              5100              
  42    8.637668e-05   2.533034e-04   7.436119e-02   43        43        1         0         187633    262               68590             5169              5100              
  43    8.283432e-05   2.347393e-04   5.293459e-02   44        44        1         0         189773    267               69823             5170              5100              
  44    7.979116e-05   2.146050e-04   4.993516e-02   45        45        1         0         191904    272               71047             5171              5100              
  45    7.654373e-05   2.076720e-04   5.768588e-02   46        46        1         0         194050    277               72286             5172              5100              
  46    7.352309e-05   1.813596e-04   5.873125e-02   47        47        1         0         196163    282               73492             5173              5100              
  47    7.124388e-05   1.664217e-04   4.863784e-02   48        48        1         0         198306    287               74728             5174              5100              
  48    6.902194e-05   1.588416e-04   5.247256e-02   49        49        1         0         200395    292               75910             5175              5100              
  49    6.701088e-05   1.375712e-04   5.048352e-02   50        50        1         0         202517    297               77125             5176              5100              
  50    6.556771e-05   1.267589e-04   3.985973e-02   51        51        1         0         204660    302               78361             5177              5100              
  51    6.426196e-05   1.129192e-04   3.759758e-02   52        52        1         0         206794    307               79588             5178              5100              
  52    6.307948e-05   1.036455e-04   3.676314e-02   53        53        1         0         208943    312               80830             5179              5100              
  53    6.200471e-05   9.152823e-05   3.496470e-02   54        54        1         0         211107    317               82087             5180              5100              
  54    6.102825e-05   8.320168e-05   3.433145e-02   55        55        1         0         213301    322               83374             5181              5100              
  55    6.013576e-05   7.253803e-05   3.307186e-02   56        56        1         0         215471    327               84637             5182              5100              
  56    5.931150e-05   6.483385e-05   3.300575e-02   57        57        1         0         217665    332               85924             5183              5100              
  57    5.853287e-05   5.605637e-05   3.338471e-02   58        58        1         0         219811    337               87163             5184              5100              
  58    5.773260e-05   4.722704e-05   3.713176e-02   59        59        1         0         221972    342               88417             5185              5100              
  59    5.704676e-05   4.056857e-05   3.476190e-02   60        60        1         0         224112    347               89650             5186              5100              
  60    5.644187e-05   3.444762e-05   3.273991e-02   61        61        1         0         226273    352               90904             5187              5100              
  61    5.587968e-05   3.043197e-05   3.245948e-02   62        62        1         0         228446    357               92170             5188              5100              
  62    5.531521e-05   2.782973e-05   3.411622e-02   63        63        1         0         230580    362               93397             5189              5100              
  63    5.472791e-05   2.703295e-05   3.729903e-02   64        64        1         0         232750    367               94660             5190              5100              
  64    5.410714e-05   2.876119e-05   4.101497e-02   65        65        1         0         234962    372               95965             5191              5100              
  65    5.343913e-05   3.187781e-05   4.600488e-02   66        66        1         0         237129    377               97225             5192              5100              
  66    5.271714e-05   3.667922e-05   5.150290e-02   67        67        1         0         239302    382               98491             5193              5100              
  67    5.192274e-05   4.358226e-05   5.862419e-02   68        68        1         0         241472    387               99754             5194              5100              
  68    5.105415e-05   4.779453e-05   6.653484e-02   69        69        1         0         243621    392               100996            5195              5100              
  69    5.002143e-05   7.100431e-05   8.349900e-02   70        70        1         0         245773    397               102241            5196              5100              
  70    4.919265e-05   7.931754e-05   6.977308e-02   71        71        1         0         247952    402               103513            5197              5100              
  71    4.822606e-05   8.321276e-05   8.213204e-02   72        72        1         0         250083    407               104737            5198              5100              
  72    4.712280e-05   9.524001e-05   9.504526e-02   73        73        1         0         252247    412               105994            5199              5100              
  73    4.591314e-05   9.864167e-05   1.058911e-01   74        74        1         0         254390    417               107230            5200              5100              
  74    4.458637e-05   1.115457e-04   1.175094e-01   75        75        1         0         256530    422               108463            5201              5100              
  75    4.318864e-05   1.134025e-04   1.265323e-01   76        76        1         0         258673    427               109699            5202              5100              
  76    4.171087e-05   1.234681e-04   1.345593e-01   77        77        1         0         260813    432               110932            5203              5100              
  77    4.022038e-05   1.232832e-04   1.396655e-01   78        78        1         0         262953    437               112165            5204              5100              
  78    3.872864e-05   1.234771e-04   1.396391e-01   79        79        1         0         265084    442               113389            5205              5100              
  79    3.725898e-05   1.220540e-04   1.424677e-01   80        80        1         0         267230    447               114628            5206              5100              
  80    3.587627e-05   1.136824e-04   1.361471e-01   81        81        1         0         269373    452               115864            5207              5100              
  81    3.463048e-05   1.108835e-04   1.275332e-01   82        82        1         0         271537    457               117121            5208              5100              
  82    3.349259e-05   1.031775e-04   1.185934e-01   83        83        1         0         273680    462               118357            5209              5100              
  83    3.247289e-05   9.704216e-05   1.095877e-01   84        84        1         0         275859    467               119629            5210              5100              
  84    3.158996e-05   9.238651e-05   9.781276e-02   85        85        1         0         278032    472               120895            5211              5100              
  85    3.080260e-05   8.349157e-05   8.911905e-02   86        86        1         0         280211    477               122167            5212              5100              
  86    3.012765e-05   7.834615e-05   7.997414e-02   87        87        1         0         282435    482               123484            5213              5100              
  87    2.955708e-05   7.086858e-05   6.970977e-02   88        88        1         0         284626    487               124768            5214              5100              
  88    2.907364e-05   6.592553e-05   6.169879e-02   89        89        1         0         286841    492               126076            5215              5100              
  89    2.866800e-05   5.962587e-05   5.392179e-02   90        90        1         0         289080    497               127408            5216              5100              
  90    2.832821e-05   5.466440e-05   4.723123e-02   91        91        1         0         291307    502               128728            5217              5100              
  91    2.804594e-05   4.951709e-05   4.121599e-02   92        92        1         0         293555    507               130069            5218              5100              
  92    2.781135e-05   4.493191e-05   3.593425e-02   93        93        1         0         295764    512               131371            5219              5100              
  93    2.761701e-05   4.056630e-05   3.144185e-02   94        94        1         0         298000    517               132700            5220              5100              
  94    2.745592e-05   3.655537e-05   2.747983e-02   95        95        1         0         300254    522               134047            5221              5100              
  95    2.732235e-05   3.283536e-05   2.416569e-02   96        96        1         0         302514    527               135400            5222              5100              
  96    2.721140e-05   2.940733e-05   2.128105e-02   97        97        1         0         304780    532               136759            5223              5100              
  97    2.711902e-05   2.624696e-05   1.886428e-02   98        98        1         0         307052    537               138124            5224              5100              
  98    2.704185e-05   2.333789e-05   1.678542e-02   99        99        1         0         309324    542               139489            5225              5100              
  99    2.697712e-05   2.065836e-05   1.503858e-02   100       100       1         0         311605    547               140863            5226              5100              
  100   2.692255e-05   1.819120e-05   1.355202e-02   101       101       1         0         313883    552               142234            5227              5100              
  101   2.687626e-05   1.591669e-05   1.230706e-02   102       102       1         0         316167    557               143611            5228              5100              
  102   2.683669e-05   1.381880e-05   1.126324e-02   103       103       1         0         318448    562               144985            5229              5100              
  103   2.680257e-05   1.188172e-05   1.040254e-02   104       104       1         0         320738    567               146368            5230              5100              
  104   2.677283e-05   1.009327e-05   9.701482e-03   105       105       1         0         323031    572               147754            5231              5100              
  105   2.674661e-05   8.445103e-06   9.146950e-03   106       106       1         0         325327    577               149143            5232              5100              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 346.695 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 9020 design variables: 9000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.35359e-06       0.0048716         0.019018          7.25143           4.37008           3.44705           4.64796           24                1                 0                 40977             2                 38551             106               196               
2                 2.03668e-07       0.000189927       0.000460831       1.3694            1.18642           0.283966          0.622132          20                1                 0                 74533             3                 70196             195               360               
3                 1.34284e-10       2.01924e-05       1.29959e-05       1.58249           1.56656           0.0520456         0.217876          22                1                 0                 111461            4                 105049            292               540               
4                 3.4095e-13        9.24735e-09       4.7789e-09        0.125433          0.125297          0.00132215        0.00569475        24                1                 0                 151962            5                 143311            397               736               
5                 3.95832e-13       7.25693e-12       2.10148e-12       0.0184703         0.0184703         2.50002e-05       1.26091e-05       23                1                 0                 190507            6                 179699            498               924               
Optimization Terminated with Status: Converged
The process took 332.392 seconds to run.
Total n_vmult for algorithm 190507
