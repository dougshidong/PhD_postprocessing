Starting optimization with 640...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   
  0     1.446428e-03   3.737475e-03   
  1     1.445031e-03   3.734793e-03   3.737475e-04   2         2         1         0         6984      
  2     1.206903e-03   7.246435e-03   8.616010e-02   3         3         1         0         8761      
  3     1.021498e-03   5.874314e-03   5.673037e-02   4         4         1         0         10517     
  4     8.923335e-04   5.611920e-03   4.730556e-02   5         5         1         0         12270     
  5     7.591716e-04   4.728216e-03   5.256848e-02   6         6         1         0         14053     
  6     6.405896e-04   4.338482e-03   5.389781e-02   7         7         1         0         15818     
  7     5.387939e-04   3.839036e-03   5.156954e-02   8         8         1         0         17625     
  8     4.518076e-04   3.448561e-03   4.968202e-02   9         9         1         0         19387     
  9     3.781691e-04   3.082566e-03   4.695699e-02   10        10        1         0         21182     
  10    3.153530e-04   2.760831e-03   4.512625e-02   11        11        1         0         22941     
  11    2.614500e-04   2.456771e-03   4.317907e-02   12        12        1         0         24751     
  12    2.159524e-04   2.187108e-03   4.119027e-02   13        13        1         0         26543     
  13    1.784764e-04   1.947499e-03   3.800328e-02   14        14        1         0         28380     
  14    1.451541e-04   1.723799e-03   3.846008e-02   15        15        1         0         30205     
  15    1.170355e-04   1.500230e-03   3.617515e-02   16        16        1         0         32048     
  16    9.703164e-05   1.337173e-03   2.934697e-02   17        17        1         0         33891     
  17    8.094440e-05   1.187801e-03   2.630688e-02   18        18        1         0         35719     
  18    6.762081e-05   1.060428e-03   2.443739e-02   19        19        1         0         37565     
  19    5.650479e-05   9.414907e-04   2.272296e-02   20        20        1         0         39420     
  20    4.717569e-05   8.393062e-04   2.135719e-02   21        21        1         0         41293     
  21    3.930988e-05   7.428681e-04   2.010912e-02   22        22        1         0         43172     
  22    3.257225e-05   6.586109e-04   1.934129e-02   23        23        1         0         45063     
  23    2.664603e-05   5.766412e-04   1.917944e-02   24        24        1         0         46963     
  24    2.171436e-05   5.009365e-04   1.788356e-02   25        25        1         0         48860     
  25    1.793642e-05   4.414320e-04   1.550515e-02   26        26        1         0         50763     
  26    1.488036e-05   3.858349e-04   1.403123e-02   27        27        1         0         52672     
  27    1.234765e-05   3.409349e-04   1.305190e-02   28        28        1         0         54590     
  28    1.021608e-05   2.958019e-04   1.232557e-02   29        29        1         0         56520     
  29    8.424857e-06   2.597212e-04   1.159145e-02   30        30        1         0         58462     
  30    6.942475e-06   2.247874e-04   1.083379e-02   31        31        1         0         60413     
  31    5.730914e-06   1.957769e-04   9.867608e-03   32        32        1         0         62370     
  32    4.751465e-06   1.709158e-04   8.991696e-03   33        33        1         0         64339     
  33    3.945453e-06   1.481260e-04   8.242902e-03   34        34        1         0         66314     
  34    3.283015e-06   1.294831e-04   7.598339e-03   35        35        1         0         68286     
  35    2.736996e-06   1.119827e-04   6.988966e-03   36        36        1         0         69599     
  36    2.286964e-06   9.781958e-05   6.441658e-03   37        37        1         0         70918     
  37    1.915222e-06   8.468891e-05   5.943803e-03   38        38        1         0         72237     
  38    1.607513e-06   7.400309e-05   5.492442e-03   39        39        1         0         73565     
  39    1.352384e-06   6.420340e-05   5.094451e-03   40        40        1         0         74893     
  40    1.139725e-06   5.611933e-05   4.742246e-03   41        41        1         0         76224     
  41    9.570741e-07   4.880067e-05   4.613709e-03   42        42        1         0         77567     
  42    7.891413e-07   4.129463e-05   4.768064e-03   43        43        1         0         78913     
  43    6.659944e-07   3.534530e-05   3.957755e-03   44        44        1         0         80259     
  44    5.745541e-07   3.083424e-05   3.333951e-03   45        45        1         0         81620     
  45    5.010919e-07   2.694366e-05   2.988302e-03   46        46        1         0         82981     
  46    4.409452e-07   2.363092e-05   2.760222e-03   47        47        1         0         84363     
  47    3.920412e-07   2.076031e-05   2.504673e-03   48        48        1         0         85724     
  48    3.526881e-07   1.817979e-05   2.271166e-03   49        49        1         0         87118     
  49    3.209592e-07   1.616869e-05   2.050411e-03   50        50        1         0         88491     
  50    2.946504e-07   1.408498e-05   1.920992e-03   51        51        1         0         89933     
  51    2.733856e-07   1.239123e-05   1.733842e-03   52        52        1         0         91315     
  52    2.567195e-07   1.102282e-05   1.549097e-03   53        53        1         0         92757     
  53    2.437255e-07   9.656540e-06   1.339913e-03   54        54        1         0         94160     
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 111.397 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 4640 design variables: 4000 simulation variables and 640 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     

Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
1                 8.06562e-06       0.00375146        0.0243463         6.87456           5.7445            2.43977           2.88232           685               1                 0                 43074             
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
2                 1.54854e-07       6.84319e-05       0.00041934        6.13339           6.12044           0.19844           0.345301          428               1                 0                 69790             
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
3                 1.64204e-10       5.48005e-06       1.53751e-05       2.97105           2.97039           0.0289217         0.0557789         688               1                 0                 112626            
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
4                 2.16935e-12       2.90716e-09       6.9677e-09        9.43212           9.43212           0.0011747         0.00152565        553               1                 0                 147092            
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
5                 2.32426e-12       6.56391e-12       1.24147e-09       10.4627           10.4627           7.96869e-05       6.79244e-06       566               1                 0                 182364            
Optimization Terminated with Status: Converged
The process took 186.744 seconds to run.
Total n_vmult for algorithm 182364
