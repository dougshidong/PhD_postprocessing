Starting optimization with 640...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   
  0     1.460201e-03   3.788353e-03   
  1     1.458766e-03   3.785737e-03   3.788353e-04   2         2         1         0         241982    
  2     1.232870e-03   3.634304e-03   6.650895e-02   3         3         1         0         244770    
  3     9.366307e-04   2.898658e-03   9.726000e-02   4         4         1         0         247459    
  4     7.791983e-04   2.556168e-03   6.012822e-02   5         5         1         0         250286    
  5     6.507774e-04   2.323354e-03   5.736360e-02   6         6         1         0         253017    
  6     5.352338e-04   2.085017e-03   5.939985e-02   7         7         1         0         255796    
  7     4.181727e-04   1.753700e-03   6.680396e-02   8         8         1         0         258653    
  8     3.396589e-04   1.559014e-03   5.220895e-02   9         9         1         0         261474    
  9     2.789616e-04   1.416803e-03   4.647676e-02   10        10        1         0         263500    
  10    2.127434e-04   1.237327e-03   5.800748e-02   11        11        1         0         265556    
  11    1.727468e-04   1.070692e-03   3.940708e-02   12        12        1         0         267594    
  12    1.428621e-04   9.797640e-04   3.404579e-02   13        13        1         0         269653    
  13    1.171389e-04   8.404076e-04   3.285747e-02   14        14        1         0         271736    
  14    9.565859e-05   7.635108e-04   3.134367e-02   15        15        1         0         273807    
  15    7.813602e-05   6.639875e-04   2.881057e-02   16        16        1         0         275899    
  16    6.342341e-05   5.984356e-04   2.743930e-02   17        17        1         0         277988    
  17    5.108737e-05   5.288785e-04   2.648811e-02   18        18        1         0         280095    
  18    4.013177e-05   4.574668e-04   2.613629e-02   19        19        1         0         282199    
  19    3.192087e-05   4.088358e-04   2.285297e-02   20        20        1         0         284309    
  20    2.540669e-05   3.556674e-04   2.033514e-02   21        21        1         0         286422    
  21    2.043765e-05   3.151778e-04   1.769476e-02   22        22        1         0         288544    
  22    1.646842e-05   2.827674e-04   1.614909e-02   23        23        1         0         290672    
  23    1.309736e-05   2.452686e-04   1.549306e-02   24        24        1         0         292815    
  24    1.052801e-05   2.204668e-04   1.334080e-02   25        25        1         0         294970    
  25    8.509897e-06   1.941479e-04   1.186305e-02   26        26        1         0         297143    
  26    6.863693e-06   1.740011e-04   1.083738e-02   27        27        1         0         299325    
  27    5.527967e-06   1.536597e-04   9.986473e-03   28        28        1         0         301519    
  28    4.431537e-06   1.365649e-04   9.186945e-03   29        29        1         0         303728    
  29    3.540025e-06   1.209927e-04   8.550662e-03   30        30        1         0         305940    
  30    2.823033e-06   1.065841e-04   7.712319e-03   31        31        1         0         308149    
  31    2.275806e-06   9.508328e-05   6.683665e-03   32        32        1         0         310328    
  32    1.845740e-06   8.459622e-05   5.913729e-03   33        33        1         0         312507    
  33    1.498245e-06   7.563047e-05   5.371856e-03   34        34        1         0         314683    
  34    1.211291e-06   6.727165e-05   5.032431e-03   35        35        1         0         316862    
  35    9.669732e-07   5.952657e-05   4.837113e-03   36        36        1         0         319053    
  36    7.718687e-07   5.237489e-05   4.378061e-03   37        37        1         0         321247    
  37    6.295821e-07   4.691573e-05   3.595476e-03   38        38        1         0         323447    
  38    5.184654e-07   4.151360e-05   3.141547e-03   39        39        1         0         325662    
  39    4.285559e-07   3.766591e-05   2.859421e-03   40        40        1         0         327874    
  40    3.555016e-07   3.306331e-05   2.585796e-03   41        41        1         0         330107    
  41    2.972149e-07   2.977271e-05   2.316561e-03   42        42        1         0         332334    
  42    2.505416e-07   2.645737e-05   2.073269e-03   43        43        1         0         334573    
  43    2.128861e-07   2.373065e-05   1.871688e-03   44        44        1         0         336815    
  44    1.827036e-07   2.120751e-05   1.677932e-03   45        45        1         0         339066    
  45    1.583363e-07   1.901461e-05   1.514627e-03   46        46        1         0         341320    
  46    1.387037e-07   1.702512e-05   1.364258e-03   47        47        1         0         343577    
  47    1.228418e-07   1.526250e-05   1.231921e-03   48        48        1         0         345837    
  48    1.100022e-07   1.367909e-05   1.115799e-03   49        49        1         0         348109    
  49    9.950758e-08   1.223153e-05   1.021059e-03   50        50        1         0         350384    
  50    9.061516e-08   1.092904e-05   9.836840e-04   51        51        1         0         352653    
  51    8.274350e-08   9.589768e-06   9.800152e-04   52        52        1         0         354940    
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 354.694 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 9640 design variables: 9000 simulation variables and 640 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     

Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
1                 6.50153e-06       0.00501167        0.0224602         5.86337           0.927063          3.51688           4.59905           765               1                 0                 48300             
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
2                 6.13649e-07       0.000219424       0.000496265       1.75403           1.607             0.281893          0.643983          516               1                 0                 80572             
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
3                 7.3844e-10        3.50355e-05       4.43176e-05       1.61777           1.60775           0.084747          0.158532          636               1                 0                 120284            
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
4                 4.56761e-12       2.04528e-07       7.38035e-08       2.75935           2.75931           0.00399894        0.015401          740               1                 0                 166444            
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult_total     
5                 2.05375e-12       1.70801e-11       4.49098e-10       2.72316           2.72316           0.000323016       4.45728e-05       778               1                 0                 214960            
Optimization Terminated with Status: Converged
The process took 532.358 seconds to run.
Total n_vmult for algorithm 214960
