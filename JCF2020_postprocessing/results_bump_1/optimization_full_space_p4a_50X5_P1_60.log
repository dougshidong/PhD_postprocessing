Starting optimization with 60...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   6.731072e-03   
  1     1.441901e-03   6.718871e-03   6.731072e-04   2         2         1         0         223168    34                207107            671               1280              
  2     1.201468e-03   6.054477e-03   3.791659e-02   3         3         1         0         224894    40                208346            672               1280              
  3     9.993861e-04   5.453000e-03   3.579424e-02   4         4         1         0         226629    46                209594            673               1280              
  4     8.281939e-04   4.908146e-03   3.434197e-02   5         5         1         0         228367    52                210845            674               1280              
  5     6.829229e-04   4.403145e-03   3.297916e-02   6         6         1         0         230126    58                212117            675               1280              
  6     5.593318e-04   3.943093e-03   3.202218e-02   7         7         1         0         231891    64                213395            676               1280              
  7     4.561892e-04   3.516279e-03   3.016065e-02   8         8         1         0         233665    70                214682            677               1280              
  8     3.731358e-04   3.145751e-03   2.753616e-02   9         9         1         0         235436    76                215966            678               1280              
  9     3.066485e-04   2.818278e-03   2.486981e-02   10        10        1         0         237222    82                217265            679               1280              
  10    2.526963e-04   2.530195e-03   2.285272e-02   11        11        1         0         239002    88                218558            680               1280              
  11    2.085747e-04   2.271534e-03   2.111422e-02   12        12        1         0         240779    94                219848            681               1280              
  12    1.723539e-04   2.040283e-03   1.961893e-02   13        13        1         0         242559    100               221141            682               1280              
  13    1.425788e-04   1.831848e-03   1.824276e-02   14        14        1         0         244345    106               222440            683               1280              
  14    1.180920e-04   1.644617e-03   1.699174e-02   15        15        1         0         246140    112               223748            684               1280              
  15    9.795398e-05   1.475810e-03   1.583013e-02   16        16        1         0         247941    118               225062            685               1280              
  16    8.139321e-05   1.323950e-03   1.476427e-02   17        17        1         0         249739    124               226373            686               1280              
  17    6.777331e-05   1.187021e-03   1.378013e-02   18        18        1         0         251552    130               227699            687               1280              
  18    5.656606e-05   1.063728e-03   1.288583e-02   19        19        1         0         253374    136               229034            688               1280              
  19    4.732419e-05   9.522204e-04   1.209089e-02   20        20        1         0         255199    142               230372            689               1280              
  20    3.964162e-05   8.509114e-04   1.147515e-02   21        21        1         0         257021    148               231707            690               1280              
  21    3.311968e-05   7.561353e-04   1.116093e-02   22        22        1         0         258861    154               233060            691               1280              
  22    2.760376e-05   6.675779e-04   1.078512e-02   23        23        1         0         260713    160               234425            692               1280              
  23    2.326064e-05   5.902409e-04   9.701809e-03   24        24        1         0         262571    166               235796            693               1280              
  24    1.986331e-05   5.240192e-04   8.692953e-03   25        25        1         0         264459    172               237197            694               1280              
  25    1.712396e-05   4.656170e-04   8.030897e-03   26        26        1         0         266353    178               238604            695               1280              
  26    1.487611e-05   4.135383e-04   7.556663e-03   27        27        1         0         268259    184               240023            696               1280              
  27    1.301512e-05   3.667361e-04   7.177709e-03   28        28        1         0         270174    190               241451            697               1280              
  28    1.146587e-05   3.246192e-04   6.858767e-03   29        29        1         0         272101    196               242891            698               1280              
  29    1.017056e-05   2.866405e-04   6.583434e-03   30        30        1         0         274037    202               244340            699               1280              
  30    9.083118e-06   2.523963e-04   6.344477e-03   31        31        1         0         275353    207               245249            700               1280              
  31    8.166319e-06   2.215006e-04   6.137642e-03   32        32        1         0         276675    212               246164            701               1280              
  32    7.389822e-06   1.936390e-04   5.960565e-03   33        33        1         0         278012    217               247094            702               1280              
  33    6.728818e-06   1.685199e-04   5.811603e-03   34        34        1         0         279352    222               248027            703               1280              
  34    6.162977e-06   1.458995e-04   5.689749e-03   35        35        1         0         280695    227               248963            704               1280              
  35    5.675611e-06   1.255613e-04   5.594345e-03   36        36        1         0         282038    232               249899            705               1280              
  36    5.253002e-06   1.073284e-04   5.525108e-03   37        37        1         0         283384    237               250838            706               1280              
  37    4.883856e-06   9.105768e-05   5.482021e-03   38        38        1         0         284721    242               251768            707               1280              
  38    4.558856e-06   7.664576e-05   5.465418e-03   39        39        1         0         286073    247               252713            708               1280              
  39    4.270302e-06   6.403795e-05   5.475882e-03   40        40        1         0         287434    252               253667            709               1280              
  40    4.011797e-06   5.322713e-05   5.514630e-03   41        41        1         0         288804    257               254630            710               1280              
  41    3.777994e-06   4.428045e-05   5.583707e-03   42        42        1         0         290174    262               255593            711               1280              
  42    3.564282e-06   3.730194e-05   5.689716e-03   43        43        1         0         291547    267               256559            712               1280              
  43    3.366248e-06   3.247667e-05   5.855710e-03   44        44        1         0         292938    272               257543            713               1280              
  44    3.178498e-06   2.994194e-05   6.158112e-03   45        45        1         0         294335    277               258533            714               1280              
  45    3.002617e-06   2.881731e-05   6.383757e-03   46        46        1         0         295732    282               259523            715               1280              
  46    2.849717e-06   2.962757e-05   6.147101e-03   47        47        1         0         297147    287               260531            716               1280              
  47    2.713566e-06   3.112041e-05   6.008712e-03   48        48        1         0         298553    292               261530            717               1280              
  48    2.585487e-06   3.325900e-05   6.189014e-03   49        49        1         0         299977    297               262547            718               1280              
  49    2.467376e-06   3.470164e-05   6.236549e-03   50        50        1         0         301392    302               263555            719               1280              
  50    2.363629e-06   3.635382e-05   5.978155e-03   51        51        1         0         302792    307               264548            720               1280              
  51    2.269016e-06   3.723471e-05   5.863298e-03   52        52        1         0         304186    312               265535            721               1280              
  52    2.180600e-06   3.784287e-05   5.864589e-03   53        53        1         0         305583    317               266525            722               1280              
  53    2.095861e-06   3.780607e-05   5.964006e-03   54        54        1         0         306986    322               267521            723               1280              
  54    2.014543e-06   3.729860e-05   6.081218e-03   55        55        1         0         308389    327               268517            724               1280              
  55    1.936535e-06   3.641096e-05   6.198564e-03   56        56        1         0         309771    332               269492            725               1280              
  56    1.859739e-06   3.496709e-05   6.592078e-03   57        57        1         0         311126    337               270440            726               1280              
  57    1.779091e-06   3.313747e-05   7.543768e-03   58        58        1         0         312502    342               271409            727               1280              
  58    1.717351e-06   3.109001e-05   6.320240e-03   59        59        1         0         313914    347               272414            728               1280              
  59    1.666660e-06   2.933351e-05   5.633000e-03   60        60        1         0         315278    352               273371            729               1280              
  60    1.614242e-06   2.704384e-05   6.401177e-03   61        61        1         0         316702    357               274388            730               1280              
  61    1.573229e-06   2.472813e-05   5.372205e-03   62        62        1         0         318087    362               275366            731               1280              
  62    1.541106e-06   2.288746e-05   4.560155e-03   63        63        1         0         319493    367               276365            732               1280              
  63    1.511616e-06   2.089974e-05   4.393334e-03   64        64        1         0         320935    372               277400            733               1280              
  64    1.484724e-06   1.899157e-05   4.287592e-03   65        65        1         0         322326    377               278384            734               1280              
  65    1.460122e-06   1.708313e-05   4.173905e-03   66        66        1         0         323768    382               279419            735               1280              
  66    1.437006e-06   1.519344e-05   4.213199e-03   67        67        1         0         325186    387               280430            736               1280              
  67    1.414860e-06   1.329918e-05   4.367091e-03   68        68        1         0         326625    392               281462            737               1280              
  68    1.395594e-06   1.145463e-05   4.104515e-03   69        69        1         0         328085    397               282515            738               1280              
  69    1.379413e-06   9.970477e-06   3.725010e-03   70        70        1         0         329524    402               283547            739               1280              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 57.0655 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 4060 design variables: 4000 simulation variables and 60 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.02187e-06       0.00334423        0.0241429         16.2811           15.8347           2.44181           2.89419           388               1                 0                 36300             2                 4226              1562              3108              
2                 6.69964e-08       6.58492e-05       0.00036415        15.3875           15.3825           0.194606          0.338329          256               1                 0                 60032             3                 6795              2595              5160              
3                 2.24106e-11       1.31906e-06       4.39412e-06       0.534893          0.533244          0.0202882         0.0367392         336               1                 0                 91124             4                 10164             3948              7852              
4                 2.2831e-13        3.12563e-10       7.73006e-10       0.13281           0.132806          0.000373225       0.000924517       328               1                 0                 121480            5                 13453             5269              10480             
Optimization Terminated with Status: Converged
The process took 30.6542 seconds to run.
Total n_vmult for algorithm 121480
