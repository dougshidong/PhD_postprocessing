Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   8.617416e-03   
  1     1.439015e-03   8.585692e-03   8.617416e-04   2         2         1         0         96711     36                86131             564               536               
  2     1.243746e-03   7.736076e-03   2.418500e-02   3         3         1         0         98434     42                87367             565               536               
  3     1.076880e-03   6.965577e-03   2.345293e-02   4         4         1         0         100160    48                88606             566               536               
  4     9.338980e-04   6.263551e-03   2.296077e-02   5         5         1         0         101892    54                89851             567               536               
  5     8.120047e-04   5.625984e-03   2.245672e-02   6         6         1         0         103630    60                91102             568               536               
  6     7.084560e-04   5.048133e-03   2.193658e-02   7         7         1         0         105374    66                92359             569               536               
  7     6.207142e-04   4.525112e-03   2.140126e-02   8         8         1         0         107124    72                93622             570               536               
  8     5.464983e-04   4.052133e-03   2.085670e-02   9         9         1         0         108886    78                94897             571               536               
  9     4.837952e-04   3.624648e-03   2.031090e-02   10        10        1         0         110657    84                96181             572               536               
  10    4.308515e-04   3.238415e-03   1.977210e-02   11        11        1         0         112431    90                97468             573               536               
  11    3.861533e-04   2.889524e-03   1.924801e-02   12        12        1         0         114217    96                98767             574               536               
  12    3.484030e-04   2.574397e-03   1.874545e-02   13        13        1         0         116006    102               100069            575               536               
  13    3.164935e-04   2.289775e-03   1.827069e-02   14        14        1         0         117798    108               101374            576               536               
  14    2.894839e-04   2.032691e-03   1.782952e-02   15        15        1         0         119590    114               102679            577               536               
  15    2.665774e-04   1.800454e-03   1.742751e-02   16        16        1         0         121403    120               104005            578               536               
  16    2.471008e-04   1.590627e-03   1.707017e-02   17        17        1         0         123213    126               105328            579               536               
  17    2.304868e-04   1.401006e-03   1.676286e-02   18        18        1         0         125008    132               106636            580               536               
  18    2.162583e-04   1.229614e-03   1.651090e-02   19        19        1         0         126809    138               107950            581               536               
  19    2.040150e-04   1.074684e-03   1.631944e-02   20        20        1         0         128610    144               109264            582               536               
  20    1.934219e-04   9.346607e-04   1.619346e-02   21        21        1         0         130417    150               110584            583               536               
  21    1.841986e-04   8.081979e-04   1.613774e-02   22        22        1         0         132224    156               111904            584               536               
  22    1.761112e-04   6.941654e-04   1.615682e-02   23        23        1         0         134037    162               113230            585               536               
  23    1.689648e-04   5.916673e-04   1.625508e-02   24        24        1         0         135853    168               114559            586               536               
  24    1.625966e-04   5.000739e-04   1.643667e-02   25        25        1         0         137669    174               115888            587               536               
  25    1.568712e-04   4.190747e-04   1.670562e-02   26        26        1         0         139479    180               117211            588               536               
  26    1.516756e-04   3.487606e-04   1.706592e-02   27        27        1         0         141292    186               118537            589               536               
  27    1.469151e-04   2.897217e-04   1.752178e-02   28        28        1         0         143111    192               119869            590               536               
  28    1.425105e-04   2.430822e-04   1.807824e-02   29        29        1         0         144933    198               121204            591               536               
  29    1.383944e-04   2.102194e-04   1.874227e-02   30        30        1         0         146767    204               122551            592               536               
  30    1.345085e-04   1.917931e-04   1.952566e-02   31        31        1         0         148634    210               123931            593               536               
  31    1.308004e-04   1.863790e-04   2.045044e-02   32        32        1         0         150546    216               125356            594               536               
  32    1.272192e-04   1.902421e-04   2.156082e-02   33        33        1         0         152458    222               126781            595               536               
  33    1.237095e-04   1.988264e-04   2.294586e-02   34        34        1         0         154301    228               128137            596               536               
  34    1.202013e-04   2.082831e-04   2.478943e-02   35        35        1         0         156180    234               129529            597               536               
  35    1.165925e-04   2.160961e-04   2.747236e-02   36        36        1         0         158092    240               130954            598               536               
  36    1.127239e-04   2.205108e-04   3.176476e-02   37        37        1         0         160004    246               132379            599               536               
  37    1.082597e-04   2.879775e-04   4.623593e-02   38        38        1         0         161883    252               133771            600               536               
  38    1.046738e-04   2.811684e-04   3.502263e-02   39        39        1         0         163792    258               135193            601               536               
  39    1.011580e-04   2.754696e-04   3.678744e-02   40        40        1         0         165737    264               136651            602               536               
  40    9.649794e-05   2.654731e-04   5.689023e-02   41        41        1         0         167583    270               138010            603               536               
  41    9.298658e-05   2.548274e-04   4.425464e-02   42        42        1         0         169522    276               139462            604               536               
  42    8.973749e-05   2.455336e-04   4.383392e-02   43        43        1         0         171467    282               140920            605               536               
  43    8.625020e-05   2.269115e-04   4.987952e-02   44        44        1         0         173382    288               142348            606               536               
  44    8.220995e-05   2.314764e-04   6.385745e-02   45        45        1         0         175318    294               143797            607               536               
  45    7.885986e-05   2.088817e-04   5.716775e-02   46        46        1         0         177236    300               145228            608               536               
  46    7.622410e-05   1.977449e-04   4.914017e-02   47        47        1         0         179217    306               146722            609               536               
  47    7.335110e-05   1.910631e-04   6.127677e-02   48        48        1         0         181108    312               148126            610               536               
  48    7.126322e-05   1.742410e-04   4.598905e-02   49        49        1         0         183092    318               149623            611               536               
  49    6.959230e-05   1.621493e-04   3.962439e-02   50        50        1         0         185067    324               151111            612               536               
  50    6.804104e-05   1.482275e-04   3.846137e-02   51        51        1         0         187054    330               152611            613               536               
  51    6.661059e-05   1.362466e-04   3.802857e-02   52        52        1         0         189038    336               154108            614               536               
  52    6.524033e-05   1.217877e-04   3.921780e-02   53        53        1         0         190998    342               155581            615               536               
  53    6.396968e-05   1.079379e-04   3.920921e-02   54        54        1         0         192985    348               157081            616               536               
  54    6.297850e-05   9.629453e-05   3.343216e-02   55        55        1         0         194304    353               157993            617               536               
  55    6.211908e-05   8.527619e-05   3.088185e-02   56        56        1         0         195650    358               158932            618               536               
  56    6.134513e-05   7.527644e-05   2.991894e-02   57        57        1         0         196984    363               159859            619               536               
  57    6.063021e-05   6.552960e-05   2.943302e-02   58        58        1         0         198336    368               160804            620               536               
  58    5.995859e-05   5.653006e-05   2.961042e-02   59        59        1         0         199685    373               161746            621               536               
  59    5.931916e-05   4.805914e-05   3.002613e-02   60        60        1         0         201034    378               162688            622               536               
  60    5.870093e-05   4.044832e-05   3.094336e-02   61        61        1         0         202377    383               163624            623               536               
  61    5.809503e-05   3.407498e-05   3.218767e-02   62        62        1         0         203720    388               164560            624               536               
  62    5.749164e-05   2.948824e-05   3.393767e-02   63        63        1         0         205063    393               165496            625               536               
  63    5.688240e-05   2.762467e-05   3.614197e-02   64        64        1         0         206400    398               166426            626               536               
  64    5.625777e-05   2.898479e-05   3.890973e-02   65        65        1         0         207737    403               167356            627               536               
  65    5.560944e-05   3.291250e-05   4.227425e-02   66        66        1         0         209080    408               168292            628               536               
  66    5.492736e-05   3.937291e-05   4.628566e-02   67        67        1         0         210414    413               169219            629               536               
  67    5.420352e-05   4.605690e-05   5.104688e-02   68        68        1         0         211760    418               170158            630               536               
  68    5.342563e-05   5.552507e-05   5.659097e-02   69        69        1         0         213097    423               171088            631               536               
  69    5.258827e-05   6.250930e-05   6.302336e-02   70        70        1         0         214389    428               171973            632               536               
  70    5.166981e-05   7.641451e-05   7.091432e-02   71        71        1         0         215741    433               172918            633               536               
  71    5.070583e-05   8.410209e-05   7.692776e-02   72        72        1         0         217060    438               173830            634               536               
  72    4.967807e-05   9.562107e-05   8.347197e-02   73        73        1         0         218394    443               174757            635               536               
  73    4.855806e-05   1.010112e-04   9.297200e-02   74        74        1         0         220396    449               176272            636               536               
  74    4.729616e-05   1.232483e-04   1.078920e-01   75        75        1         0         222383    455               177772            637               536               
  75    4.614740e-05   1.304294e-04   1.009371e-01   76        76        1         0         223708    460               178690            638               536               
  76    4.489478e-05   1.330752e-04   1.095568e-01   77        77        1         0         225054    465               179629            639               536               
  77    4.346817e-05   1.485244e-04   1.270885e-01   78        78        1         0         226394    470               180562            640               536               
  78    4.208529e-05   1.493609e-04   1.246559e-01   79        79        1         0         227758    475               181519            641               536               
  79    4.060190e-05   1.534675e-04   1.279141e-01   80        80        1         0         229086    480               182440            642               536               
  80    3.905010e-05   1.536533e-04   1.368590e-01   81        81        1         0         230474    485               183421            643               536               
  81    3.759819e-05   1.410624e-04   1.310272e-01   82        82        1         0         231802    490               184342            644               536               
  82    3.631701e-05   1.351226e-04   1.191974e-01   83        83        1         0         233193    495               185326            645               536               
  83    3.516162e-05   1.277550e-04   1.089995e-01   84        84        1         0         234605    500               186331            646               536               
  84    3.410963e-05   1.242829e-04   1.021152e-01   85        85        1         0         236026    505               187345            647               536               
  85    3.314957e-05   1.092999e-04   9.670605e-02   86        86        1         0         237405    510               188317            648               536               
  86    3.237407e-05   1.026901e-04   8.111554e-02   87        87        1         0         238790    515               189295            649               536               
  87    3.172289e-05   9.435812e-05   7.025440e-02   88        88        1         0         240214    520               190312            650               536               
  88    3.116824e-05   8.741381e-05   6.171083e-02   89        89        1         0         241611    525               191302            651               536               
  89    3.070081e-05   8.001505e-05   5.400315e-02   90        90        1         0         243044    530               192328            652               536               
  90    3.030897e-05   7.331098e-05   4.698285e-02   91        91        1         0         244471    535               193348            653               536               
  91    2.998216e-05   6.675336e-05   4.091700e-02   92        92        1         0         245901    540               194371            654               536               
  92    2.971050e-05   6.067733e-05   3.554631e-02   93        93        1         0         247331    545               195394            655               536               
  93    2.948526e-05   5.494547e-05   3.094132e-02   94        94        1         0         248758    550               196414            656               536               
  94    2.929880e-05   4.963168e-05   2.694568e-02   95        95        1         0         250188    555               197437            657               536               
  95    2.914455e-05   4.469500e-05   2.353091e-02   96        96        1         0         251618    560               198460            658               536               
  96    2.901694e-05   4.013658e-05   2.060133e-02   97        97        1         0         253057    565               199492            659               536               
  97    2.891128e-05   3.593102e-05   1.810353e-02   98        98        1         0         254496    570               200524            660               536               
  98    2.882366e-05   3.206039e-05   1.597143e-02   99        99        1         0         255938    575               201559            661               536               
  99    2.875082e-05   2.850013e-05   1.415795e-02   100       100       1         0         257383    580               202597            662               536               
  100   2.869006e-05   2.522742e-05   1.261707e-02   101       101       1         0         258831    585               203638            663               536               
  101   2.863916e-05   2.221852e-05   1.131151e-02   102       102       1         0         260282    590               204682            664               536               
  102   2.859628e-05   1.945104e-05   1.020846e-02   103       103       1         0         261733    595               205726            665               536               
  103   2.855992e-05   1.690355e-05   9.281224e-03   104       104       1         0         263187    600               206773            666               536               
  104   2.852884e-05   1.455669e-05   8.507243e-03   105       105       1         0         264644    605               207823            667               536               
  105   2.850203e-05   1.239369e-05   7.868290e-03   106       106       1         0         266101    610               208873            668               536               
  106   2.847865e-05   1.040199e-05   7.349621e-03   107       107       1         0         267564    615               209929            669               536               
  107   2.845800e-05   8.575899e-06   6.939751e-03   108       108       1         0         269027    620               210985            670               536               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 79.7292 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 4020 design variables: 4000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.05862e-06       0.00323631        0.0205456         8.09215           7.16787           2.37485           2.90941           267               1                 0                 17158             2                 1948              1078              1072              
2                 8.72566e-08       8.18037e-05       0.000354104       3.30519           3.28421           0.196835          0.315442          211               1                 0                 30420             3                 3223              1931              1920              
3                 5.97968e-11       1.95292e-06       2.62171e-06       3.18815           3.18756           0.0243513         0.0563858         232               1                 0                 44984             4                 4624              2868              2852              
4                 4.59585e-15       1.46536e-09       1.51452e-09       0.410754          0.410751          0.000610595       0.00151118        254               1                 0                 60912             5                 6157              3893              3872              
5                 9.19991e-15       5.51615e-12       3.303e-12         0.00432013        0.00432013        4.91992e-06       2.60585e-06       235               1                 0                 75662             6                 7576              4842              4816              
Optimization Terminated with Status: Converged
The process took 21.5236 seconds to run.
Total n_vmult for algorithm 75662
