Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460802e-03   7.440529e-03   
  1     1.455273e-03   7.422925e-03   7.440529e-04   2         2         1         0         329027    58                296953            684               1292              
  2     1.229715e-03   6.689361e-03   3.222584e-02   3         3         1         0         332832    64                298831            685               1292              
  3     1.038612e-03   6.027382e-03   3.081839e-02   4         4         1         0         336640    70                300712            686               1292              
  4     8.757571e-04   5.425209e-03   2.981081e-02   5         5         1         0         340418    76                302563            687               1292              
  5     7.377585e-04   4.879172e-03   2.877196e-02   6         6         1         0         344226    82                304444            688               1292              
  6     6.213326e-04   4.385065e-03   2.769636e-02   7         7         1         0         348046    88                306337            689               1292              
  7     5.234494e-04   3.938574e-03   2.659043e-02   8         8         1         0         351875    94                308239            690               1292              
  8     4.413827e-04   3.535484e-03   2.546862e-02   9         9         1         0         355686    100               310123            691               1292              
  9     3.727257e-04   3.171788e-03   2.434773e-02   10        10        1         0         358586    105               311416            692               1292              
  10    3.153820e-04   2.843756e-03   2.324366e-02   11        11        1         0         361483    110               312706            693               1292              
  11    2.675454e-04   2.547952e-03   2.216991e-02   12        12        1         0         364380    115               313996            694               1292              
  12    2.276723e-04   2.281237e-03   2.113715e-02   13        13        1         0         367283    120               315292            695               1292              
  13    1.944518e-04   2.040761e-03   2.015328e-02   14        14        1         0         370201    125               316603            696               1292              
  14    1.667766e-04   1.823937e-03   1.922382e-02   15        15        1         0         373125    130               317920            697               1292              
  15    1.437153e-04   1.628429e-03   1.835239e-02   16        16        1         0         376052    135               319240            698               1292              
  16    1.244870e-04   1.452124e-03   1.754110e-02   17        17        1         0         378988    140               320569            699               1292              
  17    1.084390e-04   1.293118e-03   1.679099e-02   18        18        1         0         381933    145               321907            700               1292              
  18    9.502688e-05   1.149691e-03   1.610229e-02   19        19        1         0         384884    150               323251            701               1292              
  19    8.379784e-05   1.020294e-03   1.547475e-02   20        20        1         0         387844    155               324604            702               1292              
  20    7.437558e-05   9.035343e-04   1.490775e-02   21        21        1         0         390810    160               325963            703               1292              
  21    6.644802e-05   7.981583e-04   1.440054e-02   22        22        1         0         393779    165               327325            704               1292              
  22    5.975659e-05   7.030435e-04   1.395234e-02   23        23        1         0         396751    170               328690            705               1292              
  23    5.408731e-05   6.171863e-04   1.356244e-02   24        24        1         0         399729    175               330061            706               1292              
  24    4.926315e-05   5.396940e-04   1.323033e-02   25        25        1         0         402707    180               331432            707               1292              
  25    4.513777e-05   4.697783e-04   1.295576e-02   26        26        1         0         405667    185               332785            708               1292              
  26    4.159018e-05   4.067504e-04   1.273885e-02   27        27        1         0         408651    190               334162            709               1292              
  27    3.852031e-05   3.500193e-04   1.258014e-02   28        28        1         0         411617    195               335521            710               1292              
  28    3.584536e-05   2.990935e-04   1.248074e-02   29        29        1         0         414604    200               336901            711               1292              
  29    3.349670e-05   2.535877e-04   1.244238e-02   30        30        1         0         417594    205               338284            712               1292              
  30    3.141733e-05   2.132369e-04   1.246760e-02   31        31        1         0         420617    210               339700            713               1292              
  31    2.955977e-05   1.779212e-04   1.255988e-02   32        32        1         0         423619    215               341095            714               1292              
  32    2.788428e-05   1.477009e-04   1.272395e-02   33        33        1         0         426621    220               342490            715               1292              
  33    2.635738e-05   1.228509e-04   1.296622e-02   34        34        1         0         429614    225               343876            716               1292              
  34    2.495057e-05   1.038412e-04   1.329547e-02   35        35        1         0         432607    230               345262            717               1292              
  35    2.363921e-05   9.113370e-05   1.372405e-02   36        36        1         0         435627    235               346675            718               1292              
  36    2.240151e-05   8.469452e-05   1.426986e-02   37        37        1         0         438626    240               348067            719               1292              
  37    2.121747e-05   8.352516e-05   1.495962e-02   38        38        1         0         441640    245               349474            720               1292              
  38    2.006785e-05   8.582953e-05   1.583442e-02   39        39        1         0         444681    250               350908            721               1292              
  39    1.893294e-05   8.970148e-05   1.695835e-02   40        40        1         0         447686    255               352306            722               1292              
  40    1.779128e-05   9.360439e-05   1.843120e-02   41        41        1         0         450724    260               353737            723               1292              
  41    1.661865e-05   9.642767e-05   2.040133e-02   42        42        1         0         453735    265               355141            724               1292              
  42    1.538912e-05   9.735580e-05   2.306082e-02   43        43        1         0         456770    270               356569            725               1292              
  43    1.409643e-05   9.944809e-05   2.681453e-02   44        44        1         0         459823    275               358015            726               1292              
  44    1.233650e-05   9.393030e-05   4.017851e-02   45        45        1         0         462831    280               359416            727               1292              
  45    1.131899e-05   8.939262e-05   2.650138e-02   46        46        1         0         465893    285               360871            728               1292              
  46    1.047584e-05   8.661843e-05   2.436903e-02   47        47        1         0         468916    290               362287            729               1292              
  47    9.716955e-06   8.052121e-05   2.384811e-02   48        48        1         0         471981    295               363745            730               1292              
  48    9.017480e-06   8.248889e-05   2.581259e-02   49        49        1         0         475022    300               365179            731               1292              
  49    8.406965e-06   7.399020e-05   2.334762e-02   50        50        1         0         478099    305               366649            732               1292              
  50    7.957461e-06   6.927431e-05   1.939725e-02   51        51        1         0         481182    310               368125            733               1292              
  51    7.493741e-06   6.634174e-05   2.228345e-02   52        52        1         0         484235    315               369571            734               1292              
  52    7.102821e-06   5.873160e-05   1.988115e-02   53        53        1         0         487315    320               371044            735               1292              
  53    6.795643e-06   5.371558e-05   1.741235e-02   54        54        1         0         490443    325               372565            736               1292              
  54    6.473957e-06   4.917686e-05   1.952578e-02   55        55        1         0         493469    330               373984            737               1292              
  55    6.167912e-06   4.156803e-05   2.014469e-02   56        56        1         0         496585    335               375493            738               1292              
  56    5.928688e-06   3.709471e-05   1.749750e-02   57        57        1         0         499662    340               376963            739               1292              
  57    5.680722e-06   3.229750e-05   1.931865e-02   58        58        1         0         502754    345               378448            740               1292              
  58    5.456605e-06   2.650020e-05   1.880002e-02   59        59        1         0         505855    350               379942            741               1292              
  59    5.270522e-06   2.351514e-05   1.688875e-02   60        60        1         0         508974    355               381454            742               1292              
  60    5.080886e-06   1.946450e-05   1.746781e-02   61        61        1         0         512069    360               382942            743               1292              
  61    4.891960e-06   1.761362e-05   1.881282e-02   62        62        1         0         515179    365               384445            744               1292              
  62    4.702150e-06   1.677085e-05   1.926557e-02   63        63        1         0         518292    370               385951            745               1292              
  63    4.505553e-06   1.652431e-05   2.138736e-02   64        64        1         0         521426    375               387478            746               1292              
  64    4.301626e-06   1.828161e-05   2.398756e-02   65        65        1         0         524518    380               388963            747               1292              
  65    4.125640e-06   1.939307e-05   2.150660e-02   66        66        1         0         527649    385               390487            748               1292              
  66    3.978366e-06   2.054388e-05   1.906345e-02   67        67        1         0         530750    390               391981            749               1292              
  67    3.824002e-06   2.288313e-05   2.006580e-02   68        68        1         0         533899    395               393523            750               1292              
  68    3.657887e-06   2.352676e-05   2.287297e-02   69        69        1         0         536973    400               394990            751               1292              
  69    3.510158e-06   2.397711e-05   2.202223e-02   70        70        1         0         540077    405               396487            752               1292              
  70    3.385334e-06   2.449901e-05   1.891066e-02   71        71        1         0         543172    410               397975            753               1292              
  71    3.278194e-06   2.371078e-05   1.695708e-02   72        72        1         0         546291    415               399487            754               1292              
  72    3.174101e-06   2.401003e-05   1.639972e-02   73        73        1         0         549401    420               400990            755               1292              
  73    3.077892e-06   2.224876e-05   1.589214e-02   74        74        1         0         552520    425               402502            756               1292              
  74    2.990536e-06   2.211956e-05   1.494658e-02   75        75        1         0         555621    430               403996            757               1292              
  75    2.890314e-06   1.916255e-05   1.958002e-02   76        76        1         0         558734    435               405502            758               1292              
  76    2.826628e-06   1.784438e-05   1.251589e-02   77        77        1         0         561871    440               407032            759               1292              
  77    2.768152e-06   1.659899e-05   1.189841e-02   78        78        1         0         564999    445               408553            760               1292              
  78    2.693913e-06   1.537905e-05   1.631475e-02   79        79        1         0         568079    450               410026            761               1292              
  79    2.640258e-06   1.369153e-05   1.240757e-02   80        80        1         0         571243    455               411583            762               1292              
  80    2.594947e-06   1.240691e-05   1.106516e-02   81        81        1         0         574425    460               413158            763               1292              
  81    2.548366e-06   1.110543e-05   1.171467e-02   82        82        1         0         577505    465               414631            764               1292              
  82    2.499916e-06   9.521038e-06   1.294484e-02   83        83        1         0         580696    470               416215            765               1292              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 1014.94 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 16040 design variables: 16000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.30514e-06       0.00471157        0.0181422         28.4123           27.361            4.66664           6.07093           403               1                 0                 38298             2                 4514              1622              3228              
2                 4.61818e-07       0.000191769       0.000463545       13.3684           13.3337           0.394328          0.878637          278               1                 0                 64294             3                 7303              2743              5456              
3                 4.3162e-10        2.89154e-05       3.60067e-05       13.975            13.9726           0.118195          0.228771          316               1                 0                 93786             4                 10472             4016              7988              
4                 8.81259e-13       2.83389e-08       1.4665e-08        0.0780491         0.0767571         0.00338842        0.0137305         350               1                 0                 126406            5                 13981             5425              10792             
5                 2.16984e-15       1.31777e-11       3.14346e-11       0.0489896         0.0489894         0.000136524       8.45265e-05       368               1                 0                 160682            6                 17670             6906              13740             
Optimization Terminated with Status: Converged
The process took 819.961 seconds to run.
Total n_vmult for algorithm 160682
