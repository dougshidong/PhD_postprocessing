Starting optimization with 320...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   4.638756e-03   
  1     1.444277e-03   4.634548e-03   4.638756e-04   2         2         1         0         142836    52                130353            401               788               
  2     1.178076e-03   7.110187e-03   7.600766e-02   3         3         1         0         144613    58                131643            402               788               
  3     9.582052e-04   5.809907e-03   5.432420e-02   4         4         1         0         146375    64                132918            403               788               
  4     8.057194e-04   5.485588e-03   4.474649e-02   5         5         1         0         148101    70                134157            404               788               
  5     6.716623e-04   4.726116e-03   4.263081e-02   6         6         1         0         149878    76                135447            405               788               
  6     5.576947e-04   4.326303e-03   4.164923e-02   7         7         1         0         151628    82                136710            406               788               
  7     4.620337e-04   3.850308e-03   3.906465e-02   8         8         1         0         153402    88                137997            407               788               
  8     3.812743e-04   3.475085e-03   3.719267e-02   9         9         1         0         155188    94                139296            408               788               
  9     3.117084e-04   3.098184e-03   3.635515e-02   10        10        1         0         156950    100               140571            409               788               
  10    2.495599e-04   2.747086e-03   3.636460e-02   11        11        1         0         158751    106               141885            410               788               
  11    2.017260e-04   2.439169e-03   3.179109e-02   12        12        1         0         160543    112               143190            411               788               
  12    1.650468e-04   2.190767e-03   2.735657e-02   13        13        1         0         162347    118               144507            412               788               
  13    1.355105e-04   1.967245e-03   2.475892e-02   14        14        1         0         164139    124               145812            413               788               
  14    1.113091e-04   1.770847e-03   2.269589e-02   15        15        1         0         165982    130               147168            414               788               
  15    9.128139e-05   1.593436e-03   2.107508e-02   16        16        1         0         167843    136               148542            415               788               
  16    7.333997e-05   1.426939e-03   2.157416e-02   17        17        1         0         169767    142               149979            416               788               
  17    5.727777e-05   1.246500e-03   2.128942e-02   18        18        1         0         171652    148               151377            417               788               
  18    4.642397e-05   1.118118e-03   1.649409e-02   19        19        1         0         173522    154               152760            418               788               
  19    3.791908e-05   1.003329e-03   1.439669e-02   20        20        1         0         175398    160               154149            419               788               
  20    3.103240e-05   9.032604e-04   1.309776e-02   21        21        1         0         177292    166               155556            420               788               
  21    2.541452e-05   8.120577e-04   1.190585e-02   22        22        1         0         179195    172               156972            421               788               
  22    2.080272e-05   7.309503e-04   1.095651e-02   23        23        1         0         181101    178               158391            422               788               
  23    1.697424e-05   6.561594e-04   1.017642e-02   24        24        1         0         183016    184               159819            423               788               
  24    1.370571e-05   5.863443e-04   9.786584e-03   25        25        1         0         184934    190               161250            424               788               
  25    1.097560e-05   5.209838e-04   9.180768e-03   26        26        1         0         186855    196               162684            425               788               
  26    8.877486e-06   4.651337e-04   7.932933e-03   27        27        1         0         188788    202               164130            426               788               
  27    7.246775e-06   4.171643e-04   6.922838e-03   28        28        1         0         190730    208               165585            427               788               
  28    5.940177e-06   3.744796e-04   6.203373e-03   29        29        1         0         192681    214               167049            428               788               
  29    4.880244e-06   3.364523e-04   5.633607e-03   30        30        1         0         194644    220               168525            429               788               
  30    4.016380e-06   3.020929e-04   5.130006e-03   31        31        1         0         195948    225               169422            430               788               
  31    3.311179e-06   2.713383e-04   4.686735e-03   32        32        1         0         197258    230               170325            431               788               
  32    2.735303e-06   2.435033e-04   4.276365e-03   33        33        1         0         198574    235               171234            432               788               
  33    2.265092e-06   2.185937e-04   3.907918e-03   34        34        1         0         199899    240               172152            433               788               
  34    1.881288e-06   1.960532e-04   3.564558e-03   35        35        1         0         201230    245               173076            434               788               
  35    1.568132e-06   1.759035e-04   3.255384e-03   36        36        1         0         202564    250               174003            435               788               
  36    1.312725e-06   1.576753e-04   2.967201e-03   37        37        1         0         203901    255               174933            436               788               
  37    1.104495e-06   1.414037e-04   2.707934e-03   38        38        1         0         205244    260               175869            437               788               
  38    9.347928e-07   1.266833e-04   2.466313e-03   39        39        1         0         206596    265               176814            438               788               
  39    7.965365e-07   1.135654e-04   2.249376e-03   40        40        1         0         207954    270               177765            439               788               
  40    6.839362e-07   1.016927e-04   2.047127e-03   41        41        1         0         209321    275               178725            440               788               
  41    5.922577e-07   9.113384e-05   1.866054e-03   42        42        1         0         210694    280               179691            441               788               
  42    5.176348e-07   8.156801e-05   1.697046e-03   43        43        1         0         212079    285               180669            442               788               
  43    4.569100e-07   7.308036e-05   1.546245e-03   44        44        1         0         213470    290               181653            443               788               
  44    4.075075e-07   6.537962e-05   1.405222e-03   45        45        1         0         214870    295               182646            444               788               
  45    3.673260e-07   5.856446e-05   1.279849e-03   46        46        1         0         216276    300               183645            445               788               
  46    3.346528e-07   5.236991e-05   1.162312e-03   47        47        1         0         217691    305               184653            446               788               
  47    3.080920e-07   4.690224e-05   1.058152e-03   48        48        1         0         219109    310               185664            447               788               
  48    2.865069e-07   4.192423e-05   9.602587e-04   49        49        1         0         220533    315               186681            448               788               
  49    2.689710e-07   3.754080e-05   8.736889e-04   50        50        1         0         221960    320               187701            449               788               
  50    2.547298e-07   3.354641e-05   7.922382e-04   51        51        1         0         223390    325               188724            450               788               
  51    2.431680e-07   3.003473e-05   7.202808e-04   52        52        1         0         224826    330               189753            451               788               
  52    2.337842e-07   2.683533e-05   6.527039e-04   53        53        1         0         226262    335               190782            452               788               
  53    2.261694e-07   2.402388e-05   5.930262e-04   54        54        1         0         227707    340               191820            453               788               
  54    2.199909e-07   2.146515e-05   5.372475e-04   55        55        1         0         229152    345               192858            454               788               
  55    2.149773e-07   1.921512e-05   4.879749e-04   56        56        1         0         230609    350               193908            455               788               
  56    2.109085e-07   1.717011e-05   4.421837e-04   57        57        1         0         232066    355               194958            456               788               
  57    2.076056e-07   1.536919e-05   4.016865e-04   58        58        1         0         233529    360               196014            457               788               
  58    2.049235e-07   1.373440e-05   3.642493e-04   59        59        1         0         234992    365               197070            458               788               
  59    2.027444e-07   1.229214e-05   3.310890e-04   60        60        1         0         236461    370               198132            459               788               
  60    2.009732e-07   1.098412e-05   3.005774e-04   61        61        1         0         237936    375               199200            460               788               
  61    1.995326e-07   9.827989e-06   2.735222e-04   62        62        1         0         239414    380               200271            461               788               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 65.0522 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 4320 design variables: 4000 simulation variables and 320 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.46674e-06       0.00360333        0.0239983         3.83387           0.661732          2.43638           2.88527           502               1                 0                 31728             2                 3358              2018              2012              
2                 1.19066e-07       6.65264e-05       0.00033637        1.01817           0.94011           0.186618          0.343579          344               1                 0                 53236             3                 5431              3403              3392              
3                 4.14609e-11       2.03749e-06       9.44088e-06       3.15537           3.15501           0.0267719         0.0390852         598               1                 0                 90492             4                 9028              5804              5788              
4                 7.64955e-13       9.656e-10         1.48288e-09       2.64608           2.64608           0.000551452       0.00112665        660               1                 0                 131592            5                 12997             8453              8432              
Optimization Terminated with Status: Converged
The process took 95.219 seconds to run.
Total n_vmult for algorithm 131592
