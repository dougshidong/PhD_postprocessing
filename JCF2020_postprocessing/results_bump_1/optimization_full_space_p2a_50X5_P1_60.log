Starting optimization with 60...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   6.731072e-03   
  1     1.441901e-03   6.718871e-03   6.731072e-04   2         2         1         0         129546    34                116417            755               732               
  2     1.201468e-03   6.054477e-03   3.791659e-02   3         3         1         0         131272    40                117656            756               732               
  3     9.993861e-04   5.453000e-03   3.579424e-02   4         4         1         0         133007    46                118904            757               732               
  4     8.281939e-04   4.908146e-03   3.434197e-02   5         5         1         0         134745    52                120155            758               732               
  5     6.829229e-04   4.403145e-03   3.297916e-02   6         6         1         0         136504    58                121427            759               732               
  6     5.593318e-04   3.943093e-03   3.202218e-02   7         7         1         0         138269    64                122705            760               732               
  7     4.561892e-04   3.516279e-03   3.016065e-02   8         8         1         0         140043    70                123992            761               732               
  8     3.731358e-04   3.145751e-03   2.753616e-02   9         9         1         0         141814    76                125276            762               732               
  9     3.066485e-04   2.818278e-03   2.486981e-02   10        10        1         0         143600    82                126575            763               732               
  10    2.526963e-04   2.530195e-03   2.285272e-02   11        11        1         0         145380    88                127868            764               732               
  11    2.085747e-04   2.271534e-03   2.111422e-02   12        12        1         0         147157    94                129158            765               732               
  12    1.723539e-04   2.040283e-03   1.961893e-02   13        13        1         0         148937    100               130451            766               732               
  13    1.425788e-04   1.831848e-03   1.824276e-02   14        14        1         0         150723    106               131750            767               732               
  14    1.180920e-04   1.644617e-03   1.699174e-02   15        15        1         0         152518    112               133058            768               732               
  15    9.795398e-05   1.475810e-03   1.583013e-02   16        16        1         0         154319    118               134372            769               732               
  16    8.139321e-05   1.323950e-03   1.476427e-02   17        17        1         0         156117    124               135683            770               732               
  17    6.777331e-05   1.187021e-03   1.378013e-02   18        18        1         0         157930    130               137009            771               732               
  18    5.656606e-05   1.063728e-03   1.288583e-02   19        19        1         0         159752    136               138344            772               732               
  19    4.732419e-05   9.522204e-04   1.209089e-02   20        20        1         0         161577    142               139682            773               732               
  20    3.964162e-05   8.509114e-04   1.147515e-02   21        21        1         0         163399    148               141017            774               732               
  21    3.311968e-05   7.561353e-04   1.116093e-02   22        22        1         0         165239    154               142370            775               732               
  22    2.760376e-05   6.675779e-04   1.078512e-02   23        23        1         0         167091    160               143735            776               732               
  23    2.326064e-05   5.902409e-04   9.701809e-03   24        24        1         0         168949    166               145106            777               732               
  24    1.986331e-05   5.240192e-04   8.692953e-03   25        25        1         0         170837    172               146507            778               732               
  25    1.712396e-05   4.656170e-04   8.030897e-03   26        26        1         0         172731    178               147914            779               732               
  26    1.487611e-05   4.135383e-04   7.556663e-03   27        27        1         0         174637    184               149333            780               732               
  27    1.301512e-05   3.667361e-04   7.177709e-03   28        28        1         0         176552    190               150761            781               732               
  28    1.146587e-05   3.246192e-04   6.858767e-03   29        29        1         0         178479    196               152201            782               732               
  29    1.017056e-05   2.866405e-04   6.583434e-03   30        30        1         0         180415    202               153650            783               732               
  30    9.083118e-06   2.523963e-04   6.344477e-03   31        31        1         0         181731    207               154559            784               732               
  31    8.166319e-06   2.215006e-04   6.137642e-03   32        32        1         0         183053    212               155474            785               732               
  32    7.389822e-06   1.936390e-04   5.960565e-03   33        33        1         0         184390    217               156404            786               732               
  33    6.728818e-06   1.685199e-04   5.811603e-03   34        34        1         0         185730    222               157337            787               732               
  34    6.162977e-06   1.458995e-04   5.689749e-03   35        35        1         0         187073    227               158273            788               732               
  35    5.675611e-06   1.255613e-04   5.594345e-03   36        36        1         0         188416    232               159209            789               732               
  36    5.253002e-06   1.073284e-04   5.525108e-03   37        37        1         0         189762    237               160148            790               732               
  37    4.883856e-06   9.105768e-05   5.482021e-03   38        38        1         0         191099    242               161078            791               732               
  38    4.558856e-06   7.664576e-05   5.465418e-03   39        39        1         0         192451    247               162023            792               732               
  39    4.270302e-06   6.403795e-05   5.475882e-03   40        40        1         0         193812    252               162977            793               732               
  40    4.011797e-06   5.322713e-05   5.514630e-03   41        41        1         0         195182    257               163940            794               732               
  41    3.777994e-06   4.428045e-05   5.583707e-03   42        42        1         0         196552    262               164903            795               732               
  42    3.564282e-06   3.730194e-05   5.689716e-03   43        43        1         0         197925    267               165869            796               732               
  43    3.366248e-06   3.247667e-05   5.855710e-03   44        44        1         0         199316    272               166853            797               732               
  44    3.178498e-06   2.994194e-05   6.158112e-03   45        45        1         0         200713    277               167843            798               732               
  45    3.002617e-06   2.881731e-05   6.383757e-03   46        46        1         0         202110    282               168833            799               732               
  46    2.849717e-06   2.962757e-05   6.147101e-03   47        47        1         0         203525    287               169841            800               732               
  47    2.713566e-06   3.112041e-05   6.008712e-03   48        48        1         0         204931    292               170840            801               732               
  48    2.585487e-06   3.325900e-05   6.189014e-03   49        49        1         0         206355    297               171857            802               732               
  49    2.467376e-06   3.470164e-05   6.236549e-03   50        50        1         0         207770    302               172865            803               732               
  50    2.363629e-06   3.635382e-05   5.978155e-03   51        51        1         0         209170    307               173858            804               732               
  51    2.269016e-06   3.723471e-05   5.863298e-03   52        52        1         0         210564    312               174845            805               732               
  52    2.180600e-06   3.784287e-05   5.864589e-03   53        53        1         0         211961    317               175835            806               732               
  53    2.095861e-06   3.780607e-05   5.964006e-03   54        54        1         0         213364    322               176831            807               732               
  54    2.014543e-06   3.729860e-05   6.081218e-03   55        55        1         0         214767    327               177827            808               732               
  55    1.936535e-06   3.641096e-05   6.198564e-03   56        56        1         0         216149    332               178802            809               732               
  56    1.859739e-06   3.496709e-05   6.592078e-03   57        57        1         0         217504    337               179750            810               732               
  57    1.779091e-06   3.313747e-05   7.543768e-03   58        58        1         0         218880    342               180719            811               732               
  58    1.717351e-06   3.109001e-05   6.320240e-03   59        59        1         0         220292    347               181724            812               732               
  59    1.666660e-06   2.933351e-05   5.633000e-03   60        60        1         0         221656    352               182681            813               732               
  60    1.614242e-06   2.704384e-05   6.401177e-03   61        61        1         0         223080    357               183698            814               732               
  61    1.573229e-06   2.472813e-05   5.372205e-03   62        62        1         0         224465    362               184676            815               732               
  62    1.541106e-06   2.288746e-05   4.560155e-03   63        63        1         0         225871    367               185675            816               732               
  63    1.511616e-06   2.089974e-05   4.393334e-03   64        64        1         0         227313    372               186710            817               732               
  64    1.484724e-06   1.899157e-05   4.287592e-03   65        65        1         0         228704    377               187694            818               732               
  65    1.460122e-06   1.708313e-05   4.173905e-03   66        66        1         0         230146    382               188729            819               732               
  66    1.437006e-06   1.519344e-05   4.213199e-03   67        67        1         0         231564    387               189740            820               732               
  67    1.414860e-06   1.329918e-05   4.367091e-03   68        68        1         0         233003    392               190772            821               732               
  68    1.395594e-06   1.145463e-05   4.104515e-03   69        69        1         0         234463    397               191825            822               732               
  69    1.379413e-06   9.970477e-06   3.725010e-03   70        70        1         0         235902    402               192857            823               732               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 54.7751 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 4060 design variables: 4000 simulation variables and 60 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.02323e-06       0.00334394        0.0241435         15.4331           14.9613           2.44181           2.89421           398               1                 0                 25280             2                 2734              1602              1596              
2                 6.73584e-08       6.59751e-05       0.00036428        14.5289           14.5237           0.194557          0.338256          266               1                 0                 41952             3                 4339              2675              2664              
3                 2.21493e-11       1.31652e-06       4.42229e-06       0.531982          0.530327          0.0203658         0.0366606         348               1                 0                 63708             4                 6436              4076              4060              
4                 2.30227e-13       3.0555e-10        6.57578e-10       0.133262          0.133258          0.000373378       0.000936043       340               1                 0                 84968             5                 8485              5445              5424              
Optimization Terminated with Status: Converged
The process took 27.7611 seconds to run.
Total n_vmult for algorithm 84968
