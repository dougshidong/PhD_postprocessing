Starting optimization with 100...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   6.075515e-03   
  1     1.442739e-03   6.067075e-03   6.075515e-04   2         2         1         0         104313    34                14296             6247              6224              
  2     1.184243e-03   5.482658e-03   4.572498e-02   3         3         1         0         106051    40                15547             6248              6224              
  3     9.318772e-04   4.805199e-03   5.130556e-02   4         4         1         0         107825    46                16834             6249              6224              
  4     7.456481e-04   4.260754e-03   4.129987e-02   5         5         1         0         109572    52                18094             6250              6224              
  5     6.108985e-04   3.836491e-03   3.361079e-02   6         6         1         0         111325    58                19360             6251              6224              
  6     5.008289e-04   3.454320e-03   3.052694e-02   7         7         1         0         113078    64                20626             6252              6224              
  7     4.103079e-04   3.112247e-03   2.800413e-02   8         8         1         0         114822    70                21883             6253              6224              
  8     3.352347e-04   2.800737e-03   2.596978e-02   9         9         1         0         116584    76                23158             6254              6224              
  9     2.690852e-04   2.503215e-03   2.624989e-02   10        10        1         0         118364    82                24451             6255              6224              
  10    2.108973e-04   2.200025e-03   2.551043e-02   11        11        1         0         120132    88                25732             6256              6224              
  11    1.696943e-04   1.966066e-03   2.029419e-02   12        12        1         0         121909    94                27022             6257              6224              
  12    1.379291e-04   1.764897e-03   1.741956e-02   13        13        1         0         123698    100               28324             6258              6224              
  13    1.124160e-04   1.587707e-03   1.559467e-02   14        14        1         0         125484    106               29623             6259              6224              
  14    9.172995e-05   1.428496e-03   1.405495e-02   15        15        1         0         127282    112               30934             6260              6224              
  15    7.489728e-05   1.285993e-03   1.273177e-02   16        16        1         0         129083    118               32248             6261              6224              
  16    6.118539e-05   1.157494e-03   1.153185e-02   17        17        1         0         130887    124               33565             6262              6224              
  17    5.001205e-05   1.042079e-03   1.045948e-02   18        18        1         0         132706    130               34897             6263              6224              
  18    4.090854e-05   9.379853e-04   9.479786e-03   19        19        1         0         134543    136               36247             6264              6224              
  19    3.349322e-05   8.443887e-04   8.596915e-03   20        20        1         0         136386    142               37603             6265              6224              
  20    2.745504e-05   7.599933e-04   7.791296e-03   21        21        1         0         138229    148               38959             6266              6224              
  21    2.253981e-05   6.840773e-04   7.064052e-03   22        22        1         0         140078    154               40321             6267              6224              
  22    1.853998e-05   6.156415e-04   6.401971e-03   23        23        1         0         141957    160               41713             6268              6224              
  23    1.528598e-05   5.540702e-04   5.804429e-03   24        24        1         0         143845    166               43114             6269              6224              
  24    1.263940e-05   4.985759e-04   5.261683e-03   25        25        1         0         145739    172               44521             6270              6224              
  25    1.048730e-05   4.486431e-04   4.772317e-03   26        26        1         0         147609    178               45904             6271              6224              
  26    8.737592e-06   4.036434e-04   4.328816e-03   27        27        1         0         149518    184               47326             6272              6224              
  27    7.315188e-06   3.631500e-04   3.929496e-03   28        28        1         0         151436    190               48757             6273              6224              
  28    6.158941e-06   3.266584e-04   3.568422e-03   29        29        1         0         153360    196               50194             6274              6224              
  29    5.219049e-06   2.938178e-04   3.243909e-03   30        30        1         0         154664    201               51091             6275              6224              
  30    4.454986e-06   2.642212e-04   2.951211e-03   31        31        1         0         155971    206               51991             6276              6224              
  31    3.833775e-06   2.375815e-04   2.688764e-03   32        32        1         0         157284    211               52897             6277              6224              
  32    3.328603e-06   2.135697e-04   2.452752e-03   33        33        1         0         158600    216               53806             6278              6224              
  33    2.917668e-06   1.919517e-04   2.241782e-03   34        34        1         0         159922    221               54721             6279              6224              
  34    2.583252e-06   1.724606e-04   2.052774e-03   35        35        1         0         161250    226               55642             6280              6224              
  35    2.310959e-06   1.549063e-04   1.884517e-03   36        36        1         0         162578    231               56563             6281              6224              
  36    2.089095e-06   1.390716e-04   1.734521e-03   37        37        1         0         163909    236               57487             6282              6224              
  37    1.908163e-06   1.248023e-04   1.601744e-03   38        38        1         0         165243    241               58414             6283              6224              
  38    1.760452e-06   1.119217e-04   1.484178e-03   39        39        1         0         166583    246               59347             6284              6224              
  39    1.639702e-06   1.003048e-04   1.380925e-03   40        40        1         0         167926    251               60283             6285              6224              
  40    1.540831e-06   8.980710e-05   1.290376e-03   41        41        1         0         169269    256               61219             6286              6224              
  41    1.459713e-06   8.032772e-05   1.211762e-03   42        42        1         0         170618    261               62161             6287              6224              
  42    1.393001e-06   7.174837e-05   1.143813e-03   43        43        1         0         171973    266               63109             6288              6224              
  43    1.337977e-06   6.398754e-05   1.085883e-03   44        44        1         0         173328    271               64057             6289              6224              
  44    1.292436e-06   5.694817e-05   1.037010e-03   45        45        1         0         174686    276               65008             6290              6224              
  45    1.254585e-06   5.056473e-05   9.966870e-04   46        46        1         0         176047    281               65962             6291              6224              
  46    1.222971e-06   4.475748e-05   9.642523e-04   47        47        1         0         177414    286               66922             6292              6224              
  47    1.196411e-06   3.947425e-05   9.393744e-04   48        48        1         0         178784    291               67885             6293              6224              
  48    1.173942e-06   3.464984e-05   9.217080e-04   49        49        1         0         180160    296               68854             6294              6224              
  49    1.154782e-06   3.024400e-05   9.111517e-04   50        50        1         0         181539    301               69826             6295              6224              
  50    1.138292e-06   2.620483e-05   9.077109e-04   51        51        1         0         182924    306               70804             6296              6224              
  51    1.123948e-06   2.250463e-05   9.115847e-04   52        52        1         0         184312    311               71785             6297              6224              
  52    1.111322e-06   1.910707e-05   9.231766e-04   53        53        1         0         185706    316               72772             6298              6224              
  53    1.100056e-06   1.600373e-05   9.430714e-04   54        54        1         0         187103    321               73762             6299              6224              
  54    1.089857e-06   1.318779e-05   9.721286e-04   55        55        1         0         188503    326               74755             6300              6224              
  55    1.080476e-06   1.070025e-05   1.011416e-03   56        56        1         0         189903    331               75748             6301              6224              
  56    1.071699e-06   8.625682e-06   1.062308e-03   57        57        1         0         191309    336               76747             6302              6224              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 48.1601 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 4100 design variables: 4000 simulation variables and 100 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.63097e-06       0.00333294        0.0240365         9.11895           8.29957           2.43594           2.88766           51                1                 0                 71188             2                 66748             214               412               
2                 1.0748e-07        6.41105e-05       0.000351036       6.53145           6.51984           0.188394          0.3406            40                1                 0                 127027            3                 119136            383               736               
3                 5.58604e-11       2.1889e-06        8.1593e-06        1.7071            1.70638           0.0250273         0.042745          51                1                 0                 195463            4                 183219            596               1148              
4                 3.47248e-14       6.30956e-10       9.35881e-10       0.2252            0.225197          0.000619845       0.000980955       54                1                 0                 267610            5                 250767            821               1584              
Optimization Terminated with Status: Converged
The process took 41.291 seconds to run.
Total n_vmult for algorithm 267610
