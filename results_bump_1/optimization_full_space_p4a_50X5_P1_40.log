Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   7.331623e-03   
  1     1.441059e-03   7.314634e-03   7.331623e-04   2         2         1         0         230227    35                213667            696               1316              
  2     1.217252e-03   6.591384e-03   3.245899e-02   3         3         1         0         231947    41                214900            697               1316              
  3     1.027427e-03   5.937952e-03   3.110680e-02   4         4         1         0         233673    47                216139            698               1316              
  4     8.657045e-04   5.343532e-03   3.011529e-02   5         5         1         0         235402    53                217381            699               1316              
  5     7.287593e-04   4.804629e-03   2.907258e-02   6         6         1         0         237143    59                218635            700               1316              
  6     6.133285e-04   4.317116e-03   2.797945e-02   7         7         1         0         238887    65                219892            701               1316              
  7     5.163820e-04   3.876721e-03   2.684799e-02   8         8         1         0         240637    71                221155            702               1316              
  8     4.351878e-04   3.479255e-03   2.569689e-02   9         9         1         0         242387    77                222418            703               1316              
  9     3.673331e-04   3.120737e-03   2.454586e-02   10        10        1         0         244146    83                223690            704               1316              
  10    3.107180e-04   2.797458e-03   2.341265e-02   11        11        1         0         245908    89                224965            705               1316              
  11    2.635357e-04   2.506008e-03   2.231185e-02   12        12        1         0         247673    95                226243            706               1316              
  12    2.242440e-04   2.243276e-03   2.125467e-02   13        13        1         0         249441    101               227524            707               1316              
  13    1.915357e-04   2.006433e-03   2.024925e-02   14        14        1         0         251212    107               228808            708               1316              
  14    1.643082e-04   1.792922e-03   1.930120e-02   15        15        1         0         252986    113               230095            709               1316              
  15    1.416356e-04   1.600426e-03   1.841409e-02   16        16        1         0         254772    119               231394            710               1316              
  16    1.227426e-04   1.426858e-03   1.758993e-02   17        17        1         0         256558    125               232693            711               1316              
  17    1.069822e-04   1.270332e-03   1.682961e-02   18        18        1         0         258341    131               233989            712               1316              
  18    9.381570e-05   1.129148e-03   1.613317e-02   19        19        1         0         260133    137               235294            713               1316              
  19    8.279546e-05   1.001779e-03   1.550009e-02   20        20        1         0         261937    143               236611            714               1316              
  20    7.355010e-05   8.868479e-04   1.492949e-02   21        21        1         0         263747    149               237934            715               1316              
  21    6.577198e-05   7.831211e-04   1.442028e-02   22        22        1         0         265566    155               239266            716               1316              
  22    5.920659e-05   6.894933e-04   1.397135e-02   23        23        1         0         267391    161               240604            717               1316              
  23    5.364349e-05   6.049785e-04   1.358167e-02   24        24        1         0         269225    167               241951            718               1316              
  24    4.890881e-05   5.287011e-04   1.325042e-02   25        25        1         0         271077    173               243316            719               1316              
  25    4.485893e-05   4.598890e-04   1.297711e-02   26        26        1         0         272950    179               244702            720               1316              
  26    4.137517e-05   3.978694e-04   1.276166e-02   27        27        1         0         274832    185               246097            721               1316              
  27    3.835942e-05   3.420665e-04   1.260455e-02   28        28        1         0         276723    191               247501            722               1316              
  28    3.573049e-05   2.920035e-04   1.250693e-02   29        29        1         0         278614    197               248905            723               1316              
  29    3.342106e-05   2.473100e-04   1.247073e-02   30        30        1         0         280502    203               250306            724               1316              
  30    3.137517e-05   2.077368e-04   1.249889e-02   31        31        1         0         282378    209               251695            725               1316              
  31    2.954613e-05   1.731822e-04   1.259552e-02   32        32        1         0         284287    215               253117            726               1316              
  32    2.789473e-05   1.437285e-04   1.276632e-02   33        33        1         0         286205    221               254548            727               1316              
  33    2.638786e-05   1.196753e-04   1.301900e-02   34        34        1         0         288129    227               255985            728               1316              
  34    2.499712e-05   1.015107e-04   1.336432e-02   35        35        1         0         290065    233               257434            729               1316              
  35    2.369756e-05   8.969481e-05   1.382094e-02   36        36        1         0         291968    239               258850            730               1316              
  36    2.246119e-05   8.468092e-05   1.450681e-02   37        37        1         0         293883    245               260278            731               1316              
  37    2.114274e-05   9.448226e-05   1.755496e-02   38        38        1         0         295861    251               261769            732               1316              
  38    1.995671e-05   9.373160e-05   1.698525e-02   39        39        1         0         297809    257               263230            733               1316              
  39    1.904925e-05   1.017325e-04   1.453911e-02   40        40        1         0         299137    262               264151            734               1316              
  40    1.814107e-05   1.049967e-04   1.529164e-02   41        41        1         0         300462    267               265069            735               1316              
  41    1.721834e-05   1.119114e-04   1.690250e-02   42        42        1         0         301796    272               265996            736               1316              
  42    1.623602e-05   1.239083e-04   1.993161e-02   43        43        1         0         303753    278               267466            737               1316              
  43    1.529499e-05   1.240428e-04   1.996169e-02   44        44        1         0         305096    283               268402            738               1316              
  44    1.452583e-05   1.281611e-04   1.794753e-02   45        45        1         0         306460    288               269359            739               1316              
  45    1.358139e-05   1.231471e-04   2.203831e-02   46        46        1         0         307794    293               270286            740               1316              
  46    1.285218e-05   1.222137e-04   1.915271e-02   47        47        1         0         309179    298               271264            741               1316              
  47    1.201151e-05   1.201016e-04   2.334385e-02   48        48        1         0         311133    304               272731            742               1316              
  48    1.127929e-05   1.163240e-04   2.137969e-02   49        49        1         0         312494    309               273685            743               1316              
  49    1.046249e-05   1.063209e-04   2.325298e-02   50        50        1         0         313849    314               274633            744               1316              
  50    9.618578e-06   9.748723e-05   2.700958e-02   51        51        1         0         315249    319               275626            745               1316              
  51    8.830905e-06   8.802957e-05   2.865854e-02   52        52        1         0         316580    324               276550            746               1316              
  52    8.100533e-06   7.550017e-05   2.814563e-02   53        53        1         0         317992    329               277555            747               1316              
  53    7.558021e-06   6.764025e-05   2.376536e-02   54        54        1         0         319353    334               278509            748               1316              
  54    7.022525e-06   5.517722e-05   2.616143e-02   55        55        1         0         320696    339               279445            749               1316              
  55    6.604309e-06   4.680539e-05   2.227808e-02   56        56        1         0         322069    344               280411            750               1316              
  56    6.261173e-06   3.954379e-05   2.033752e-02   57        57        1         0         323460    349               281395            751               1316              
  57    5.946250e-06   3.277392e-05   2.013054e-02   58        58        1         0         324860    354               282388            752               1316              
  58    5.653511e-06   2.730977e-05   2.062099e-02   59        59        1         0         326239    359               283360            753               1316              
  59    5.358338e-06   2.172578e-05   2.283767e-02   60        60        1         0         327636    364               284350            754               1316              
  60    5.101754e-06   1.760758e-05   2.161381e-02   61        61        1         0         329006    369               285313            755               1316              
  61    4.891336e-06   1.630705e-05   1.952399e-02   62        62        1         0         330418    374               286318            756               1316              
  62    4.697521e-06   1.567083e-05   1.905578e-02   63        63        1         0         331818    379               287311            757               1316              
  63    4.514653e-06   1.685586e-05   1.947695e-02   64        64        1         0         333227    384               288313            758               1316              
  64    4.333190e-06   1.807448e-05   2.055349e-02   65        65        1         0         334645    389               289324            759               1316              
  65    4.146151e-06   1.969953e-05   2.309733e-02   66        66        1         0         336009    394               290281            760               1316              
  66    3.999373e-06   2.117963e-05   1.976484e-02   67        67        1         0         337439    399               291304            761               1316              
  67    3.874094e-06   2.189121e-05   1.772340e-02   68        68        1         0         338851    404               292309            762               1316              
  68    3.754295e-06   2.333477e-05   1.822847e-02   69        69        1         0         340302    409               293353            763               1316              
  69    3.644393e-06   2.287892e-05   1.771709e-02   70        70        1         0         341699    414               294343            764               1316              
  70    3.533326e-06   2.518428e-05   1.941282e-02   71        71        1         0         343132    419               295369            765               1316              
  71    3.453395e-06   2.442008e-05   1.478151e-02   72        72        1         0         344583    424               296413            766               1316              
  72    3.380264e-06   2.420460e-05   1.365924e-02   73        73        1         0         346040    429               297463            767               1316              
  73    3.306193e-06   2.266198e-05   1.438611e-02   74        74        1         0         347467    434               298483            768               1316              
  74    3.237399e-06   2.166502e-05   1.402707e-02   75        75        1         0         348894    439               299503            769               1316              
  75    3.161204e-06   2.034372e-05   1.657537e-02   76        76        1         0         350282    444               300484            770               1316              
  76    3.100872e-06   1.838378e-05   1.375079e-02   77        77        1         0         351709    449               301504            771               1316              
  77    3.049877e-06   1.726917e-05   1.218349e-02   78        78        1         0         353145    454               302533            772               1316              
  78    2.997522e-06   1.514682e-05   1.263957e-02   79        79        1         0         354626    459               303607            773               1316              
  79    2.946020e-06   1.368663e-05   1.308147e-02   80        80        1         0         356032    464               304606            774               1316              
  80    2.894918e-06   1.182793e-05   1.327311e-02   81        81        1         0         357513    469               305680            775               1316              
  81    2.843096e-06   1.026099e-05   1.409170e-02   82        82        1         0         358940    474               306700            776               1316              
  82    2.790880e-06   8.761328e-06   1.462970e-02   83        83        1         0         360412    479               307765            777               1316              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 62.6131 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 4040 design variables: 4000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 9.71573e-06       0.00332942        0.0237001         5.86876           4.48927           2.43545           2.89093           326               1                 0                 30596             2                 3606              1314              2612              
2                 8.78865e-08       8.37725e-05       0.000381274       4.69918           4.68171           0.227312          0.334932          250               1                 0                 53776             3                 6115              2323              4616              
3                 4.88612e-11       2.28793e-06       3.466e-06         0.646509          0.643526          0.0246594         0.0569267         275               1                 0                 79256             4                 8874              3432              6820              
4                 2.89024e-14       1.31386e-09       1.27354e-09       0.185819          0.185809          0.00058237        0.00188438        298               1                 0                 106852            5                 11863             4633              9208              
5                 1.2829e-13        8.075e-12         2.36561e-10       0.0261865         0.0261865         1.95917e-05       3.12491e-06       281               1                 0                 132884            6                 14682             5766              11460             
Optimization Terminated with Status: Converged
The process took 29.7939 seconds to run.
Total n_vmult for algorithm 132884
