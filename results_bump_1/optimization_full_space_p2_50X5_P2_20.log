Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   8.745775e-03   
  1     1.452567e-03   8.713000e-03   8.745775e-04   2         2         1         0         129011    64                112770            339               664               
  2     1.255158e-03   7.851069e-03   2.408548e-02   3         3         1         0         131814    70                114486            340               664               
  3     1.086603e-03   7.070007e-03   2.332232e-02   4         4         1         0         134617    76                116202            341               664               
  4     9.422130e-04   6.358528e-03   2.280786e-02   5         5         1         0         137420    82                117918            342               664               
  5     8.191236e-04   5.712394e-03   2.228801e-02   6         6         1         0         140226    88                119637            343               664               
  6     7.145409e-04   5.126698e-03   2.176050e-02   7         7         1         0         143032    94                121356            344               664               
  7     6.258969e-04   4.596462e-03   2.122487e-02   8         8         1         0         145847    100               123084            345               664               
  8     5.508915e-04   4.116853e-03   2.068475e-02   9         9         1         0         148686    106               124836            346               664               
  9     4.874984e-04   3.683289e-03   2.014614e-02   10        10        1         0         151549    112               126612            347               664               
  10    4.339530e-04   3.291496e-03   1.961587e-02   11        11        1         0         154388    118               128364            348               664               
  11    3.887319e-04   2.937531e-03   1.910067e-02   12        12        1         0         157230    124               130119            349               664               
  12    3.505287e-04   2.617781e-03   1.860675e-02   13        13        1         0         159280    129               131262            350               664               
  13    3.182286e-04   2.328951e-03   1.813975e-02   14        14        1         0         161318    134               132393            351               664               
  14    2.908841e-04   2.068046e-03   1.770495e-02   15        15        1         0         163356    139               133524            352               664               
  15    2.676923e-04   1.832348e-03   1.730745e-02   16        16        1         0         165400    144               134661            353               664               
  16    2.479745e-04   1.619394e-03   1.695235e-02   17        17        1         0         167447    149               135801            354               664               
  17    2.311584e-04   1.426958e-03   1.664485e-02   18        18        1         0         169494    154               136941            355               664               
  18    2.167620e-04   1.253035e-03   1.639033e-02   19        19        1         0         171565    159               138105            356               664               
  19    2.043806e-04   1.095832e-03   1.619431e-02   20        20        1         0         173645    164               139278            357               664               
  20    1.936743e-04   9.537579e-04   1.606244e-02   21        21        1         0         175725    169               140451            358               664               
  21    1.843584e-04   8.254284e-04   1.600047e-02   22        22        1         0         177805    174               141624            359               664               
  22    1.761948e-04   7.096692e-04   1.601414e-02   23        23        1         0         179891    179               142803            360               664               
  23    1.689844e-04   6.055362e-04   1.610918e-02   24        24        1         0         181977    184               143982            361               664               
  24    1.625607e-04   5.123475e-04   1.629128e-02   25        25        1         0         184063    189               145161            362               664               
  25    1.567848e-04   4.297409e-04   1.656582e-02   26        26        1         0         186143    194               146334            363               664               
  26    1.515407e-04   3.577627e-04   1.693800e-02   27        27        1         0         188235    199               147519            364               664               
  27    1.467315e-04   2.969825e-04   1.741262e-02   28        28        1         0         190324    204               148701            365               664               
  28    1.422761e-04   2.485676e-04   1.799417e-02   29        29        1         0         192404    209               149874            366               664               
  29    1.381064e-04   2.140662e-04   1.868732e-02   30        30        1         0         194493    214               151056            367               664               
  30    1.341646e-04   1.944623e-04   1.949816e-02   31        31        1         0         196582    219               152238            368               664               
  31    1.304005e-04   1.886422e-04   2.043762e-02   32        32        1         0         198671    224               153420            369               664               
  32    1.267683e-04   1.928938e-04   2.152909e-02   33        33        1         0         200760    229               154602            370               664               
  33    1.232214e-04   2.023736e-04   2.282584e-02   34        34        1         0         202852    234               155787            371               664               
  34    1.197041e-04   2.128127e-04   2.445129e-02   35        35        1         0         204953    239               156981            372               664               
  35    1.161345e-04   2.211262e-04   2.669489e-02   36        36        1         0         207057    244               158178            373               664               
  36    1.123722e-04   2.255211e-04   3.024318e-02   37        37        1         0         209161    249               159375            374               664               
  37    1.081758e-04   2.250004e-04   3.654977e-02   38        38        1         0         211259    254               160566            375               664               
  38    1.035578e-04   3.157719e-04   5.456430e-02   39        39        1         0         213336    259               161736            376               664               
  39    9.965340e-05   3.024962e-04   4.015387e-02   40        40        1         0         215440    264               162933            377               664               
  40    9.579506e-05   2.864511e-04   4.275030e-02   41        41        1         0         217544    269               164130            378               664               
  41    9.164311e-05   2.706256e-04   5.054943e-02   42        42        1         0         219657    274               165336            379               664               
  42    8.637668e-05   2.533034e-04   7.436119e-02   43        43        1         0         221746    279               166518            380               664               
  43    8.283432e-05   2.347393e-04   5.293459e-02   44        44        1         0         223886    284               167751            381               664               
  44    7.979116e-05   2.146050e-04   4.993516e-02   45        45        1         0         226017    289               168975            382               664               
  45    7.654373e-05   2.076720e-04   5.768588e-02   46        46        1         0         228163    294               170214            383               664               
  46    7.352309e-05   1.813596e-04   5.873125e-02   47        47        1         0         230276    299               171420            384               664               
  47    7.124388e-05   1.664217e-04   4.863784e-02   48        48        1         0         232419    304               172656            385               664               
  48    6.902194e-05   1.588416e-04   5.247256e-02   49        49        1         0         234508    309               173838            386               664               
  49    6.701088e-05   1.375712e-04   5.048352e-02   50        50        1         0         236630    314               175053            387               664               
  50    6.556771e-05   1.267589e-04   3.985973e-02   51        51        1         0         238773    319               176289            388               664               
  51    6.426196e-05   1.129192e-04   3.759758e-02   52        52        1         0         240907    324               177516            389               664               
  52    6.307948e-05   1.036455e-04   3.676314e-02   53        53        1         0         243056    329               178758            390               664               
  53    6.200471e-05   9.152823e-05   3.496470e-02   54        54        1         0         245220    334               180015            391               664               
  54    6.102825e-05   8.320168e-05   3.433145e-02   55        55        1         0         247414    339               181302            392               664               
  55    6.013576e-05   7.253803e-05   3.307186e-02   56        56        1         0         249584    344               182565            393               664               
  56    5.931150e-05   6.483385e-05   3.300575e-02   57        57        1         0         251778    349               183852            394               664               
  57    5.853287e-05   5.605637e-05   3.338471e-02   58        58        1         0         253924    354               185091            395               664               
  58    5.773260e-05   4.722704e-05   3.713176e-02   59        59        1         0         256085    359               186345            396               664               
  59    5.704676e-05   4.056857e-05   3.476190e-02   60        60        1         0         258225    364               187578            397               664               
  60    5.644187e-05   3.444762e-05   3.273991e-02   61        61        1         0         260386    369               188832            398               664               
  61    5.587968e-05   3.043197e-05   3.245948e-02   62        62        1         0         262559    374               190098            399               664               
  62    5.531521e-05   2.782973e-05   3.411622e-02   63        63        1         0         264693    379               191325            400               664               
  63    5.472791e-05   2.703295e-05   3.729903e-02   64        64        1         0         266863    384               192588            401               664               
  64    5.410714e-05   2.876119e-05   4.101497e-02   65        65        1         0         269075    389               193893            402               664               
  65    5.343913e-05   3.187781e-05   4.600488e-02   66        66        1         0         271242    394               195153            403               664               
  66    5.271714e-05   3.667922e-05   5.150290e-02   67        67        1         0         273415    399               196419            404               664               
  67    5.192274e-05   4.358226e-05   5.862419e-02   68        68        1         0         275585    404               197682            405               664               
  68    5.105415e-05   4.779453e-05   6.653484e-02   69        69        1         0         277734    409               198924            406               664               
  69    5.002143e-05   7.100431e-05   8.349900e-02   70        70        1         0         279886    414               200169            407               664               
  70    4.919265e-05   7.931754e-05   6.977308e-02   71        71        1         0         282065    419               201441            408               664               
  71    4.822606e-05   8.321276e-05   8.213204e-02   72        72        1         0         284196    424               202665            409               664               
  72    4.712280e-05   9.524001e-05   9.504526e-02   73        73        1         0         286360    429               203922            410               664               
  73    4.591314e-05   9.864167e-05   1.058911e-01   74        74        1         0         288503    434               205158            411               664               
  74    4.458637e-05   1.115457e-04   1.175094e-01   75        75        1         0         290643    439               206391            412               664               
  75    4.318864e-05   1.134025e-04   1.265323e-01   76        76        1         0         292786    444               207627            413               664               
  76    4.171087e-05   1.234681e-04   1.345593e-01   77        77        1         0         294926    449               208860            414               664               
  77    4.022038e-05   1.232832e-04   1.396655e-01   78        78        1         0         297066    454               210093            415               664               
  78    3.872864e-05   1.234771e-04   1.396391e-01   79        79        1         0         299197    459               211317            416               664               
  79    3.725898e-05   1.220540e-04   1.424677e-01   80        80        1         0         301343    464               212556            417               664               
  80    3.587627e-05   1.136824e-04   1.361471e-01   81        81        1         0         303486    469               213792            418               664               
  81    3.463048e-05   1.108835e-04   1.275332e-01   82        82        1         0         305650    474               215049            419               664               
  82    3.349259e-05   1.031775e-04   1.185934e-01   83        83        1         0         307793    479               216285            420               664               
  83    3.247289e-05   9.704216e-05   1.095877e-01   84        84        1         0         309972    484               217557            421               664               
  84    3.158996e-05   9.238651e-05   9.781276e-02   85        85        1         0         312145    489               218823            422               664               
  85    3.080260e-05   8.349157e-05   8.911905e-02   86        86        1         0         314324    494               220095            423               664               
  86    3.012765e-05   7.834615e-05   7.997414e-02   87        87        1         0         316548    499               221412            424               664               
  87    2.955708e-05   7.086858e-05   6.970977e-02   88        88        1         0         318739    504               222696            425               664               
  88    2.907364e-05   6.592553e-05   6.169879e-02   89        89        1         0         320954    509               224004            426               664               
  89    2.866800e-05   5.962587e-05   5.392179e-02   90        90        1         0         323193    514               225336            427               664               
  90    2.832821e-05   5.466440e-05   4.723123e-02   91        91        1         0         325420    519               226656            428               664               
  91    2.804594e-05   4.951709e-05   4.121599e-02   92        92        1         0         327668    524               227997            429               664               
  92    2.781135e-05   4.493191e-05   3.593425e-02   93        93        1         0         329877    529               229299            430               664               
  93    2.761701e-05   4.056630e-05   3.144185e-02   94        94        1         0         332113    534               230628            431               664               
  94    2.745592e-05   3.655537e-05   2.747983e-02   95        95        1         0         334367    539               231975            432               664               
  95    2.732235e-05   3.283536e-05   2.416569e-02   96        96        1         0         336627    544               233328            433               664               
  96    2.721140e-05   2.940733e-05   2.128105e-02   97        97        1         0         338893    549               234687            434               664               
  97    2.711902e-05   2.624696e-05   1.886428e-02   98        98        1         0         341165    554               236052            435               664               
  98    2.704185e-05   2.333789e-05   1.678542e-02   99        99        1         0         343437    559               237417            436               664               
  99    2.697712e-05   2.065836e-05   1.503858e-02   100       100       1         0         345718    564               238791            437               664               
  100   2.692255e-05   1.819120e-05   1.355202e-02   101       101       1         0         347996    569               240162            438               664               
  101   2.687626e-05   1.591669e-05   1.230706e-02   102       102       1         0         350280    574               241539            439               664               
  102   2.683669e-05   1.381880e-05   1.126324e-02   103       103       1         0         352561    579               242913            440               664               
  103   2.680257e-05   1.188172e-05   1.040254e-02   104       104       1         0         354851    584               244296            441               664               
  104   2.677283e-05   1.009327e-05   9.701482e-03   105       105       1         0         357144    589               245682            442               664               
  105   2.674661e-05   8.445103e-06   9.146950e-03   106       106       1         0         359440    594               247071            443               664               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 351.332 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2 preconditioner
Using 9020 design variables: 9000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.35927e-06       0.00487217        0.0190192         7.2832            4.42257           3.44708           4.64796           28                1                 0                 24214             2                 22188             122               116               
2                 2.05231e-07       0.000187953       0.000460748       1.72215           1.58108           0.284483          0.620524          23                1                 0                 43033             3                 39448             223               212               
3                 1.26959e-10       1.99958e-05       1.31238e-05       1.38914           1.37133           0.0522186         0.215439          26                1                 0                 64372             4                 59060             336               320               
4                 3.85132e-13       8.54187e-09       4.35735e-09       0.090613          0.090439          0.00128053        0.00546375        27                1                 0                 86462             5                 79367             453               432               
5                 3.79572e-13       4.0018e-12        4.05416e-12       0.00160758        0.00160758        1.02007e-06       1.08438e-06       28                1                 0                 109285            6                 100351            574               548               
Optimization Terminated with Status: Converged
The process took 241.125 seconds to run.
Total n_vmult for algorithm 109285
