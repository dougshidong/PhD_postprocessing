Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460802e-03   7.440529e-03   
  1     1.455273e-03   7.422925e-03   7.440529e-04   2         2         1         0         139799    58                21307             7152              7124              
  2     1.229715e-03   6.689361e-03   3.222584e-02   3         3         1         0         143604    64                23185             7153              7124              
  3     1.038612e-03   6.027382e-03   3.081839e-02   4         4         1         0         147412    70                25066             7154              7124              
  4     8.757571e-04   5.425209e-03   2.981081e-02   5         5         1         0         151190    76                26917             7155              7124              
  5     7.377585e-04   4.879172e-03   2.877196e-02   6         6         1         0         154998    82                28798             7156              7124              
  6     6.213326e-04   4.385065e-03   2.769636e-02   7         7         1         0         158818    88                30691             7157              7124              
  7     5.234494e-04   3.938574e-03   2.659043e-02   8         8         1         0         162647    94                32593             7158              7124              
  8     4.413827e-04   3.535484e-03   2.546862e-02   9         9         1         0         166458    100               34477             7159              7124              
  9     3.727257e-04   3.171788e-03   2.434773e-02   10        10        1         0         169358    105               35770             7160              7124              
  10    3.153820e-04   2.843756e-03   2.324366e-02   11        11        1         0         172255    110               37060             7161              7124              
  11    2.675454e-04   2.547952e-03   2.216991e-02   12        12        1         0         175152    115               38350             7162              7124              
  12    2.276723e-04   2.281237e-03   2.113715e-02   13        13        1         0         178055    120               39646             7163              7124              
  13    1.944518e-04   2.040761e-03   2.015328e-02   14        14        1         0         180973    125               40957             7164              7124              
  14    1.667766e-04   1.823937e-03   1.922382e-02   15        15        1         0         183897    130               42274             7165              7124              
  15    1.437153e-04   1.628429e-03   1.835239e-02   16        16        1         0         186824    135               43594             7166              7124              
  16    1.244870e-04   1.452124e-03   1.754110e-02   17        17        1         0         189760    140               44923             7167              7124              
  17    1.084390e-04   1.293118e-03   1.679099e-02   18        18        1         0         192705    145               46261             7168              7124              
  18    9.502688e-05   1.149691e-03   1.610229e-02   19        19        1         0         195656    150               47605             7169              7124              
  19    8.379784e-05   1.020294e-03   1.547475e-02   20        20        1         0         198616    155               48958             7170              7124              
  20    7.437558e-05   9.035343e-04   1.490775e-02   21        21        1         0         201582    160               50317             7171              7124              
  21    6.644802e-05   7.981583e-04   1.440054e-02   22        22        1         0         204551    165               51679             7172              7124              
  22    5.975659e-05   7.030435e-04   1.395234e-02   23        23        1         0         207523    170               53044             7173              7124              
  23    5.408731e-05   6.171863e-04   1.356244e-02   24        24        1         0         210501    175               54415             7174              7124              
  24    4.926315e-05   5.396940e-04   1.323033e-02   25        25        1         0         213479    180               55786             7175              7124              
  25    4.513777e-05   4.697783e-04   1.295576e-02   26        26        1         0         216439    185               57139             7176              7124              
  26    4.159018e-05   4.067504e-04   1.273885e-02   27        27        1         0         219423    190               58516             7177              7124              
  27    3.852031e-05   3.500193e-04   1.258014e-02   28        28        1         0         222389    195               59875             7178              7124              
  28    3.584536e-05   2.990935e-04   1.248074e-02   29        29        1         0         225376    200               61255             7179              7124              
  29    3.349670e-05   2.535877e-04   1.244238e-02   30        30        1         0         228366    205               62638             7180              7124              
  30    3.141733e-05   2.132369e-04   1.246760e-02   31        31        1         0         231389    210               64054             7181              7124              
  31    2.955977e-05   1.779212e-04   1.255988e-02   32        32        1         0         234391    215               65449             7182              7124              
  32    2.788428e-05   1.477009e-04   1.272395e-02   33        33        1         0         237393    220               66844             7183              7124              
  33    2.635738e-05   1.228509e-04   1.296622e-02   34        34        1         0         240386    225               68230             7184              7124              
  34    2.495057e-05   1.038412e-04   1.329547e-02   35        35        1         0         243379    230               69616             7185              7124              
  35    2.363921e-05   9.113370e-05   1.372405e-02   36        36        1         0         246399    235               71029             7186              7124              
  36    2.240151e-05   8.469452e-05   1.426986e-02   37        37        1         0         249398    240               72421             7187              7124              
  37    2.121747e-05   8.352516e-05   1.495962e-02   38        38        1         0         252412    245               73828             7188              7124              
  38    2.006785e-05   8.582953e-05   1.583442e-02   39        39        1         0         255453    250               75262             7189              7124              
  39    1.893294e-05   8.970148e-05   1.695835e-02   40        40        1         0         258458    255               76660             7190              7124              
  40    1.779128e-05   9.360439e-05   1.843120e-02   41        41        1         0         261496    260               78091             7191              7124              
  41    1.661865e-05   9.642767e-05   2.040133e-02   42        42        1         0         264507    265               79495             7192              7124              
  42    1.538912e-05   9.735580e-05   2.306082e-02   43        43        1         0         267542    270               80923             7193              7124              
  43    1.409643e-05   9.944809e-05   2.681453e-02   44        44        1         0         270595    275               82369             7194              7124              
  44    1.233650e-05   9.393030e-05   4.017851e-02   45        45        1         0         273603    280               83770             7195              7124              
  45    1.131899e-05   8.939262e-05   2.650138e-02   46        46        1         0         276665    285               85225             7196              7124              
  46    1.047584e-05   8.661843e-05   2.436903e-02   47        47        1         0         279688    290               86641             7197              7124              
  47    9.716955e-06   8.052121e-05   2.384811e-02   48        48        1         0         282753    295               88099             7198              7124              
  48    9.017480e-06   8.248889e-05   2.581259e-02   49        49        1         0         285794    300               89533             7199              7124              
  49    8.406965e-06   7.399020e-05   2.334762e-02   50        50        1         0         288871    305               91003             7200              7124              
  50    7.957461e-06   6.927431e-05   1.939725e-02   51        51        1         0         291954    310               92479             7201              7124              
  51    7.493741e-06   6.634174e-05   2.228345e-02   52        52        1         0         295007    315               93925             7202              7124              
  52    7.102821e-06   5.873160e-05   1.988115e-02   53        53        1         0         298087    320               95398             7203              7124              
  53    6.795643e-06   5.371558e-05   1.741235e-02   54        54        1         0         301215    325               96919             7204              7124              
  54    6.473957e-06   4.917686e-05   1.952578e-02   55        55        1         0         304241    330               98338             7205              7124              
  55    6.167912e-06   4.156803e-05   2.014469e-02   56        56        1         0         307357    335               99847             7206              7124              
  56    5.928688e-06   3.709471e-05   1.749750e-02   57        57        1         0         310434    340               101317            7207              7124              
  57    5.680722e-06   3.229750e-05   1.931865e-02   58        58        1         0         313526    345               102802            7208              7124              
  58    5.456605e-06   2.650020e-05   1.880002e-02   59        59        1         0         316627    350               104296            7209              7124              
  59    5.270522e-06   2.351514e-05   1.688875e-02   60        60        1         0         319746    355               105808            7210              7124              
  60    5.080886e-06   1.946450e-05   1.746781e-02   61        61        1         0         322841    360               107296            7211              7124              
  61    4.891960e-06   1.761362e-05   1.881282e-02   62        62        1         0         325951    365               108799            7212              7124              
  62    4.702150e-06   1.677085e-05   1.926557e-02   63        63        1         0         329064    370               110305            7213              7124              
  63    4.505553e-06   1.652431e-05   2.138736e-02   64        64        1         0         332198    375               111832            7214              7124              
  64    4.301626e-06   1.828161e-05   2.398756e-02   65        65        1         0         335290    380               113317            7215              7124              
  65    4.125640e-06   1.939307e-05   2.150660e-02   66        66        1         0         338421    385               114841            7216              7124              
  66    3.978366e-06   2.054388e-05   1.906345e-02   67        67        1         0         341522    390               116335            7217              7124              
  67    3.824002e-06   2.288313e-05   2.006580e-02   68        68        1         0         344671    395               117877            7218              7124              
  68    3.657887e-06   2.352676e-05   2.287297e-02   69        69        1         0         347745    400               119344            7219              7124              
  69    3.510158e-06   2.397711e-05   2.202223e-02   70        70        1         0         350849    405               120841            7220              7124              
  70    3.385334e-06   2.449901e-05   1.891066e-02   71        71        1         0         353944    410               122329            7221              7124              
  71    3.278194e-06   2.371078e-05   1.695708e-02   72        72        1         0         357063    415               123841            7222              7124              
  72    3.174101e-06   2.401003e-05   1.639972e-02   73        73        1         0         360173    420               125344            7223              7124              
  73    3.077892e-06   2.224876e-05   1.589214e-02   74        74        1         0         363292    425               126856            7224              7124              
  74    2.990536e-06   2.211956e-05   1.494658e-02   75        75        1         0         366393    430               128350            7225              7124              
  75    2.890314e-06   1.916255e-05   1.958002e-02   76        76        1         0         369506    435               129856            7226              7124              
  76    2.826628e-06   1.784438e-05   1.251589e-02   77        77        1         0         372643    440               131386            7227              7124              
  77    2.768152e-06   1.659899e-05   1.189841e-02   78        78        1         0         375771    445               132907            7228              7124              
  78    2.693913e-06   1.537905e-05   1.631475e-02   79        79        1         0         378851    450               134380            7229              7124              
  79    2.640258e-06   1.369153e-05   1.240757e-02   80        80        1         0         382015    455               135937            7230              7124              
  80    2.594947e-06   1.240691e-05   1.106516e-02   81        81        1         0         385197    460               137512            7231              7124              
  81    2.548366e-06   1.110543e-05   1.171467e-02   82        82        1         0         388277    465               138985            7232              7124              
  82    2.499916e-06   9.521038e-06   1.294484e-02   83        83        1         0         391468    470               140569            7233              7124              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 1017.08 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 16040 design variables: 16000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.524e-06         0.00474822        0.0181381         9.04413           4.81235           4.66569           6.07198           32                1                 0                 61996             2                 58634             138               260               
2                 4.38788e-07       0.000190216       0.000466895       2.60464           2.41988           0.395906          0.878392          27                1                 0                 113539            3                 107552            255               480               
3                 3.81638e-10       2.79266e-05       3.52103e-05       2.32812           2.31425           0.118334          0.224487          31                1                 0                 172555            4                 163615            388               732               
4                 1.32399e-12       2.50981e-08       1.24845e-08       0.0485537         0.0466553         0.00315313        0.0130691         33                1                 0                 235141            5                 223084            529               1000              
5                 5.7608e-15        1.46382e-11       4.32157e-11       0.0986568         0.0986566         0.000169588       8.7496e-05        36                1                 0                 302242            6                 286822            682               1292              
Optimization Terminated with Status: Converged
The process took 1833.19 seconds to run.
Total n_vmult for algorithm 302242
