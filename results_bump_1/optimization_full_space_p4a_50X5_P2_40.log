Starting optimization with 40...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   7.437042e-03   
  1     1.454677e-03   7.419454e-03   7.437042e-04   2         2         1         0         276171    47                254361            676               1276              
  2     1.229206e-03   6.686226e-03   3.222978e-02   3         3         1         0         278929    53                256032            677               1276              
  3     1.038176e-03   6.024536e-03   3.082216e-02   4         4         1         0         281696    59                257712            678               1276              
  4     8.753824e-04   5.422619e-03   2.981558e-02   5         5         1         0         284469    65                259398            679               1276              
  5     7.374359e-04   4.876816e-03   2.877725e-02   6         6         1         0         287257    71                261099            680               1276              
  6     6.210556e-04   4.382924e-03   2.770169e-02   7         7         1         0         290069    77                262824            681               1276              
  7     5.232121e-04   3.936632e-03   2.659550e-02   8         8         1         0         292896    83                264564            682               1276              
  8     4.411801e-04   3.533723e-03   2.547330e-02   9         9         1         0         295732    89                266313            683               1276              
  9     3.725532e-04   3.170194e-03   2.435197e-02   10        10        1         0         298592    95                268086            684               1276              
  10    3.152355e-04   2.842313e-03   2.324745e-02   11        11        1         0         301464    101               269871            685               1276              
  11    2.674214e-04   2.546647e-03   2.217331e-02   12        12        1         0         303475    106               270975            686               1276              
  12    2.275675e-04   2.280057e-03   2.114018e-02   13        13        1         0         305495    111               272088            687               1276              
  13    1.943634e-04   2.039694e-03   2.015598e-02   14        14        1         0         307515    116               273201            688               1276              
  14    1.667023e-04   1.822973e-03   1.922623e-02   15        15        1         0         309538    121               274317            689               1276              
  15    1.436529e-04   1.627559e-03   1.835453e-02   16        16        1         0         311585    126               275457            690               1276              
  16    1.244347e-04   1.451339e-03   1.754300e-02   17        17        1         0         313635    131               276600            691               1276              
  17    1.083952e-04   1.292410e-03   1.679269e-02   18        18        1         0         315685    136               277743            692               1276              
  18    9.499035e-05   1.149053e-03   1.610386e-02   19        19        1         0         317735    141               278886            693               1276              
  19    8.376732e-05   1.019720e-03   1.547626e-02   20        20        1         0         319785    146               280029            694               1276              
  20    7.435005e-05   9.030163e-04   1.490928e-02   21        21        1         0         321841    151               281178            695               1276              
  21    6.642659e-05   7.976908e-04   1.440219e-02   22        22        1         0         323897    156               282327            696               1276              
  22    5.973848e-05   7.026207e-04   1.395421e-02   23        23        1         0         325953    161               283476            697               1276              
  23    5.407185e-05   6.168028e-04   1.356461e-02   24        24        1         0         328006    166               284622            698               1276              
  24    4.924979e-05   5.393450e-04   1.323287e-02   25        25        1         0         330056    171               285765            699               1276              
  25    4.512604e-05   4.694596e-04   1.295871e-02   26        26        1         0         332112    176               286914            700               1276              
  26    4.157970e-05   4.064587e-04   1.274220e-02   27        27        1         0         334177    181               288072            701               1276              
  27    3.851079e-05   3.497522e-04   1.258385e-02   28        28        1         0         336245    186               289233            702               1276              
  28    3.583659e-05   2.988495e-04   1.248470e-02   29        29        1         0         338316    191               290397            703               1276              
  29    3.348854e-05   2.533666e-04   1.244641e-02   30        30        1         0         340411    196               291585            704               1276              
  30    3.140972e-05   2.130399e-04   1.247144e-02   31        31        1         0         342521    201               292788            705               1276              
  31    2.955270e-05   1.777505e-04   1.256319e-02   32        32        1         0         344628    206               293988            706               1276              
  32    2.787781e-05   1.475595e-04   1.272631e-02   33        33        1         0         346735    211               295188            707               1276              
  33    2.635162e-05   1.227417e-04   1.296715e-02   34        34        1         0         348857    216               296403            708               1276              
  34    2.494565e-05   1.037641e-04   1.329449e-02   35        35        1         0         350982    221               297621            709               1276              
  35    2.363531e-05   9.108193e-05   1.372078e-02   36        36        1         0         353086    226               298818            710               1276              
  36    2.239876e-05   8.465233e-05   1.426422e-02   37        37        1         0         355193    231               300018            711               1276              
  37    2.121596e-05   8.347122e-05   1.495226e-02   38        38        1         0         357309    236               301227            712               1276              
  38    2.006752e-05   8.574563e-05   1.582738e-02   39        39        1         0         359437    241               302448            713               1276              
  39    1.893347e-05   8.957773e-05   1.695635e-02   40        40        1         0         361559    246               303663            714               1276              
  40    1.779186e-05   9.345865e-05   1.844375e-02   41        41        1         0         363690    251               304887            715               1276              
  41    1.661780e-05   9.632582e-05   2.046675e-02   42        42        1         0         365827    256               306117            716               1276              
  42    1.535717e-05   1.472244e-04   2.959620e-02   43        43        1         0         367949    261               307332            717               1276              
  43    1.438019e-05   1.416187e-04   2.014323e-02   44        44        1         0         370041    266               308517            718               1276              
  44    1.348821e-05   1.354453e-04   1.969895e-02   45        45        1         0         372187    271               309756            719               1276              
  45    1.259582e-05   1.287426e-04   2.120851e-02   46        46        1         0         374336    276               310998            720               1276              
  46    1.158569e-05   1.351949e-04   2.945236e-02   47        47        1         0         376446    281               312201            721               1276              
  47    1.086542e-05   1.258707e-04   2.060484e-02   48        48        1         0         378598    286               313446            722               1276              
  48    1.025782e-05   1.177287e-04   1.877109e-02   49        49        1         0         380741    291               314682            723               1276              
  49    9.680102e-06   1.088361e-04   1.907708e-02   50        50        1         0         382929    296               315963            724               1276              
  50    9.104870e-06   1.010329e-04   2.087515e-02   51        51        1         0         385114    301               317241            725               1276              
  51    8.521827e-06   8.920109e-05   2.291413e-02   52        52        1         0         387263    306               318483            726               1276              
  52    8.109992e-06   8.145246e-05   1.793356e-02   53        53        1         0         389448    311               319761            727               1276              
  53    7.753375e-06   7.333057e-05   1.663504e-02   54        54        1         0         391651    316               321057            728               1276              
  54    7.422012e-06   6.670988e-05   1.664156e-02   55        55        1         0         393839    321               322338            729               1276              
  55    7.090576e-06   5.766878e-05   1.817522e-02   56        56        1         0         396072    326               323664            730               1276              
  56    6.801030e-06   5.052325e-05   1.707095e-02   57        57        1         0         398266    331               324951            731               1276              
  57    6.559300e-06   4.451167e-05   1.549207e-02   58        58        1         0         400466    336               326244            732               1276              
  58    6.326986e-06   3.807658e-05   1.588329e-02   59        59        1         0         402714    341               327585            733               1276              
  59    6.108368e-06   3.297275e-05   1.604753e-02   60        60        1         0         404899    346               328863            734               1276              
  60    5.908724e-06   2.798705e-05   1.569853e-02   61        61        1         0         407126    351               330183            735               1276              
  61    5.725211e-06   2.443968e-05   1.523568e-02   62        62        1         0         409329    356               331479            736               1276              
  62    5.548588e-06   2.188176e-05   1.544349e-02   63        63        1         0         411544    361               332787            737               1276              
  63    5.370767e-06   2.046165e-05   1.623643e-02   64        64        1         0         413783    366               334119            738               1276              
  64    5.184668e-06   2.067746e-05   1.795571e-02   65        65        1         0         415971    371               335400            739               1276              
  65    4.984238e-06   2.212659e-05   2.052692e-02   66        66        1         0         418186    376               336708            740               1276              
  66    4.814418e-06   2.399862e-05   1.835175e-02   67        67        1         0         420395    381               338010            741               1276              
  67    4.652152e-06   2.660645e-05   1.812010e-02   68        68        1         0         422613    386               339321            742               1276              
  68    4.484170e-06   2.869736e-05   1.913225e-02   69        69        1         0         424819    391               340620            743               1276              
  69    4.307454e-06   3.143785e-05   2.062525e-02   70        70        1         0         427082    396               341976            744               1276              
  70    4.117027e-06   3.294383e-05   2.296363e-02   71        71        1         0         429237    401               343224            745               1276              
  71    3.898504e-06   3.524141e-05   2.822167e-02   72        72        1         0         431428    406               344508            746               1276              
  72    3.732344e-06   3.648940e-05   2.258086e-02   73        73        1         0         433691    411               345864            747               1276              
  73    3.582600e-06   3.625749e-05   2.092883e-02   74        74        1         0         435948    416               347214            748               1276              
  74    3.431164e-06   3.738421e-05   2.196830e-02   75        75        1         0         438208    421               348567            749               1276              
  75    3.292626e-06   3.560520e-05   2.101208e-02   76        76        1         0         440432    426               349884            750               1276              
  76    3.160966e-06   3.543642e-05   2.105466e-02   77        77        1         0         442704    431               351249            751               1276              
  77    3.055602e-06   3.372964e-05   1.757827e-02   78        78        1         0         444925    436               352563            752               1276              
  78    2.967365e-06   3.220470e-05   1.506461e-02   79        79        1         0         447200    441               353931            753               1276              
  79    2.886525e-06   3.027540e-05   1.414007e-02   80        80        1         0         449469    446               355293            754               1276              
  80    2.813638e-06   2.818972e-05   1.311197e-02   81        81        1         0         451744    451               356661            755               1276              
  81    2.748895e-06   2.597357e-05   1.210815e-02   82        82        1         0         453968    456               357978            756               1276              
  82    2.691208e-06   2.377486e-05   1.121418e-02   83        83        1         0         456267    461               359370            757               1276              
  83    2.639652e-06   2.148220e-05   1.051435e-02   84        84        1         0         458530    466               360726            758               1276              
  84    2.593465e-06   1.926483e-05   9.912276e-03   85        85        1         0         460814    471               362103            759               1276              
  85    2.551761e-06   1.702240e-05   9.482800e-03   86        86        1         0         463083    476               363465            760               1276              
  86    2.514129e-06   1.484866e-05   9.094454e-03   87        87        1         0         465370    481               364845            761               1276              
  87    2.480782e-06   1.278139e-05   8.578524e-03   88        88        1         0         467675    486               366243            762               1276              
  88    2.451041e-06   1.084172e-05   8.133754e-03   89        89        1         0         469971    491               367632            763               1276              
  89    2.423879e-06   9.037850e-06   7.881721e-03   90        90        1         0         472300    496               369054            764               1276              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 307.147 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 9040 design variables: 9000 simulation variables and 40 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.34913e-06       0.00513267        0.0219224         11.8299           10.3105           3.51182           4.61602           377               1                 0                 35554             2                 4182              1518              3020              
2                 3.6126e-07        0.000177453       0.000533269       4.58879           4.53553           0.294608          0.631799          252               1                 0                 59018             3                 6711              2535              5040              
3                 1.89826e-10       1.95289e-05       2.38601e-05       5.51283           5.51006           0.0691341         0.160297          299               1                 0                 86806             4                 9710              3740              7436              
4                 6.13806e-14       1.10116e-08       5.51836e-09       0.298773          0.298683          0.00162024        0.0071418         317               1                 0                 116250            5                 12889             5017              9976              
5                 1.52489e-14       5.81049e-12       4.10938e-12       0.0128005         0.0128005         3.20858e-05       6.21412e-06       318               1                 0                 145786            6                 16078             6298              12524             
Optimization Terminated with Status: Converged
The process took 184.712 seconds to run.
Total n_vmult for algorithm 145786
