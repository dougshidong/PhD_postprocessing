Starting optimization with 20...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   8.617416e-03   
  1     1.439015e-03   8.585692e-03   8.617416e-04   2         2         1         0         164376    36                151918            492               908               
  2     1.243746e-03   7.736076e-03   2.418500e-02   3         3         1         0         166099    42                153154            493               908               
  3     1.076880e-03   6.965577e-03   2.345293e-02   4         4         1         0         167825    48                154393            494               908               
  4     9.338980e-04   6.263551e-03   2.296077e-02   5         5         1         0         169557    54                155638            495               908               
  5     8.120047e-04   5.625984e-03   2.245672e-02   6         6         1         0         171295    60                156889            496               908               
  6     7.084560e-04   5.048133e-03   2.193658e-02   7         7         1         0         173039    66                158146            497               908               
  7     6.207142e-04   4.525112e-03   2.140126e-02   8         8         1         0         174789    72                159409            498               908               
  8     5.464983e-04   4.052133e-03   2.085670e-02   9         9         1         0         176551    78                160684            499               908               
  9     4.837952e-04   3.624648e-03   2.031090e-02   10        10        1         0         178322    84                161968            500               908               
  10    4.308515e-04   3.238415e-03   1.977210e-02   11        11        1         0         180096    90                163255            501               908               
  11    3.861533e-04   2.889524e-03   1.924801e-02   12        12        1         0         181882    96                164554            502               908               
  12    3.484030e-04   2.574397e-03   1.874545e-02   13        13        1         0         183671    102               165856            503               908               
  13    3.164935e-04   2.289775e-03   1.827069e-02   14        14        1         0         185463    108               167161            504               908               
  14    2.894839e-04   2.032691e-03   1.782952e-02   15        15        1         0         187255    114               168466            505               908               
  15    2.665774e-04   1.800454e-03   1.742751e-02   16        16        1         0         189068    120               169792            506               908               
  16    2.471008e-04   1.590627e-03   1.707017e-02   17        17        1         0         190878    126               171115            507               908               
  17    2.304868e-04   1.401006e-03   1.676286e-02   18        18        1         0         192673    132               172423            508               908               
  18    2.162583e-04   1.229614e-03   1.651090e-02   19        19        1         0         194474    138               173737            509               908               
  19    2.040150e-04   1.074684e-03   1.631944e-02   20        20        1         0         196275    144               175051            510               908               
  20    1.934219e-04   9.346607e-04   1.619346e-02   21        21        1         0         198082    150               176371            511               908               
  21    1.841986e-04   8.081979e-04   1.613774e-02   22        22        1         0         199889    156               177691            512               908               
  22    1.761112e-04   6.941654e-04   1.615682e-02   23        23        1         0         201702    162               179017            513               908               
  23    1.689648e-04   5.916673e-04   1.625508e-02   24        24        1         0         203518    168               180346            514               908               
  24    1.625966e-04   5.000739e-04   1.643667e-02   25        25        1         0         205334    174               181675            515               908               
  25    1.568712e-04   4.190747e-04   1.670562e-02   26        26        1         0         207144    180               182998            516               908               
  26    1.516756e-04   3.487606e-04   1.706592e-02   27        27        1         0         208957    186               184324            517               908               
  27    1.469151e-04   2.897217e-04   1.752178e-02   28        28        1         0         210776    192               185656            518               908               
  28    1.425105e-04   2.430822e-04   1.807824e-02   29        29        1         0         212598    198               186991            519               908               
  29    1.383944e-04   2.102194e-04   1.874227e-02   30        30        1         0         214432    204               188338            520               908               
  30    1.345085e-04   1.917931e-04   1.952566e-02   31        31        1         0         216299    210               189718            521               908               
  31    1.308004e-04   1.863790e-04   2.045044e-02   32        32        1         0         218211    216               191143            522               908               
  32    1.272192e-04   1.902421e-04   2.156082e-02   33        33        1         0         220123    222               192568            523               908               
  33    1.237095e-04   1.988264e-04   2.294586e-02   34        34        1         0         221966    228               193924            524               908               
  34    1.202013e-04   2.082831e-04   2.478943e-02   35        35        1         0         223845    234               195316            525               908               
  35    1.165925e-04   2.160961e-04   2.747236e-02   36        36        1         0         225757    240               196741            526               908               
  36    1.127239e-04   2.205108e-04   3.176476e-02   37        37        1         0         227669    246               198166            527               908               
  37    1.082597e-04   2.879775e-04   4.623593e-02   38        38        1         0         229548    252               199558            528               908               
  38    1.046738e-04   2.811684e-04   3.502263e-02   39        39        1         0         231457    258               200980            529               908               
  39    1.011580e-04   2.754696e-04   3.678744e-02   40        40        1         0         233402    264               202438            530               908               
  40    9.649794e-05   2.654731e-04   5.689023e-02   41        41        1         0         235248    270               203797            531               908               
  41    9.298658e-05   2.548274e-04   4.425464e-02   42        42        1         0         237187    276               205249            532               908               
  42    8.973749e-05   2.455336e-04   4.383392e-02   43        43        1         0         239132    282               206707            533               908               
  43    8.625020e-05   2.269115e-04   4.987952e-02   44        44        1         0         241047    288               208135            534               908               
  44    8.220995e-05   2.314764e-04   6.385745e-02   45        45        1         0         242983    294               209584            535               908               
  45    7.885986e-05   2.088817e-04   5.716775e-02   46        46        1         0         244901    300               211015            536               908               
  46    7.622410e-05   1.977449e-04   4.914017e-02   47        47        1         0         246882    306               212509            537               908               
  47    7.335110e-05   1.910631e-04   6.127677e-02   48        48        1         0         248773    312               213913            538               908               
  48    7.126322e-05   1.742410e-04   4.598905e-02   49        49        1         0         250757    318               215410            539               908               
  49    6.959230e-05   1.621493e-04   3.962439e-02   50        50        1         0         252732    324               216898            540               908               
  50    6.804104e-05   1.482275e-04   3.846137e-02   51        51        1         0         254719    330               218398            541               908               
  51    6.661059e-05   1.362466e-04   3.802857e-02   52        52        1         0         256703    336               219895            542               908               
  52    6.524033e-05   1.217877e-04   3.921780e-02   53        53        1         0         258663    342               221368            543               908               
  53    6.396968e-05   1.079379e-04   3.920921e-02   54        54        1         0         260650    348               222868            544               908               
  54    6.297850e-05   9.629453e-05   3.343216e-02   55        55        1         0         261969    353               223780            545               908               
  55    6.211908e-05   8.527619e-05   3.088185e-02   56        56        1         0         263315    358               224719            546               908               
  56    6.134513e-05   7.527644e-05   2.991894e-02   57        57        1         0         264649    363               225646            547               908               
  57    6.063021e-05   6.552960e-05   2.943302e-02   58        58        1         0         266001    368               226591            548               908               
  58    5.995859e-05   5.653006e-05   2.961042e-02   59        59        1         0         267350    373               227533            549               908               
  59    5.931916e-05   4.805914e-05   3.002613e-02   60        60        1         0         268699    378               228475            550               908               
  60    5.870093e-05   4.044832e-05   3.094336e-02   61        61        1         0         270042    383               229411            551               908               
  61    5.809503e-05   3.407498e-05   3.218767e-02   62        62        1         0         271385    388               230347            552               908               
  62    5.749164e-05   2.948824e-05   3.393767e-02   63        63        1         0         272728    393               231283            553               908               
  63    5.688240e-05   2.762467e-05   3.614197e-02   64        64        1         0         274065    398               232213            554               908               
  64    5.625777e-05   2.898479e-05   3.890973e-02   65        65        1         0         275402    403               233143            555               908               
  65    5.560944e-05   3.291250e-05   4.227425e-02   66        66        1         0         276745    408               234079            556               908               
  66    5.492736e-05   3.937291e-05   4.628566e-02   67        67        1         0         278079    413               235006            557               908               
  67    5.420352e-05   4.605690e-05   5.104688e-02   68        68        1         0         279425    418               235945            558               908               
  68    5.342563e-05   5.552507e-05   5.659097e-02   69        69        1         0         280762    423               236875            559               908               
  69    5.258827e-05   6.250930e-05   6.302336e-02   70        70        1         0         282054    428               237760            560               908               
  70    5.166981e-05   7.641451e-05   7.091432e-02   71        71        1         0         283406    433               238705            561               908               
  71    5.070583e-05   8.410209e-05   7.692776e-02   72        72        1         0         284725    438               239617            562               908               
  72    4.967807e-05   9.562107e-05   8.347197e-02   73        73        1         0         286059    443               240544            563               908               
  73    4.855806e-05   1.010112e-04   9.297200e-02   74        74        1         0         288061    449               242059            564               908               
  74    4.729616e-05   1.232483e-04   1.078920e-01   75        75        1         0         290048    455               243559            565               908               
  75    4.614740e-05   1.304294e-04   1.009371e-01   76        76        1         0         291373    460               244477            566               908               
  76    4.489478e-05   1.330752e-04   1.095568e-01   77        77        1         0         292719    465               245416            567               908               
  77    4.346817e-05   1.485244e-04   1.270885e-01   78        78        1         0         294059    470               246349            568               908               
  78    4.208529e-05   1.493609e-04   1.246559e-01   79        79        1         0         295423    475               247306            569               908               
  79    4.060190e-05   1.534675e-04   1.279141e-01   80        80        1         0         296751    480               248227            570               908               
  80    3.905010e-05   1.536533e-04   1.368590e-01   81        81        1         0         298139    485               249208            571               908               
  81    3.759819e-05   1.410624e-04   1.310272e-01   82        82        1         0         299467    490               250129            572               908               
  82    3.631701e-05   1.351226e-04   1.191974e-01   83        83        1         0         300858    495               251113            573               908               
  83    3.516162e-05   1.277550e-04   1.089995e-01   84        84        1         0         302270    500               252118            574               908               
  84    3.410963e-05   1.242829e-04   1.021152e-01   85        85        1         0         303691    505               253132            575               908               
  85    3.314957e-05   1.092999e-04   9.670605e-02   86        86        1         0         305070    510               254104            576               908               
  86    3.237407e-05   1.026901e-04   8.111554e-02   87        87        1         0         306455    515               255082            577               908               
  87    3.172289e-05   9.435812e-05   7.025440e-02   88        88        1         0         307879    520               256099            578               908               
  88    3.116824e-05   8.741381e-05   6.171083e-02   89        89        1         0         309276    525               257089            579               908               
  89    3.070081e-05   8.001505e-05   5.400315e-02   90        90        1         0         310709    530               258115            580               908               
  90    3.030897e-05   7.331098e-05   4.698285e-02   91        91        1         0         312136    535               259135            581               908               
  91    2.998216e-05   6.675336e-05   4.091700e-02   92        92        1         0         313566    540               260158            582               908               
  92    2.971050e-05   6.067733e-05   3.554631e-02   93        93        1         0         314996    545               261181            583               908               
  93    2.948526e-05   5.494547e-05   3.094132e-02   94        94        1         0         316423    550               262201            584               908               
  94    2.929880e-05   4.963168e-05   2.694568e-02   95        95        1         0         317853    555               263224            585               908               
  95    2.914455e-05   4.469500e-05   2.353091e-02   96        96        1         0         319283    560               264247            586               908               
  96    2.901694e-05   4.013658e-05   2.060133e-02   97        97        1         0         320722    565               265279            587               908               
  97    2.891128e-05   3.593102e-05   1.810353e-02   98        98        1         0         322161    570               266311            588               908               
  98    2.882366e-05   3.206039e-05   1.597143e-02   99        99        1         0         323603    575               267346            589               908               
  99    2.875082e-05   2.850013e-05   1.415795e-02   100       100       1         0         325048    580               268384            590               908               
  100   2.869006e-05   2.522742e-05   1.261707e-02   101       101       1         0         326496    585               269425            591               908               
  101   2.863916e-05   2.221852e-05   1.131151e-02   102       102       1         0         327947    590               270469            592               908               
  102   2.859628e-05   1.945104e-05   1.020846e-02   103       103       1         0         329398    595               271513            593               908               
  103   2.855992e-05   1.690355e-05   9.281224e-03   104       104       1         0         330852    600               272560            594               908               
  104   2.852884e-05   1.455669e-05   8.507243e-03   105       105       1         0         332309    605               273610            595               908               
  105   2.850203e-05   1.239369e-05   7.868290e-03   106       106       1         0         333766    610               274660            596               908               
  106   2.847865e-05   1.040199e-05   7.349621e-03   107       107       1         0         335229    615               275716            597               908               
  107   2.845800e-05   8.575899e-06   6.939751e-03   108       108       1         0         336692    620               276772            598               908               
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 81.1684 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 4020 design variables: 4000 simulation variables and 20 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 8.05755e-06       0.0032363         0.0205454         8.08372           7.15835           2.37485           2.90941           260               1                 0                 24524             2                 2946              1050              2084              
2                 8.71656e-08       8.17759e-05       0.000354112       3.29082           3.26975           0.196806          0.315436          203               1                 0                 43380             3                 4985              1871              3712              
3                 5.98639e-11       1.94905e-06       2.6216e-06        3.1898            3.18921           0.0243397         0.0563413         224               1                 0                 64168             4                 7234              2776              5508              
4                 4.64361e-15       1.46431e-09       1.51326e-09       0.411006          0.411003          0.000610699       0.00151097        244               1                 0                 86796             5                 9683              3761              7464              
5                 1.05743e-14       3.76547e-12       2.32783e-12       0.00453376        0.00453376        5.17108e-06       2.75923e-06       227               1                 0                 107860            6                 11962             4678              9284              
Optimization Terminated with Status: Converged
The process took 23.7179 seconds to run.
Total n_vmult for algorithm 107860
