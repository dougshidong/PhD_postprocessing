Starting optimization with 160...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.460201e-03   5.582141e-03   
  1     1.457087e-03   5.575705e-03   5.582141e-04   2         2         1         0         241958    64                218409            687               1360              
  2     1.200545e-03   5.023230e-03   4.844381e-02   3         3         1         0         244683    70                220047            688               1360              
  3     9.899020e-04   4.529232e-03   4.418292e-02   4         4         1         0         247405    76                221682            689               1360              
  4     8.152019e-04   4.083115e-03   4.072779e-02   5         5         1         0         250109    82                223299            690               1360              
  5     6.703734e-04   3.679503e-03   3.755386e-02   6         6         1         0         252849    88                224952            691               1360              
  6     5.500333e-04   3.313934e-03   3.481775e-02   7         7         1         0         255592    94                226608            692               1360              
  7     4.490199e-04   2.977391e-03   3.274704e-02   8         8         1         0         258386    100               228315            693               1360              
  8     3.628507e-04   2.663037e-03   3.150396e-02   9         9         1         0         261222    106               230064            694               1360              
  9     2.917468e-04   2.374407e-03   2.899466e-02   10        10        1         0         264100    112               231855            695               1360              
  10    2.361703e-04   2.126561e-03   2.529774e-02   11        11        1         0         266120    117               232968            696               1360              
  11    1.922083e-04   1.910021e-03   2.229056e-02   12        12        1         0         268152    122               234093            697               1360              
  12    1.567590e-04   1.718293e-03   2.004209e-02   13        13        1         0         270175    127               235209            698               1360              
  13    1.279176e-04   1.546444e-03   1.816319e-02   14        14        1         0         272225    132               236352            699               1360              
  14    1.043445e-04   1.391946e-03   1.655527e-02   15        15        1         0         274272    137               237492            700               1360              
  15    8.492535e-05   1.251783e-03   1.525980e-02   16        16        1         0         276334    142               238647            701               1360              
  16    6.844626e-05   1.120517e-03   1.465349e-02   17        17        1         0         278396    147               239802            702               1360              
  17    5.425683e-05   9.938588e-04   1.418568e-02   18        18        1         0         280458    152               240957            703               1360              
  18    4.339344e-05   8.854009e-04   1.210748e-02   19        19        1         0         282532    157               242124            704               1360              
  19    3.512395e-05   7.939586e-04   1.030483e-02   20        20        1         0         284612    162               243297            705               1360              
  20    2.856006e-05   7.134679e-04   9.122940e-03   21        21        1         0         286704    167               244482            706               1360              
  21    2.326669e-05   6.417337e-04   8.208805e-03   22        22        1         0         288796    172               245667            707               1360              
  22    1.897382e-05   5.773345e-04   7.424721e-03   23        23        1         0         290900    177               246864            708               1360              
  23    1.548514e-05   5.194647e-04   6.733376e-03   24        24        1         0         292995    182               248052            709               1360              
  24    1.264796e-05   4.673689e-04   6.111625e-03   25        25        1         0         295096    187               249246            710               1360              
  25    1.034017e-05   4.204815e-04   5.551989e-03   26        26        1         0         297197    192               250440            711               1360              
  26    8.462954e-06   3.782550e-04   5.046039e-03   27        27        1         0         299301    197               251637            712               1360              
  27    6.936038e-06   3.402346e-04   4.589600e-03   28        28        1         0         301423    202               252852            713               1360              
  28    5.694084e-06   3.059911e-04   4.177470e-03   29        29        1         0         303557    207               254079            714               1360              
  29    4.683894e-06   2.751530e-04   3.806108e-03   30        30        1         0         305703    212               255318            715               1360              
  30    3.862157e-06   2.473763e-04   3.471574e-03   31        31        1         0         307852    217               256560            716               1360              
  31    3.193623e-06   2.223579e-04   3.170750e-03   32        32        1         0         310004    222               257805            717               1360              
  32    2.649609e-06   1.998203e-04   2.900461e-03   33        33        1         0         312165    227               259059            718               1360              
  33    2.206786e-06   1.795164e-04   2.658014e-03   34        34        1         0         314332    232               260319            719               1360              
  34    1.846186e-06   1.612218e-04   2.440802e-03   35        35        1         0         316505    237               261585            720               1360              
  35    1.552387e-06   1.447354e-04   2.246535e-03   36        36        1         0         318684    242               262857            721               1360              
  36    1.312859e-06   1.298754e-04   2.073063e-03   37        37        1         0         320866    247               264132            722               1360              
  37    1.117421e-06   1.164786e-04   1.918464e-03   38        38        1         0         323054    252               265413            723               1360              
  38    9.578016e-07   1.043973e-04   1.780962e-03   39        39        1         0         325248    257               266700            724               1360              
  39    8.272840e-07   9.349893e-05   1.658961e-03   40        40        1         0         327448    262               267993            725               1360              
  40    7.204124e-07   8.366387e-05   1.551002e-03   41        41        1         0         329651    267               269289            726               1360              
  41    6.327569e-07   7.478442e-05   1.455775e-03   42        42        1         0         331857    272               270588            727               1360              
  42    5.607200e-07   6.676347e-05   1.372097e-03   43        43        1         0         334072    277               271896            728               1360              
  43    5.013805e-07   5.951368e-05   1.298916e-03   44        44        1         0         336293    282               273210            729               1360              
  44    4.523660e-07   5.295631e-05   1.235301e-03   45        45        1         0         338514    287               274524            730               1360              
  45    4.117495e-07   4.702059e-05   1.180437e-03   46        46        1         0         340747    292               275850            731               1360              
  46    3.779655e-07   4.164286e-05   1.133631e-03   47        47        1         0         342983    297               277179            732               1360              
  47    3.497418e-07   3.676604e-05   1.094301e-03   48        48        1         0         345222    302               278511            733               1360              
  48    3.260438e-07   3.233902e-05   1.061982e-03   49        49        1         0         347461    307               279843            734               1360              
  49    3.060297e-07   2.831635e-05   1.036326e-03   50        50        1         0         349706    312               281181            735               1360              
  50    2.890139e-07   2.465790e-05   1.017101e-03   51        51        1         0         351954    317               282522            736               1360              
  51    2.744375e-07   2.132883e-05   1.004195e-03   52        52        1         0         354205    322               283866            737               1360              
  52    2.618435e-07   1.829978e-05   9.976157e-04   53        53        1         0         356456    327               285210            738               1360              
  53    2.508581e-07   1.554758e-05   9.974953e-04   54        54        1         0         358707    332               286554            739               1360              
  54    2.411742e-07   1.305669e-05   1.004091e-03   55        55        1         0         360961    337               287901            740               1360              
  55    2.325382e-07   1.082229e-05   1.017786e-03   56        56        1         0         363221    342               289254            741               1360              
  56    2.247403e-07   8.855919e-06   1.039091e-03   57        57        1         0         365499    347               290625            742               1360              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 221.094 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P2A preconditioner
Using 9160 design variables: 9000 simulation variables and 160 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 6.55213e-06       0.00536502        0.0223364         6.06214           1.76489           3.51787           4.61078           542               1                 0                 34474             2                 3664              2178              2172              
2                 6.26261e-07       0.000210317       0.000502108       1.03368           0.750537          0.284171          0.651493          383               1                 0                 58500             3                 5971              3719              3708              
3                 5.89387e-10       3.2175e-05        4.64732e-05       1.25078           1.2359            0.0858136         0.172152          459               1                 0                 87238             4                 8734              5564              5548              
4                 2.98126e-12       9.73283e-08       3.66503e-08       0.152623          0.151878          0.00332958        0.0146903         484               1                 0                 117526            5                 11647             7509              7488              
5                 2.24932e-13       1.26566e-11       1.06624e-10       0.140224          0.140224          0.000223036       3.88186e-05       541               1                 0                 151348            6                 14902             9682              9656              
Optimization Terminated with Status: Converged
The process took 241.489 seconds to run.
Total n_vmult for algorithm 151348
