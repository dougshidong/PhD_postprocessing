Starting optimization with 80...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   6.352675e-03   
  1     1.442395e-03   6.342829e-03   6.352675e-04   2         2         1         0         98169     34                13696             5851              5828              
  2     1.191432e-03   5.717949e-03   4.204580e-02   3         3         1         0         99907     40                14947             5852              5828              
  3     9.740029e-04   5.115264e-03   4.121919e-02   4         4         1         0         101672    46                16225             5853              5828              
  4     7.764006e-04   4.534733e-03   4.258083e-02   5         5         1         0         103425    52                17491             5854              5828              
  5     6.262825e-04   4.030262e-03   3.592075e-02   6         6         1         0         105187    58                18766             5855              5828              
  6     5.112535e-04   3.618289e-03   3.107409e-02   7         7         1         0         106949    64                20041             5856              5828              
  7     4.188594e-04   3.251374e-03   2.790200e-02   8         8         1         0         108714    70                21319             5857              5828              
  8     3.433679e-04   2.926763e-03   2.559520e-02   9         9         1         0         110479    76                22597             5858              5828              
  9     2.814076e-04   2.633594e-03   2.350574e-02   10        10        1         0         112250    82                23881             5859              5828              
  10    2.304010e-04   2.369968e-03   2.169987e-02   11        11        1         0         114018    88                25162             5860              5828              
  11    1.878596e-04   2.129007e-03   2.041112e-02   12        12        1         0         115804    94                26461             5861              5828              
  12    1.505632e-04   1.895391e-03   2.039786e-02   13        13        1         0         117593    100               27763             5862              5828              
  13    1.195251e-04   1.676527e-03   1.894604e-02   14        14        1         0         119379    106               29062             5863              5828              
  14    9.662819e-05   1.498093e-03   1.571869e-02   15        15        1         0         121177    112               30373             5864              5828              
  15    7.878799e-05   1.344141e-03   1.372613e-02   16        16        1         0         122981    118               31690             5865              5828              
  16    6.445109e-05   1.207833e-03   1.236994e-02   17        17        1         0         124803    124               33025             5866              5828              
  17    5.281757e-05   1.085754e-03   1.124946e-02   18        18        1         0         126631    130               34366             5867              5828              
  18    4.334366e-05   9.761826e-04   1.027804e-02   19        19        1         0         128459    136               35707             5868              5828              
  19    3.561878e-05   8.775923e-04   9.404336e-03   20        20        1         0         130305    142               37066             5869              5828              
  20    2.931723e-05   7.888960e-04   8.617096e-03   21        21        1         0         132172    148               38446             5870              5828              
  21    2.417638e-05   7.090316e-04   7.900567e-03   22        22        1         0         134024    154               39811             5871              5828              
  22    1.998250e-05   6.371468e-04   7.250426e-03   23        23        1         0         135891    160               41191             5872              5828              
  23    1.656136e-05   5.724168e-04   6.658207e-03   24        24        1         0         137785    166               42598             5873              5828              
  24    1.377063e-05   5.141485e-04   6.120296e-03   25        25        1         0         139688    172               44014             5874              5828              
  25    1.149409e-05   4.616831e-04   5.630770e-03   26        26        1         0         141594    178               45433             5875              5828              
  26    9.636850e-06   4.144544e-04   5.186245e-03   27        27        1         0         143512    184               46864             5876              5828              
  27    8.121446e-06   3.719317e-04   4.782143e-03   28        28        1         0         145439    190               48304             5877              5828              
  28    6.884677e-06   3.336532e-04   4.415383e-03   29        29        1         0         147372    196               49750             5878              5828              
  29    5.874994e-06   2.991897e-04   4.082296e-03   30        30        1         0         148679    201               50650             5879              5828              
  30    5.050365e-06   2.681651e-04   3.780168e-03   31        31        1         0         149992    206               51556             5880              5828              
  31    4.376534e-06   2.402322e-04   3.506016e-03   32        32        1         0         151314    211               52471             5881              5828              
  32    3.825585e-06   2.150850e-04   3.257511e-03   33        33        1         0         152642    216               53392             5882              5828              
  33    3.374776e-06   1.924422e-04   3.032219e-03   34        34        1         0         153976    221               54319             5883              5828              
  34    3.005581e-06   1.720554e-04   2.828176e-03   35        35        1         0         155313    226               55249             5884              5828              
  35    2.702915e-06   1.536966e-04   2.643403e-03   36        36        1         0         156653    231               56182             5885              5828              
  36    2.454491e-06   1.371641e-04   2.476273e-03   37        37        1         0         157996    236               57118             5886              5828              
  37    2.250303e-06   1.222734e-04   2.325187e-03   38        38        1         0         159333    241               58048             5887              5828              
  38    2.082203e-06   1.088610e-04   2.188818e-03   39        39        1         0         160679    246               58987             5888              5828              
  39    1.943554e-06   9.677735e-05   2.065890e-03   40        40        1         0         162031    251               59932             5889              5828              
  40    1.828952e-06   8.589022e-05   1.955347e-03   41        41        1         0         163392    256               60886             5890              5828              
  41    1.733992e-06   7.607874e-05   1.856190e-03   42        42        1         0         164765    261               61852             5891              5828              
  42    1.655086e-06   6.723609e-05   1.767603e-03   43        43        1         0         166141    266               62821             5892              5828              
  43    1.589308e-06   5.926485e-05   1.688830e-03   44        44        1         0         167520    271               63793             5893              5828              
  44    1.534272e-06   5.207933e-05   1.619274e-03   45        45        1         0         168923    276               64789             5894              5828              
  45    1.488032e-06   4.560149e-05   1.558400e-03   46        46        1         0         170344    281               65803             5895              5828              
  46    1.448997e-06   3.976352e-05   1.505817e-03   47        47        1         0         171771    286               66823             5896              5828              
  47    1.415869e-06   3.450389e-05   1.461197e-03   48        48        1         0         173207    291               67852             5897              5828              
  48    1.387584e-06   2.977068e-05   1.424349e-03   49        49        1         0         174610    296               68848             5898              5828              
  49    1.363272e-06   2.551740e-05   1.395155e-03   50        50        1         0         176028    301               69859             5899              5828              
  50    1.342217e-06   2.170796e-05   1.373640e-03   51        51        1         0         177428    306               70852             5900              5828              
  51    1.323832e-06   1.831175e-05   1.359914e-03   52        52        1         0         178840    311               71857             5901              5828              
  52    1.307631e-06   1.531226e-05   1.354271e-03   53        53        1         0         180279    316               72889             5902              5828              
  53    1.293211e-06   1.270035e-05   1.357178e-03   54        54        1         0         181730    321               73933             5903              5828              
  54    1.280234e-06   1.049155e-05   1.369575e-03   55        55        1         0         183187    326               74983             5904              5828              
  55    1.268406e-06   8.713420e-06   1.393625e-03   56        56        1         0         184647    331               76036             5905              5828              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 45.1579 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4 preconditioner
Using 4080 design variables: 4000 simulation variables and 80 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.61209e-06       0.00332461        0.0239584         17.9429           17.5406           2.43477           2.88879           46                1                 0                 64258             2                 60228             194               372               
2                 8.8597e-08        6.41135e-05       0.000353454       16.7245           16.72             0.188566          0.339655          37                1                 0                 115843            3                 108608            351               672               
3                 2.0342e-11        1.89521e-06       6.19368e-06       0.927573          0.926322          0.0225932         0.0425127         48                1                 0                 180133            4                 168791            552               1060              
4                 3.59372e-13       1.96099e-10       3.30867e-10       0.0836497         0.0836447         0.000320199       0.000862311       50                1                 0                 246127            5                 230514            761               1464              
Optimization Terminated with Status: Converged
The process took 38.86 seconds to run.
Total n_vmult for algorithm 246127
