Starting optimization with 100...
Optimizing FFD points to obtain target Gaussian bump...

Quasi-Newton Method with Limited-Memory BFGS
Line Search: Backtracking satisfying Null Curvature Condition
  iter  value          gnorm          snorm          #fval     #grad     ls_#fval  ls_#grad  n_vmult   dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
  0     1.446428e-03   6.075515e-03   
  1     1.442739e-03   6.067075e-03   6.075515e-04   2         2         1         0         274555    34                255378            823               1584              
  2     1.184243e-03   5.482658e-03   4.572498e-02   3         3         1         0         276293    40                256629            824               1584              
  3     9.318772e-04   4.805199e-03   5.130556e-02   4         4         1         0         278067    46                257916            825               1584              
  4     7.456481e-04   4.260754e-03   4.129987e-02   5         5         1         0         279814    52                259176            826               1584              
  5     6.108985e-04   3.836491e-03   3.361079e-02   6         6         1         0         281567    58                260442            827               1584              
  6     5.008289e-04   3.454320e-03   3.052694e-02   7         7         1         0         283320    64                261708            828               1584              
  7     4.103079e-04   3.112247e-03   2.800413e-02   8         8         1         0         285064    70                262965            829               1584              
  8     3.352347e-04   2.800737e-03   2.596978e-02   9         9         1         0         286826    76                264240            830               1584              
  9     2.690852e-04   2.503215e-03   2.624989e-02   10        10        1         0         288606    82                265533            831               1584              
  10    2.108973e-04   2.200025e-03   2.551043e-02   11        11        1         0         290374    88                266814            832               1584              
  11    1.696943e-04   1.966066e-03   2.029419e-02   12        12        1         0         292151    94                268104            833               1584              
  12    1.379291e-04   1.764897e-03   1.741956e-02   13        13        1         0         293940    100               269406            834               1584              
  13    1.124160e-04   1.587707e-03   1.559467e-02   14        14        1         0         295726    106               270705            835               1584              
  14    9.172995e-05   1.428496e-03   1.405495e-02   15        15        1         0         297524    112               272016            836               1584              
  15    7.489728e-05   1.285993e-03   1.273177e-02   16        16        1         0         299325    118               273330            837               1584              
  16    6.118539e-05   1.157494e-03   1.153185e-02   17        17        1         0         301129    124               274647            838               1584              
  17    5.001205e-05   1.042079e-03   1.045948e-02   18        18        1         0         302948    130               275979            839               1584              
  18    4.090854e-05   9.379853e-04   9.479786e-03   19        19        1         0         304785    136               277329            840               1584              
  19    3.349322e-05   8.443887e-04   8.596915e-03   20        20        1         0         306628    142               278685            841               1584              
  20    2.745504e-05   7.599933e-04   7.791296e-03   21        21        1         0         308471    148               280041            842               1584              
  21    2.253981e-05   6.840773e-04   7.064052e-03   22        22        1         0         310320    154               281403            843               1584              
  22    1.853998e-05   6.156415e-04   6.401971e-03   23        23        1         0         312199    160               282795            844               1584              
  23    1.528598e-05   5.540702e-04   5.804429e-03   24        24        1         0         314087    166               284196            845               1584              
  24    1.263940e-05   4.985759e-04   5.261683e-03   25        25        1         0         315981    172               285603            846               1584              
  25    1.048730e-05   4.486431e-04   4.772317e-03   26        26        1         0         317851    178               286986            847               1584              
  26    8.737592e-06   4.036434e-04   4.328816e-03   27        27        1         0         319760    184               288408            848               1584              
  27    7.315188e-06   3.631500e-04   3.929496e-03   28        28        1         0         321678    190               289839            849               1584              
  28    6.158941e-06   3.266584e-04   3.568422e-03   29        29        1         0         323602    196               291276            850               1584              
  29    5.219049e-06   2.938178e-04   3.243909e-03   30        30        1         0         324906    201               292173            851               1584              
  30    4.454986e-06   2.642212e-04   2.951211e-03   31        31        1         0         326213    206               293073            852               1584              
  31    3.833775e-06   2.375815e-04   2.688764e-03   32        32        1         0         327526    211               293979            853               1584              
  32    3.328603e-06   2.135697e-04   2.452752e-03   33        33        1         0         328842    216               294888            854               1584              
  33    2.917668e-06   1.919517e-04   2.241782e-03   34        34        1         0         330164    221               295803            855               1584              
  34    2.583252e-06   1.724606e-04   2.052774e-03   35        35        1         0         331492    226               296724            856               1584              
  35    2.310959e-06   1.549063e-04   1.884517e-03   36        36        1         0         332820    231               297645            857               1584              
  36    2.089095e-06   1.390716e-04   1.734521e-03   37        37        1         0         334151    236               298569            858               1584              
  37    1.908163e-06   1.248023e-04   1.601744e-03   38        38        1         0         335485    241               299496            859               1584              
  38    1.760452e-06   1.119217e-04   1.484178e-03   39        39        1         0         336825    246               300429            860               1584              
  39    1.639702e-06   1.003048e-04   1.380925e-03   40        40        1         0         338168    251               301365            861               1584              
  40    1.540831e-06   8.980710e-05   1.290376e-03   41        41        1         0         339511    256               302301            862               1584              
  41    1.459713e-06   8.032772e-05   1.211762e-03   42        42        1         0         340860    261               303243            863               1584              
  42    1.393001e-06   7.174837e-05   1.143813e-03   43        43        1         0         342215    266               304191            864               1584              
  43    1.337977e-06   6.398754e-05   1.085883e-03   44        44        1         0         343570    271               305139            865               1584              
  44    1.292436e-06   5.694817e-05   1.037010e-03   45        45        1         0         344928    276               306090            866               1584              
  45    1.254585e-06   5.056473e-05   9.966870e-04   46        46        1         0         346289    281               307044            867               1584              
  46    1.222971e-06   4.475748e-05   9.642523e-04   47        47        1         0         347656    286               308004            868               1584              
  47    1.196411e-06   3.947425e-05   9.393744e-04   48        48        1         0         349026    291               308967            869               1584              
  48    1.173942e-06   3.464984e-05   9.217080e-04   49        49        1         0         350402    296               309936            870               1584              
  49    1.154782e-06   3.024400e-05   9.111517e-04   50        50        1         0         351781    301               310908            871               1584              
  50    1.138292e-06   2.620483e-05   9.077109e-04   51        51        1         0         353166    306               311886            872               1584              
  51    1.123948e-06   2.250463e-05   9.115847e-04   52        52        1         0         354554    311               312867            873               1584              
  52    1.111322e-06   1.910707e-05   9.231766e-04   53        53        1         0         355948    316               313854            874               1584              
  53    1.100056e-06   1.600373e-05   9.430714e-04   54        54        1         0         357345    321               314844            875               1584              
  54    1.089857e-06   1.318779e-05   9.721286e-04   55        55        1         0         358745    326               315837            876               1584              
  55    1.080476e-06   1.070025e-05   1.011416e-03   56        56        1         0         360145    331               316830            877               1584              
  56    1.071699e-06   8.625682e-06   1.062308e-03   57        57        1         0         361551    336               317829            878               1584              
Optimization Terminated with Status: Converged
 Done target optimization...
 Resetting problem to initial conditions and target previous FFD points 
 and aim for machine precision functional value....
The process took 48.1235 seconds to run.
********************************************************
Biros and Ghattas Full-space method...with P4A preconditioner
Using 4100 design variables: 4000 simulation variables and 100 control variables.
Line Search: Backtracking satisfying Null Curvature Condition
********************************************************
Iteration         Func. val.        ||Lagr. grad.||   ||Constraint||    ||Search dir||    search_ctl_norm   search_sim_norm   search_adj_norm   n_kkt_iter        n_linesearches    n_grad            n_vmult           dRdW_form         dRdW_mult         dRdX_mult         d2R_mult          
1                 7.59438e-06       0.00333299        0.0240325         9.49741           8.71372           2.43587           2.88765           440               1                 0                 41084             2                 4746              1770              3524              
2                 1.04256e-07       6.41415e-05       0.000351201       7.48012           7.46999           0.188002          0.340811          290               1                 0                 67944             3                 7655              2939              5848              
3                 3.91205e-11       2.2531e-06        7.7664e-06        1.16359           1.16251           0.024522          0.0435472         397               1                 0                 104648            4                 11634             4536              9028              
4                 7.31244e-14       3.90253e-10       1.19909e-09       0.215692          0.215689          0.000487229       0.000924564       366               1                 0                 138500            5                 15303             6009              11960             
Optimization Terminated with Status: Converged
The process took 38.1231 seconds to run.
Total n_vmult for algorithm 138500
